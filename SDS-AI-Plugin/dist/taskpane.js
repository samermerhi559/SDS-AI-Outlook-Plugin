/*! For license information please see taskpane.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{3072:function(t,e){var n="function"==typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,o=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,u=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,b=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,y=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function A(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case i:switch(t=t.type){case d:case h:case r:case o:case a:case p:return t;default:switch(t=t&&t.$$typeof){case c:case u:case m:case g:case l:return t;default:return e}}case s:return e}}}function x(t){return A(t)===h}e.AsyncMode=d,e.ConcurrentMode=h,e.ContextConsumer=c,e.ContextProvider=l,e.Element=i,e.ForwardRef=u,e.Fragment=r,e.Lazy=m,e.Memo=g,e.Portal=s,e.Profiler=o,e.StrictMode=a,e.Suspense=p,e.isAsyncMode=function(t){return x(t)||A(t)===d},e.isConcurrentMode=x,e.isContextConsumer=function(t){return A(t)===c},e.isContextProvider=function(t){return A(t)===l},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===i},e.isForwardRef=function(t){return A(t)===u},e.isFragment=function(t){return A(t)===r},e.isLazy=function(t){return A(t)===m},e.isMemo=function(t){return A(t)===g},e.isPortal=function(t){return A(t)===s},e.isProfiler=function(t){return A(t)===o},e.isStrictMode=function(t){return A(t)===a},e.isSuspense=function(t){return A(t)===p},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===r||t===h||t===o||t===a||t===p||t===f||"object"==typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===g||t.$$typeof===l||t.$$typeof===c||t.$$typeof===u||t.$$typeof===v||t.$$typeof===y||t.$$typeof===w||t.$$typeof===b)},e.typeOf=A},4146:function(t,e,n){var i=n(73404),s={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(t){return i.isMemo(t)?a:o[t.$$typeof]||s}o[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[i.Memo]=a;var c=Object.defineProperty,d=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,u=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;t.exports=function t(e,n,i){if("string"!=typeof n){if(f){var s=p(n);s&&s!==f&&t(e,s,i)}var a=d(n);h&&(a=a.concat(h(n)));for(var o=l(e),g=l(n),m=0;m<a.length;++m){var b=a[m];if(!(r[b]||i&&i[b]||g&&g[b]||o&&o[b])){var v=u(n,b);try{c(e,b,v)}catch(t){}}}}return e}},5171:function(t,e,n){var i=n(31601),s=n.n(i),r=n(76314),a=n.n(r)()(s());a.push([t.id,"@import url(https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap);"]),a.push([t.id,'/* global.css */\r\n\r\nbody, html {\r\n  font-family: \'DM Sans\', sans-serif;\r\n  background-color: #f6f8fb;\r\n  margin: 0;\r\n  padding: 0;\r\n  color: #333;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\n\r\nh1, h2, h3 {\r\n  font-weight: 500;\r\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\r\n  padding-bottom: 6px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\nlabel {\r\n  font-size: 0.9rem;\r\n  font-weight: 500;\r\n  color: #444;\r\n  display: block;\r\n  margin-bottom: 4px;\r\n}\r\n\r\ninput[type="text"],\r\ninput[type="password"],\r\ninput[type="email"],\r\ninput[type="number"],\r\ninput[type="date"],\r\nselect,\r\ntextarea {\r\n  width: 100%;\r\n  padding: 10px 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 6px;\r\n  background-color: #fff;\r\n  font-size: 14px;\r\n  box-sizing: border-box;\r\n  transition: border-color 0.2s;\r\n}\r\n\r\ninput:focus,\r\nselect:focus,\r\ntextarea:focus {\r\n  outline: none;\r\n  border-color: #0078d4;\r\n  background-color: #fff;\r\n}\r\n\r\nbutton {\r\n  padding: 10px 20px;\r\n  background-color: #0078d4;\r\n  border: none;\r\n  color: white;\r\n  font-size: 14px;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  transition: background-color 0.2s;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #005fa3;\r\n}\r\n\r\n.login-container {\r\n  max-width: 420px;\r\n  margin: 60px auto;\r\n  padding: 30px;\r\n  background: #ffffff;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);\r\n}\r\n\r\n.login-title {\r\n  font-size: 1.4rem;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.login-field {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.attachment-table table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 14px;\r\n}\r\n\r\n.attachment-table th,\r\n.attachment-table td {\r\n  text-align: left;\r\n  padding: 10px;\r\n  border-bottom: 1px solid #eaeaea;\r\n}\r\n\r\n.attachment-table th {\r\n  background-color: #f9f9f9;\r\n  color: #555;\r\n  font-weight: 500;\r\n}\r\n\r\n.attachment-table td button {\r\n  padding: 6px 12px;\r\n  border-radius: 4px;\r\n  background-color: #0078d4;\r\n  color: white;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 13px;\r\n}\r\n\r\n.attachment-table td button:hover {\r\n  background-color: #005fa3;\r\n}\r\n\r\n.invoice-container {\r\n  display: flex;\r\n  -ms-flex-direction: row;\r\n  flex-direction: row;\r\n  height: 100vh;\r\n  width: 100%;\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.invoice-sidebar {\r\n  -ms-flex: 0 0 40%;\r\n  flex: 0 0 40%;\r\n  padding: 20px;\r\n  border-right: 1px solid #ccc;\r\n  overflow-y: auto;\r\n  max-height: 100vh;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.invoice-preview-panel {\r\n  -ms-flex: 0 0 60%;\r\n  flex: 0 0 60%;\r\n  padding: 20px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  background-color: #f9f9f9;\r\n  box-sizing: border-box;\r\n  max-height: 100vh;\r\n}\r\n\r\n.invoice-fields .field-pair {\r\n  display: flex;\r\n  gap: 10px;\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.invoice-fields .field-pair > div {\r\n  -ms-flex: 1; /* IE 10+ */\r\n  flex: 1;\r\n}\r\n\r\n.invoice-fields label {\r\n  margin-bottom: 4px;\r\n  display: block;\r\n}\r\n\r\n.invoice-fields input,\r\n.invoice-fields select {\r\n  margin-top: 2px;\r\n}\r\n\r\n.spinner {\r\n  width: 40px;\r\n  height: 40px;\r\n  border: 5px solid rgba(0, 120, 212, 0.2);\r\n  border-top: 5px solid #0078d4;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  margin: 0 auto;\r\n}\r\n\r\n@keyframes spin {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n.ai-bot-animated {\r\n  width: 160px;\r\n  margin-bottom: 16px;\r\n  animation: aiPulse 2s ease-in-out infinite;\r\n}\r\n\r\n@keyframes aiPulse {\r\n  0% {\r\n    transform: scale(1);\r\n    filter: drop-shadow(0 0 0px #0078d4);\r\n  }\r\n  50% {\r\n    transform: scale(1.05);\r\n    filter: drop-shadow(0 0 10px #0078d4);\r\n  }\r\n  100% {\r\n    transform: scale(1);\r\n    filter: drop-shadow(0 0 0px #0078d4);\r\n  }\r\n}\r\n\r\n.scanner-effect {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  overflow: hidden;\r\n  z-index: 9;\r\n  background-image:\r\n    repeating-linear-gradient(0deg, rgba(0, 120, 212, 0.05) 0px, rgba(0, 120, 212, 0.05) 2px, transparent 2px, transparent 4px),\r\n    repeating-linear-gradient(90deg, rgba(0, 120, 212, 0.05) 0px, rgba(0, 120, 212, 0.05) 2px, transparent 2px, transparent 4px);\r\n  background-size: 200% 200%;\r\n  animation: scannerGrid 2s linear infinite;\r\n  pointer-events: none;\r\n}\r\n\r\n@keyframes scannerGrid {\r\n  0% {\r\n    background-position: 0 0;\r\n  }\r\n  100% {\r\n    background-position: -100% -100%;\r\n  }\r\n}\r\n.invoice-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(255, 255, 255, 0.8);\r\n  z-index: 10;\r\n  display: flex;\r\n  -ms-flex-direction: column; /* IE 10+ */\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n  text-align: center;\r\n}',""]),e.A=a},5338:function(t,e,n){var i=n(40961);e.H=i.createRoot,i.hydrateRoot},9771:function(t){t.exports=function(){}},10540:function(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},21020:function(t,e,n){var i=n(96540),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var i,r={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(d=e.ref),e)a.call(e,i)&&!l.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===r[i]&&(r[i]=e[i]);return{$$typeof:s,type:t,key:c,ref:d,props:r,_owner:o.current}}e.Fragment=r,e.jsx=c,e.jsxs=c},22799:function(t,e){if("function"==typeof Symbol&&Symbol.for){var n=Symbol.for;n("react.element"),n("react.portal"),n("react.fragment"),n("react.strict_mode"),n("react.profiler"),n("react.provider"),n("react.context"),n("react.forward_ref"),n("react.suspense"),n("react.suspense_list"),n("react.memo"),n("react.lazy"),n("react.block"),n("react.server.block"),n("react.fundamental"),n("react.debug_trace_mode"),n("react.legacy_hidden")}},31601:function(t){t.exports=function(t){return t[1]}},39046:function(){},41113:function(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},44363:function(t,e,n){n(22799)},55056:function(t,e,n){t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},73404:function(t,e,n){t.exports=n(3072)},74848:function(t,e,n){t.exports=n(21020)},76314:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<t.length;c++){var d=[].concat(t[c]);i&&a[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),e.push(d))}},e}},77659:function(t){var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},82525:function(t,e,n){var i={};n.r(i),n.d(i,{dU:function(){return Yo},ng:function(){return Jo},EA:function(){return Qo},Tm:function(){return Zo},D6:function(){return tl},YE:function(){return el}});var s=n(96540),r=n.t(s,2),a=n(5338);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function c(t,e,n){return(e=l(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function p(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,s,r,a,o=[],l=!0,c=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,s=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw s}}return o}}(t,e)||p(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(null==t)return{};var n,i,s=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)n=r[i],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}var m=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function b(){return b=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},b.apply(null,arguments)}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,l(i.key),i)}}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function A(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(A=function(){return!!t})()}function x(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=function(){function t(t){var e=this;this._insertTag=function(t){var n;n=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,n),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{n.insertRule(t,n.cssRules.length)}catch(t){}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){var e;return null==(e=t.parentNode)?void 0:e.removeChild(t)})),this.tags=[],this.ctr=0},t}(),_=Math.abs,E=String.fromCharCode,C=Object.assign;function T(t){return t.trim()}function k(t,e,n){return t.replace(e,n)}function M(t,e){return t.indexOf(e)}function P(t,e){return 0|t.charCodeAt(e)}function I(t,e,n){return t.slice(e,n)}function R(t){return t.length}function L(t){return t.length}function D(t,e){return e.push(t),t}var F=1,O=1,N=0,B=0,H=0,z="";function V(t,e,n,i,s,r,a){return{value:t,root:e,parent:n,type:i,props:s,children:r,line:F,column:O,length:a,return:""}}function j(t,e){return C(V("",null,null,"",null,null,0),t,{length:-t.length},e)}function $(){return H=B>0?P(z,--B):0,O--,10===H&&(O=1,F--),H}function U(){return H=B<N?P(z,B++):0,O++,10===H&&(O=1,F++),H}function W(){return P(z,B)}function G(){return B}function q(t,e){return I(z,t,e)}function X(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function K(t){return F=O=1,N=R(z=t),B=0,[]}function Y(t){return z="",t}function J(t){return T(q(B-1,tt(91===t?t+2:40===t?t+1:t)))}function Q(t){for(;(H=W())&&H<33;)U();return X(t)>2||X(H)>3?"":" "}function Z(t,e){for(;--e&&U()&&!(H<48||H>102||H>57&&H<65||H>70&&H<97););return q(t,G()+(e<6&&32==W()&&32==U()))}function tt(t){for(;U();)switch(H){case t:return B;case 34:case 39:34!==t&&39!==t&&tt(H);break;case 40:41===t&&tt(t);break;case 92:U()}return B}function et(t,e){for(;U()&&t+H!==57&&(t+H!==84||47!==W()););return"/*"+q(e,B-1)+"*"+E(47===t?t:U())}function nt(t){for(;!X(W());)U();return q(t,B)}var it="-ms-",st="-moz-",rt="-webkit-",at="comm",ot="rule",lt="decl",ct="@keyframes";function dt(t,e){for(var n="",i=L(t),s=0;s<i;s++)n+=e(t[s],s,t,e)||"";return n}function ht(t,e,n,i){switch(t.type){case"@layer":if(t.children.length)break;case"@import":case lt:return t.return=t.return||t.value;case at:return"";case ct:return t.return=t.value+"{"+dt(t.children,i)+"}";case ot:t.value=t.props.join(",")}return R(n=dt(t.children,i))?t.return=t.value+"{"+n+"}":""}function ut(t){return Y(pt("",null,null,null,[""],t=K(t),0,[0],t))}function pt(t,e,n,i,s,r,a,o,l){for(var c=0,d=0,h=a,u=0,p=0,f=0,g=1,m=1,b=1,v=0,y="",w=s,A=r,x=i,S=y;m;)switch(f=v,v=U()){case 40:if(108!=f&&58==P(S,h-1)){-1!=M(S+=k(J(v),"&","&\f"),"&\f")&&(b=-1);break}case 34:case 39:case 91:S+=J(v);break;case 9:case 10:case 13:case 32:S+=Q(f);break;case 92:S+=Z(G()-1,7);continue;case 47:switch(W()){case 42:case 47:D(gt(et(U(),G()),e,n),l);break;default:S+="/"}break;case 123*g:o[c++]=R(S)*b;case 125*g:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+d:-1==b&&(S=k(S,/\f/g,"")),p>0&&R(S)-h&&D(p>32?mt(S+";",i,n,h-1):mt(k(S," ","")+";",i,n,h-2),l);break;case 59:S+=";";default:if(D(x=ft(S,e,n,c,d,s,o,y,w=[],A=[],h),r),123===v)if(0===d)pt(S,e,x,x,w,r,h,o,A);else switch(99===u&&110===P(S,3)?100:u){case 100:case 108:case 109:case 115:pt(t,x,x,i&&D(ft(t,x,x,0,0,s,o,y,s,w=[],h),A),s,A,h,o,i?w:A);break;default:pt(S,x,x,x,[""],A,0,o,A)}}c=d=p=0,g=b=1,y=S="",h=a;break;case 58:h=1+R(S),p=f;default:if(g<1)if(123==v)--g;else if(125==v&&0==g++&&125==$())continue;switch(S+=E(v),v*g){case 38:b=d>0?1:(S+="\f",-1);break;case 44:o[c++]=(R(S)-1)*b,b=1;break;case 64:45===W()&&(S+=J(U())),u=W(),d=h=R(y=S+=nt(G())),v++;break;case 45:45===f&&2==R(S)&&(g=0)}}return r}function ft(t,e,n,i,s,r,a,o,l,c,d){for(var h=s-1,u=0===s?r:[""],p=L(u),f=0,g=0,m=0;f<i;++f)for(var b=0,v=I(t,h+1,h=_(g=a[f])),y=t;b<p;++b)(y=T(g>0?u[b]+" "+v:k(v,/&\f/g,u[b])))&&(l[m++]=y);return V(t,e,n,0===s?ot:o,l,c,d)}function gt(t,e,n){return V(t,e,n,at,E(H),I(t,2,-2),0)}function mt(t,e,n,i){return V(t,e,n,lt,I(t,0,i),I(t,i+1,-1),i)}var bt=function(t,e,n){for(var i=0,s=0;i=s,s=W(),38===i&&12===s&&(e[n]=1),!X(s);)U();return q(t,B)},vt=new WeakMap,yt=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,n=t.parent,i=t.column===n.column&&t.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||vt.get(n))&&!i){vt.set(t,!0);for(var s=[],r=function(t,e){return Y(function(t,e){var n=-1,i=44;do{switch(X(i)){case 0:38===i&&12===W()&&(e[n]=1),t[n]+=bt(B-1,e,n);break;case 2:t[n]+=J(i);break;case 4:if(44===i){t[++n]=58===W()?"&\f":"",e[n]=t[n].length;break}default:t[n]+=E(i)}}while(i=U());return t}(K(t),e))}(e,s),a=n.props,o=0,l=0;o<r.length;o++)for(var c=0;c<a.length;c++,l++)t.props[l]=s[o]?r[o].replace(/&\f/g,a[c]):a[c]+" "+r[o]}}},wt=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}};function At(t,e){switch(function(t,e){return 45^P(t,0)?(((e<<2^P(t,0))<<2^P(t,1))<<2^P(t,2))<<2^P(t,3):0}(t,e)){case 5103:return rt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return rt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return rt+t+st+t+it+t+t;case 6828:case 4268:return rt+t+it+t+t;case 6165:return rt+t+it+"flex-"+t+t;case 5187:return rt+t+k(t,/(\w+).+(:[^]+)/,rt+"box-$1$2"+it+"flex-$1$2")+t;case 5443:return rt+t+it+"flex-item-"+k(t,/flex-|-self/,"")+t;case 4675:return rt+t+it+"flex-line-pack"+k(t,/align-content|flex-|-self/,"")+t;case 5548:return rt+t+it+k(t,"shrink","negative")+t;case 5292:return rt+t+it+k(t,"basis","preferred-size")+t;case 6060:return rt+"box-"+k(t,"-grow","")+rt+t+it+k(t,"grow","positive")+t;case 4554:return rt+k(t,/([^-])(transform)/g,"$1"+rt+"$2")+t;case 6187:return k(k(k(t,/(zoom-|grab)/,rt+"$1"),/(image-set)/,rt+"$1"),t,"")+t;case 5495:case 3959:return k(t,/(image-set\([^]*)/,rt+"$1$`$1");case 4968:return k(k(t,/(.+:)(flex-)?(.*)/,rt+"box-pack:$3"+it+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+rt+t+t;case 4095:case 3583:case 4068:case 2532:return k(t,/(.+)-inline(.+)/,rt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(R(t)-1-e>6)switch(P(t,e+1)){case 109:if(45!==P(t,e+4))break;case 102:return k(t,/(.+:)(.+)-([^]+)/,"$1"+rt+"$2-$3$1"+st+(108==P(t,e+3)?"$3":"$2-$3"))+t;case 115:return~M(t,"stretch")?At(k(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==P(t,e+1))break;case 6444:switch(P(t,R(t)-3-(~M(t,"!important")&&10))){case 107:return k(t,":",":"+rt)+t;case 101:return k(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+rt+(45===P(t,14)?"inline-":"")+"box$3$1"+rt+"$2$3$1"+it+"$2box$3")+t}break;case 5936:switch(P(t,e+11)){case 114:return rt+t+it+k(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return rt+t+it+k(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return rt+t+it+k(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return rt+t+it+t+t}return t}var xt=[function(t,e,n,i){if(t.length>-1&&!t.return)switch(t.type){case lt:t.return=At(t.value,t.length);break;case ct:return dt([j(t,{value:k(t.value,"@","@"+rt)})],i);case ot:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t){return(t=/(::plac\w+|:read-\w+)/.exec(t))?t[0]:t}(e)){case":read-only":case":read-write":return dt([j(t,{props:[k(e,/:(read-\w+)/,":-moz-$1")]})],i);case"::placeholder":return dt([j(t,{props:[k(e,/:(plac\w+)/,":"+rt+"input-$1")]}),j(t,{props:[k(e,/:(plac\w+)/,":-moz-$1")]}),j(t,{props:[k(e,/:(plac\w+)/,it+"input-$1")]})],i)}return""}))}}],St=function(t){var e=t.key;if("css"===e){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var i,s,r=t.stylisPlugins||xt,a={},o=[];i=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),n=1;n<e.length;n++)a[e[n]]=!0;o.push(t)}));var l,c,d,h,u=[ht,(h=function(t){l.insert(t)},function(t){t.root||(t=t.return)&&h(t)})],p=(c=[yt,wt].concat(r,u),d=L(c),function(t,e,n,i){for(var s="",r=0;r<d;r++)s+=c[r](t,e,n,i)||"";return s});s=function(t,e,n,i){l=n,dt(ut(t?t+"{"+e.styles+"}":e.styles),p),i&&(f.inserted[e.name]=!0)};var f={key:e,sheet:new S({key:e,container:i,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:s};return f.sheet.hydrate(o),f},_t=function(t,e,n){var i=t.key+"-"+e.name;!1===n&&void 0===t.registered[i]&&(t.registered[i]=e.styles)};function Et(t){for(var e,n=0,i=0,s=t.length;s>=4;++i,s-=4)e=1540483477*(65535&(e=255&t.charCodeAt(i)|(255&t.charCodeAt(++i))<<8|(255&t.charCodeAt(++i))<<16|(255&t.charCodeAt(++i))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(s){case 3:n^=(255&t.charCodeAt(i+2))<<16;case 2:n^=(255&t.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(i)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}var Ct={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Tt(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}var kt=/[A-Z]|^ms/g,Mt=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Pt=function(t){return 45===t.charCodeAt(1)},It=function(t){return null!=t&&"boolean"!=typeof t},Rt=Tt((function(t){return Pt(t)?t:t.replace(kt,"-$&").toLowerCase()})),Lt=function(t,e){switch(t){case"animation":case"animationName":if("string"==typeof e)return e.replace(Mt,(function(t,e,n){return Ft={name:e,styles:n,next:Ft},e}))}return 1===Ct[t]||Pt(t)||"number"!=typeof e||0===e?e:e+"px"};function Dt(t,e,n){if(null==n)return"";var i=n;if(void 0!==i.__emotion_styles)return i;switch(typeof n){case"boolean":return"";case"object":var s=n;if(1===s.anim)return Ft={name:s.name,styles:s.styles,next:Ft},s.name;var r=n;if(void 0!==r.styles){var a=r.next;if(void 0!==a)for(;void 0!==a;)Ft={name:a.name,styles:a.styles,next:Ft},a=a.next;return r.styles+";"}return function(t,e,n){var i="";if(Array.isArray(n))for(var s=0;s<n.length;s++)i+=Dt(t,e,n[s])+";";else for(var r in n){var a=n[r];if("object"!=typeof a){var o=a;null!=e&&void 0!==e[o]?i+=r+"{"+e[o]+"}":It(o)&&(i+=Rt(r)+":"+Lt(r,o)+";")}else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=e&&void 0!==e[a[0]]){var l=Dt(t,e,a);switch(r){case"animation":case"animationName":i+=Rt(r)+":"+l+";";break;default:i+=r+"{"+l+"}"}}else for(var c=0;c<a.length;c++)It(a[c])&&(i+=Rt(r)+":"+Lt(r,a[c])+";")}return i}(t,e,n);case"function":if(void 0!==t){var o=Ft,l=n(t);return Ft=o,Dt(t,e,l)}}var c=n;if(null==e)return c;var d=e[c];return void 0!==d?d:c}var Ft,Ot=/label:\s*([^\s;{]+)\s*(;|$)/g;function Nt(t,e,n){if(1===t.length&&"object"==typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var i=!0,s="";Ft=void 0;var r=t[0];null==r||void 0===r.raw?(i=!1,s+=Dt(n,e,r)):s+=r[0];for(var a=1;a<t.length;a++)s+=Dt(n,e,t[a]),i&&(s+=r[a]);Ot.lastIndex=0;for(var o,l="";null!==(o=Ot.exec(s));)l+="-"+o[1];return{name:Et(s)+l,styles:s,next:Ft}}var Bt,Ht,zt=!!r.useInsertionEffect&&r.useInsertionEffect,Vt=zt||function(t){return t()},jt=(zt||s.useLayoutEffect,s.createContext("undefined"!=typeof HTMLElement?St({key:"css"}):null)),$t=(jt.Provider,function(t){return(0,s.forwardRef)((function(e,n){var i=(0,s.useContext)(jt);return t(e,i,n)}))}),Ut=s.createContext({}),Wt={}.hasOwnProperty,Gt="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",qt=function(t){var e=t.cache,n=t.serialized,i=t.isStringTag;return _t(e,n,i),Vt((function(){return function(t,e,n){_t(t,e,n);var i=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var s=e;do{t.insert(e===s?"."+i:"",s,t.sheet,!0),s=s.next}while(void 0!==s)}}(e,n,i)})),null},Xt=$t((function(t,e,n){var i=t.css;"string"==typeof i&&void 0!==e.registered[i]&&(i=e.registered[i]);var r=t[Gt],a=[i],o="";"string"==typeof t.className?o=function(t,e,n){var i="";return n.split(" ").forEach((function(n){void 0!==t[n]?e.push(t[n]+";"):n&&(i+=n+" ")})),i}(e.registered,a,t.className):null!=t.className&&(o=t.className+" ");var l=Nt(a,void 0,s.useContext(Ut));o+=e.key+"-"+l.name;var c={};for(var d in t)Wt.call(t,d)&&"css"!==d&&d!==Gt&&(c[d]=t[d]);return c.className=o,n&&(c.ref=n),s.createElement(s.Fragment,null,s.createElement(qt,{cache:e,serialized:l,isStringTag:"string"==typeof r}),s.createElement(r,c))})),Kt=Xt,Yt=(n(4146),function(t,e){var n=arguments;if(null==e||!Wt.call(e,"css"))return s.createElement.apply(void 0,n);var i=n.length,r=new Array(i);r[0]=Kt,r[1]=function(t,e){var n={};for(var i in e)Wt.call(e,i)&&(n[i]=e[i]);return n[Gt]=t,n}(t,e);for(var a=2;a<i;a++)r[a]=n[a];return s.createElement.apply(null,r)});function Jt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Nt(e)}Bt=Yt||(Yt={}),Ht||(Ht=Bt.JSX||(Bt.JSX={}));var Qt=n(40961);const Zt=Math.min,te=Math.max,ee=Math.round,ne=Math.floor,ie=t=>({x:t,y:t});function se(){return"undefined"!=typeof window}function re(t){return le(t)?(t.nodeName||"").toLowerCase():"#document"}function ae(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function oe(t){var e;return null==(e=(le(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function le(t){return!!se()&&(t instanceof Node||t instanceof ae(t).Node)}function ce(t){return!!se()&&(t instanceof Element||t instanceof ae(t).Element)}function de(t){return!!se()&&(t instanceof HTMLElement||t instanceof ae(t).HTMLElement)}function he(t){return!(!se()||"undefined"==typeof ShadowRoot)&&(t instanceof ShadowRoot||t instanceof ae(t).ShadowRoot)}function ue(t){const{overflow:e,overflowX:n,overflowY:i,display:s}=pe(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(s)}function pe(t){return ae(t).getComputedStyle(t)}function fe(t){const e=function(t){if("html"===re(t))return t;const e=t.assignedSlot||t.parentNode||he(t)&&t.host||oe(t);return he(e)?e.host:e}(t);return function(t){return["html","body","#document"].includes(re(t))}(e)?t.ownerDocument?t.ownerDocument.body:t.body:de(e)&&ue(e)?e:fe(e)}function ge(t,e,n){var i;void 0===e&&(e=[]),void 0===n&&(n=!0);const s=fe(t),r=s===(null==(i=t.ownerDocument)?void 0:i.body),a=ae(s);if(r){const t=me(a);return e.concat(a,a.visualViewport||[],ue(s)?s:[],t&&n?ge(t):[])}return e.concat(s,ge(s,[],n))}function me(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function be(t){return ce(t)?t:t.contextElement}function ve(t){const e=be(t);if(!de(e))return ie(1);const n=e.getBoundingClientRect(),{width:i,height:s,$:r}=function(t){const e=pe(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const s=de(t),r=s?t.offsetWidth:n,a=s?t.offsetHeight:i,o=ee(n)!==r||ee(i)!==a;return o&&(n=r,i=a),{width:n,height:i,$:o}}(e);let a=(r?ee(n.width):n.width)/i,o=(r?ee(n.height):n.height)/s;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}const ye=ie(0);function we(t){const e=ae(t);return"undefined"!=typeof CSS&&CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:ye}function Ae(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1);const s=t.getBoundingClientRect(),r=be(t);let a=ie(1);e&&(i?ce(i)&&(a=ve(i)):a=ve(t));const o=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==ae(t))&&e}(r,n,i)?we(r):ie(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,d=s.width/a.x,h=s.height/a.y;if(r){const t=ae(r),e=i&&ce(i)?ae(i):i;let n=t,s=me(n);for(;s&&i&&e!==n;){const t=ve(s),e=s.getBoundingClientRect(),i=pe(s),r=e.left+(s.clientLeft+parseFloat(i.paddingLeft))*t.x,a=e.top+(s.clientTop+parseFloat(i.paddingTop))*t.y;l*=t.x,c*=t.y,d*=t.x,h*=t.y,l+=r,c+=a,n=ae(s),s=me(n)}}return function(t){const{x:e,y:n,width:i,height:s}=t;return{width:i,height:s,top:n,left:e,right:e+i,bottom:n+s,x:e,y:n}}({width:d,height:h,x:l,y:c})}function xe(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}var Se=s.useLayoutEffect,_e=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Ee=function(){};function Ce(t,e){return e?"-"===e[0]?t+e:t+"__"+e:t}function Te(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var r=[].concat(i);if(e&&t)for(var a in e)e.hasOwnProperty(a)&&e[a]&&r.push("".concat(Ce(t,a)));return r.filter((function(t){return t})).map((function(t){return String(t).trim()})).join(" ")}var ke=function(t){return e=t,Array.isArray(e)?t.filter(Boolean):"object"===o(t)&&null!==t?[t]:[];var e},Me=function(t){return t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme,h({},g(t,_e))},Pe=function(t,e,n){var i=t.cx,s=t.getStyles,r=t.getClassNames,a=t.className;return{css:s(e,t),className:i(null!=n?n:{},r(e,t),a)}};function Ie(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function Re(t){return Ie(t)?window.pageYOffset:t.scrollTop}function Le(t,e){Ie(t)?window.scrollTo(0,e):t.scrollTop=e}function De(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ee,s=Re(t),r=e-s,a=0;!function e(){var o,l=r*((o=(o=a+=10)/n-1)*o*o+1)+s;Le(t,l),a<n?window.requestAnimationFrame(e):i(t)}()}function Fe(t,e){var n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),s=e.offsetHeight/3;i.bottom+s>n.bottom?Le(t,Math.min(e.offsetTop+e.clientHeight-t.offsetHeight+s,t.scrollHeight)):i.top-s<n.top&&Le(t,Math.max(e.offsetTop-s,0))}function Oe(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}var Ne=!1,Be={get passive(){return Ne=!0}},He="undefined"!=typeof window?window:{};He.addEventListener&&He.removeEventListener&&(He.addEventListener("p",Ee,Be),He.removeEventListener("p",Ee,!1));var ze=Ne;function Ve(t){return null!=t}function je(t,e,n){return t?e:n}var $e=["children","innerProps"],Ue=["children","innerProps"];var We,Ge,qe,Xe=function(t){return"auto"===t?"bottom":t},Ke=(0,s.createContext)(null),Ye=function(t){var e=t.children,n=t.minMenuHeight,i=t.maxMenuHeight,r=t.menuPlacement,a=t.menuPosition,o=t.menuShouldScrollIntoView,l=t.theme,c=((0,s.useContext)(Ke)||{}).setPortalPlacement,d=(0,s.useRef)(null),u=f((0,s.useState)(i),2),p=u[0],g=u[1],m=f((0,s.useState)(null),2),b=m[0],v=m[1],y=l.spacing.controlHeight;return Se((function(){var t=d.current;if(t){var e="fixed"===a,s=function(t){var e=t.maxHeight,n=t.menuEl,i=t.minHeight,s=t.placement,r=t.shouldScroll,a=t.isFixedPosition,o=t.controlHeight,l=function(t){var e=getComputedStyle(t),n="absolute"===e.position,i=/(auto|scroll)/;if("fixed"===e.position)return document.documentElement;for(var s=t;s=s.parentElement;)if(e=getComputedStyle(s),(!n||"static"!==e.position)&&i.test(e.overflow+e.overflowY+e.overflowX))return s;return document.documentElement}(n),c={placement:"bottom",maxHeight:e};if(!n||!n.offsetParent)return c;var d,h=l.getBoundingClientRect().height,u=n.getBoundingClientRect(),p=u.bottom,f=u.height,g=u.top,m=n.offsetParent.getBoundingClientRect().top,b=a||Ie(d=l)?window.innerHeight:d.clientHeight,v=Re(l),y=parseInt(getComputedStyle(n).marginBottom,10),w=parseInt(getComputedStyle(n).marginTop,10),A=m-w,x=b-g,S=A+v,_=h-v-g,E=p-b+v+y,C=v+g-w,T=160;switch(s){case"auto":case"bottom":if(x>=f)return{placement:"bottom",maxHeight:e};if(_>=f&&!a)return r&&De(l,E,T),{placement:"bottom",maxHeight:e};if(!a&&_>=i||a&&x>=i)return r&&De(l,E,T),{placement:"bottom",maxHeight:a?x-y:_-y};if("auto"===s||a){var k=e,M=a?A:S;return M>=i&&(k=Math.min(M-y-o,e)),{placement:"top",maxHeight:k}}if("bottom"===s)return r&&Le(l,E),{placement:"bottom",maxHeight:e};break;case"top":if(A>=f)return{placement:"top",maxHeight:e};if(S>=f&&!a)return r&&De(l,C,T),{placement:"top",maxHeight:e};if(!a&&S>=i||a&&A>=i){var P=e;return(!a&&S>=i||a&&A>=i)&&(P=a?A-w:S-w),r&&De(l,C,T),{placement:"top",maxHeight:P}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(s,'".'))}return c}({maxHeight:i,menuEl:t,minHeight:n,placement:r,shouldScroll:o&&!e,isFixedPosition:e,controlHeight:y});g(s.maxHeight),v(s.placement),null==c||c(s.placement)}}),[i,r,a,o,n,c,y]),e({ref:d,placerProps:h(h({},t),{},{placement:b||Xe(r),maxHeight:p})})},Je=function(t,e){var n=t.theme,i=n.spacing.baseUnit,s=n.colors;return h({textAlign:"center"},e?{}:{color:s.neutral40,padding:"".concat(2*i,"px ").concat(3*i,"px")})},Qe=Je,Ze=Je,tn=["size"],en=["innerProps","isRtl","size"],nn={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},sn=function(t){var e=t.size,n=g(t,tn);return Yt("svg",b({height:e,width:e,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:nn},n))},rn=function(t){return Yt(sn,b({size:20},t),Yt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},an=function(t){return Yt(sn,b({size:20},t),Yt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},on=function(t,e){var n=t.isFocused,i=t.theme,s=i.spacing.baseUnit,r=i.colors;return h({label:"indicatorContainer",display:"flex",transition:"color 150ms"},e?{}:{color:n?r.neutral60:r.neutral20,padding:2*s,":hover":{color:n?r.neutral80:r.neutral40}})},ln=on,cn=on,dn=function(){var t=Jt.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}(We||(Ge=["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"],qe||(qe=Ge.slice(0)),We=Object.freeze(Object.defineProperties(Ge,{raw:{value:Object.freeze(qe)}})))),hn=function(t){var e=t.delay,n=t.offset;return Yt("span",{css:Jt({animation:"".concat(dn," 1s ease-in-out ").concat(e,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},un=["data"],pn=["innerRef","isDisabled","isHidden","inputClassName"],fn={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},gn={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":h({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},fn)},mn=function(t){return h({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},fn)},bn=function(t){var e=t.children,n=t.innerProps;return Yt("div",n,e)},vn={ClearIndicator:function(t){var e=t.children,n=t.innerProps;return Yt("div",b({},Pe(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),e||Yt(rn,null))},Control:function(t){var e=t.children,n=t.isDisabled,i=t.isFocused,s=t.innerRef,r=t.innerProps,a=t.menuIsOpen;return Yt("div",b({ref:s},Pe(t,"control",{control:!0,"control--is-disabled":n,"control--is-focused":i,"control--menu-is-open":a}),r,{"aria-disabled":n||void 0}),e)},DropdownIndicator:function(t){var e=t.children,n=t.innerProps;return Yt("div",b({},Pe(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),e||Yt(an,null))},DownChevron:an,CrossIcon:rn,Group:function(t){var e=t.children,n=t.cx,i=t.getStyles,s=t.getClassNames,r=t.Heading,a=t.headingProps,o=t.innerProps,l=t.label,c=t.theme,d=t.selectProps;return Yt("div",b({},Pe(t,"group",{group:!0}),o),Yt(r,b({},a,{selectProps:d,theme:c,getStyles:i,getClassNames:s,cx:n}),l),Yt("div",null,e))},GroupHeading:function(t){var e=Me(t);e.data;var n=g(e,un);return Yt("div",b({},Pe(t,"groupHeading",{"group-heading":!0}),n))},IndicatorsContainer:function(t){var e=t.children,n=t.innerProps;return Yt("div",b({},Pe(t,"indicatorsContainer",{indicators:!0}),n),e)},IndicatorSeparator:function(t){var e=t.innerProps;return Yt("span",b({},e,Pe(t,"indicatorSeparator",{"indicator-separator":!0})))},Input:function(t){var e=t.cx,n=t.value,i=Me(t),s=i.innerRef,r=i.isDisabled,a=i.isHidden,o=i.inputClassName,l=g(i,pn);return Yt("div",b({},Pe(t,"input",{"input-container":!0}),{"data-value":n||""}),Yt("input",b({className:e({input:!0},o),ref:s,style:mn(a),disabled:r},l)))},LoadingIndicator:function(t){var e=t.innerProps,n=t.isRtl,i=t.size,s=void 0===i?4:i,r=g(t,en);return Yt("div",b({},Pe(h(h({},r),{},{innerProps:e,isRtl:n,size:s}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),e),Yt(hn,{delay:0,offset:n}),Yt(hn,{delay:160,offset:!0}),Yt(hn,{delay:320,offset:!n}))},Menu:function(t){var e=t.children,n=t.innerRef,i=t.innerProps;return Yt("div",b({},Pe(t,"menu",{menu:!0}),{ref:n},i),e)},MenuList:function(t){var e=t.children,n=t.innerProps,i=t.innerRef,s=t.isMulti;return Yt("div",b({},Pe(t,"menuList",{"menu-list":!0,"menu-list--is-multi":s}),{ref:i},n),e)},MenuPortal:function(t){var e=t.appendTo,n=t.children,i=t.controlElement,r=t.innerProps,a=t.menuPlacement,o=t.menuPosition,l=(0,s.useRef)(null),c=(0,s.useRef)(null),d=f((0,s.useState)(Xe(a)),2),u=d[0],p=d[1],g=(0,s.useMemo)((function(){return{setPortalPlacement:p}}),[]),m=f((0,s.useState)(null),2),v=m[0],y=m[1],w=(0,s.useCallback)((function(){if(i){var t=function(t){var e=t.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}(i),e="fixed"===o?0:window.pageYOffset,n=t[u]+e;n===(null==v?void 0:v.offset)&&t.left===(null==v?void 0:v.rect.left)&&t.width===(null==v?void 0:v.rect.width)||y({offset:n,rect:t})}}),[i,o,u,null==v?void 0:v.offset,null==v?void 0:v.rect.left,null==v?void 0:v.rect.width]);Se((function(){w()}),[w]);var A=(0,s.useCallback)((function(){"function"==typeof c.current&&(c.current(),c.current=null),i&&l.current&&(c.current=function(t,e,n,i){void 0===i&&(i={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:l=!1}=i,c=be(t),d=s||r?[...c?ge(c):[],...ge(e)]:[];d.forEach((t=>{s&&t.addEventListener("scroll",n,{passive:!0}),r&&t.addEventListener("resize",n)}));const h=c&&o?function(t,e){let n,i=null;const s=oe(t);function r(){var t;clearTimeout(n),null==(t=i)||t.disconnect(),i=null}return function a(o,l){void 0===o&&(o=!1),void 0===l&&(l=1),r();const c=t.getBoundingClientRect(),{left:d,top:h,width:u,height:p}=c;if(o||e(),!u||!p)return;const f={rootMargin:-ne(h)+"px "+-ne(s.clientWidth-(d+u))+"px "+-ne(s.clientHeight-(h+p))+"px "+-ne(d)+"px",threshold:te(0,Zt(1,l))||1};let g=!0;function m(e){const i=e[0].intersectionRatio;if(i!==l){if(!g)return a();i?a(!1,i):n=setTimeout((()=>{a(!1,1e-7)}),1e3)}1!==i||xe(c,t.getBoundingClientRect())||a(),g=!1}try{i=new IntersectionObserver(m,{...f,root:s.ownerDocument})}catch(t){i=new IntersectionObserver(m,f)}i.observe(t)}(!0),r}(c,n):null;let u,p=-1,f=null;a&&(f=new ResizeObserver((t=>{let[i]=t;i&&i.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame((()=>{var t;null==(t=f)||t.observe(e)}))),n()})),c&&!l&&f.observe(c),f.observe(e));let g=l?Ae(t):null;return l&&function e(){const i=Ae(t);g&&!xe(g,i)&&n(),g=i,u=requestAnimationFrame(e)}(),n(),()=>{var t;d.forEach((t=>{s&&t.removeEventListener("scroll",n),r&&t.removeEventListener("resize",n)})),null==h||h(),null==(t=f)||t.disconnect(),f=null,l&&cancelAnimationFrame(u)}}(i,l.current,w,{elementResize:"ResizeObserver"in window}))}),[i,w]);Se((function(){A()}),[A]);var x=(0,s.useCallback)((function(t){l.current=t,A()}),[A]);if(!e&&"fixed"!==o||!v)return null;var S=Yt("div",b({ref:x},Pe(h(h({},t),{},{offset:v.offset,position:o,rect:v.rect}),"menuPortal",{"menu-portal":!0}),r),n);return Yt(Ke.Provider,{value:g},e?(0,Qt.createPortal)(S,e):S)},LoadingMessage:function(t){var e=t.children,n=void 0===e?"Loading...":e,i=t.innerProps,s=g(t,Ue);return Yt("div",b({},Pe(h(h({},s),{},{children:n,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),n)},NoOptionsMessage:function(t){var e=t.children,n=void 0===e?"No options":e,i=t.innerProps,s=g(t,$e);return Yt("div",b({},Pe(h(h({},s),{},{children:n,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),n)},MultiValue:function(t){var e=t.children,n=t.components,i=t.data,s=t.innerProps,r=t.isDisabled,a=t.removeProps,o=t.selectProps,l=n.Container,c=n.Label,d=n.Remove;return Yt(l,{data:i,innerProps:h(h({},Pe(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":r})),s),selectProps:o},Yt(c,{data:i,innerProps:h({},Pe(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:o},e),Yt(d,{data:i,innerProps:h(h({},Pe(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(e||"option")},a),selectProps:o}))},MultiValueContainer:bn,MultiValueLabel:bn,MultiValueRemove:function(t){var e=t.children,n=t.innerProps;return Yt("div",b({role:"button"},n),e||Yt(rn,{size:14}))},Option:function(t){var e=t.children,n=t.isDisabled,i=t.isFocused,s=t.isSelected,r=t.innerRef,a=t.innerProps;return Yt("div",b({},Pe(t,"option",{option:!0,"option--is-disabled":n,"option--is-focused":i,"option--is-selected":s}),{ref:r,"aria-disabled":n},a),e)},Placeholder:function(t){var e=t.children,n=t.innerProps;return Yt("div",b({},Pe(t,"placeholder",{placeholder:!0}),n),e)},SelectContainer:function(t){var e=t.children,n=t.innerProps,i=t.isDisabled,s=t.isRtl;return Yt("div",b({},Pe(t,"container",{"--is-disabled":i,"--is-rtl":s}),n),e)},SingleValue:function(t){var e=t.children,n=t.isDisabled,i=t.innerProps;return Yt("div",b({},Pe(t,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),i),e)},ValueContainer:function(t){var e=t.children,n=t.innerProps,i=t.isMulti,s=t.hasValue;return Yt("div",b({},Pe(t,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":s}),n),e)}},yn=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function wn(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!((i=t[n])===(s=e[n])||yn(i)&&yn(s)))return!1;var i,s;return!0}for(var An={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},xn=function(t){return Yt("span",b({css:An},t))},Sn={guidance:function(t){var e=t.isSearchable,n=t.isMulti,i=t.tabSelectsValue,s=t.context,r=t.isInitialFocus;switch(s){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return r?"".concat(t["aria-label"]||"Select"," is focused ").concat(e?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var e=t.action,n=t.label,i=void 0===n?"":n,s=t.labels,r=t.isDisabled;switch(e){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(s.length>1?"s":""," ").concat(s.join(","),", selected.");case"select-option":return"option ".concat(i,r?" is disabled. Select another option.":", selected.");default:return""}},onFocus:function(t){var e=t.context,n=t.focused,i=t.options,s=t.label,r=void 0===s?"":s,a=t.selectValue,o=t.isDisabled,l=t.isSelected,c=t.isAppleDevice,d=function(t,e){return t&&t.length?"".concat(t.indexOf(e)+1," of ").concat(t.length):""};if("value"===e&&a)return"value ".concat(r," focused, ").concat(d(a,n),".");if("menu"===e&&c){var h=o?" disabled":"",u="".concat(l?" selected":"").concat(h);return"".concat(r).concat(u,", ").concat(d(i,n),".")}return""},onFilter:function(t){var e=t.inputValue,n=t.resultsMessage;return"".concat(n).concat(e?" for search term "+e:"",".")}},_n=function(t){var e=t.ariaSelection,n=t.focusedOption,i=t.focusedValue,r=t.focusableOptions,a=t.isFocused,o=t.selectValue,l=t.selectProps,c=t.id,d=t.isAppleDevice,u=l.ariaLiveMessages,p=l.getOptionLabel,f=l.inputValue,g=l.isMulti,m=l.isOptionDisabled,b=l.isSearchable,v=l.menuIsOpen,y=l.options,w=l.screenReaderStatus,A=l.tabSelectsValue,x=l.isLoading,S=l["aria-label"],_=l["aria-live"],E=(0,s.useMemo)((function(){return h(h({},Sn),u||{})}),[u]),C=(0,s.useMemo)((function(){var t,n="";if(e&&E.onChange){var i=e.option,s=e.options,r=e.removedValue,a=e.removedValues,l=e.value,c=r||i||(t=l,Array.isArray(t)?null:t),d=c?p(c):"",u=s||a||void 0,f=u?u.map(p):[],g=h({isDisabled:c&&m(c,o),label:d,labels:f},e);n=E.onChange(g)}return n}),[e,E,m,o,p]),T=(0,s.useMemo)((function(){var t="",e=n||i,s=!!(n&&o&&o.includes(n));if(e&&E.onFocus){var a={focused:e,label:p(e),isDisabled:m(e,o),isSelected:s,options:r,context:e===n?"menu":"value",selectValue:o,isAppleDevice:d};t=E.onFocus(a)}return t}),[n,i,p,m,E,r,o,d]),k=(0,s.useMemo)((function(){var t="";if(v&&y.length&&!x&&E.onFilter){var e=w({count:r.length});t=E.onFilter({inputValue:f,resultsMessage:e})}return t}),[r,f,v,E,y,w,x]),M="initial-input-focus"===(null==e?void 0:e.action),P=(0,s.useMemo)((function(){var t="";if(E.guidance){var e=i?"value":v?"menu":"input";t=E.guidance({"aria-label":S,context:e,isDisabled:n&&m(n,o),isMulti:g,isSearchable:b,tabSelectsValue:A,isInitialFocus:M})}return t}),[S,n,i,g,m,b,v,E,o,A,M]),I=Yt(s.Fragment,null,Yt("span",{id:"aria-selection"},C),Yt("span",{id:"aria-focused"},T),Yt("span",{id:"aria-results"},k),Yt("span",{id:"aria-guidance"},P));return Yt(s.Fragment,null,Yt(xn,{id:c},M&&I),Yt(xn,{"aria-live":_,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},a&&!M&&I))},En=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],Cn=new RegExp("["+En.map((function(t){return t.letters})).join("")+"]","g"),Tn={},kn=0;kn<En.length;kn++)for(var Mn=En[kn],Pn=0;Pn<Mn.letters.length;Pn++)Tn[Mn.letters[Pn]]=Mn.base;var In=function(t){return t.replace(Cn,(function(t){return Tn[t]}))},Rn=function(t,e){void 0===e&&(e=wn);var n=null;function i(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];if(n&&n.lastThis===this&&e(i,n.lastArgs))return n.lastResult;var r=t.apply(this,i);return n={lastResult:r,lastArgs:i,lastThis:this},r}return i.clear=function(){n=null},i}(In),Ln=function(t){return t.replace(/^\s+|\s+$/g,"")},Dn=function(t){return"".concat(t.label," ").concat(t.value)},Fn=["innerRef"];function On(t){var e=t.innerRef,n=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var s=Object.entries(t).filter((function(t){var e=f(t,1)[0];return!n.includes(e)}));return s.reduce((function(t,e){var n=f(e,2),i=n[0],s=n[1];return t[i]=s,t}),{})}(g(t,Fn),"onExited","in","enter","exit","appear");return Yt("input",b({ref:e},n,{css:Jt({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var Nn=["boxSizing","height","overflow","paddingRight","position"],Bn={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Hn(t){t.cancelable&&t.preventDefault()}function zn(t){t.stopPropagation()}function Vn(){var t=this.scrollTop,e=this.scrollHeight,n=t+this.offsetHeight;0===t?this.scrollTop=1:n===e&&(this.scrollTop=t-1)}function jn(){return"ontouchstart"in window||navigator.maxTouchPoints}var $n=!("undefined"==typeof window||!window.document||!window.document.createElement),Un=0,Wn={capture:!1,passive:!1},Gn=function(t){var e=t.target;return e.ownerDocument.activeElement&&e.ownerDocument.activeElement.blur()},qn={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function Xn(t){var e=t.children,n=t.lockEnabled,i=t.captureEnabled,r=function(t){var e=t.isEnabled,n=t.onBottomArrive,i=t.onBottomLeave,r=t.onTopArrive,a=t.onTopLeave,o=(0,s.useRef)(!1),l=(0,s.useRef)(!1),c=(0,s.useRef)(0),d=(0,s.useRef)(null),h=(0,s.useCallback)((function(t,e){if(null!==d.current){var s=d.current,c=s.scrollTop,h=s.scrollHeight,u=s.clientHeight,p=d.current,f=e>0,g=h-u-c,m=!1;g>e&&o.current&&(i&&i(t),o.current=!1),f&&l.current&&(a&&a(t),l.current=!1),f&&e>g?(n&&!o.current&&n(t),p.scrollTop=h,m=!0,o.current=!0):!f&&-e>c&&(r&&!l.current&&r(t),p.scrollTop=0,m=!0,l.current=!0),m&&function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()}(t)}}),[n,i,r,a]),u=(0,s.useCallback)((function(t){h(t,t.deltaY)}),[h]),p=(0,s.useCallback)((function(t){c.current=t.changedTouches[0].clientY}),[]),f=(0,s.useCallback)((function(t){var e=c.current-t.changedTouches[0].clientY;h(t,e)}),[h]),g=(0,s.useCallback)((function(t){if(t){var e=!!ze&&{passive:!1};t.addEventListener("wheel",u,e),t.addEventListener("touchstart",p,e),t.addEventListener("touchmove",f,e)}}),[f,p,u]),m=(0,s.useCallback)((function(t){t&&(t.removeEventListener("wheel",u,!1),t.removeEventListener("touchstart",p,!1),t.removeEventListener("touchmove",f,!1))}),[f,p,u]);return(0,s.useEffect)((function(){if(e){var t=d.current;return g(t),function(){m(t)}}}),[e,g,m]),function(t){d.current=t}}({isEnabled:void 0===i||i,onBottomArrive:t.onBottomArrive,onBottomLeave:t.onBottomLeave,onTopArrive:t.onTopArrive,onTopLeave:t.onTopLeave}),a=function(t){var e=t.isEnabled,n=t.accountForScrollbars,i=void 0===n||n,r=(0,s.useRef)({}),a=(0,s.useRef)(null),o=(0,s.useCallback)((function(t){if($n){var e=document.body,n=e&&e.style;if(i&&Nn.forEach((function(t){var e=n&&n[t];r.current[t]=e})),i&&Un<1){var s=parseInt(r.current.paddingRight,10)||0,a=document.body?document.body.clientWidth:0,o=window.innerWidth-a+s||0;Object.keys(Bn).forEach((function(t){var e=Bn[t];n&&(n[t]=e)})),n&&(n.paddingRight="".concat(o,"px"))}e&&jn()&&(e.addEventListener("touchmove",Hn,Wn),t&&(t.addEventListener("touchstart",Vn,Wn),t.addEventListener("touchmove",zn,Wn))),Un+=1}}),[i]),l=(0,s.useCallback)((function(t){if($n){var e=document.body,n=e&&e.style;Un=Math.max(Un-1,0),i&&Un<1&&Nn.forEach((function(t){var e=r.current[t];n&&(n[t]=e)})),e&&jn()&&(e.removeEventListener("touchmove",Hn,Wn),t&&(t.removeEventListener("touchstart",Vn,Wn),t.removeEventListener("touchmove",zn,Wn)))}}),[i]);return(0,s.useEffect)((function(){if(e){var t=a.current;return o(t),function(){l(t)}}}),[e,o,l]),function(t){a.current=t}}({isEnabled:n});return Yt(s.Fragment,null,n&&Yt("div",{onClick:Gn,css:qn}),e((function(t){r(t),a(t)})))}var Kn={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},Yn=function(t){var e=t.name,n=t.onFocus;return Yt("input",{required:!0,name:e,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:Kn,value:"",onChange:function(){}})};function Jn(t){var e;return"undefined"!=typeof window&&null!=window.navigator&&t.test((null===(e=window.navigator.userAgentData)||void 0===e?void 0:e.platform)||window.navigator.platform)}function Qn(){return Jn(/^Mac/i)}var Zn={clearIndicator:cn,container:function(t){var e=t.isDisabled;return{label:"container",direction:t.isRtl?"rtl":void 0,pointerEvents:e?"none":void 0,position:"relative"}},control:function(t,e){var n=t.isDisabled,i=t.isFocused,s=t.theme,r=s.colors,a=s.borderRadius;return h({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:s.spacing.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},e?{}:{backgroundColor:n?r.neutral5:r.neutral0,borderColor:n?r.neutral10:i?r.primary:r.neutral20,borderRadius:a,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(r.primary):void 0,"&:hover":{borderColor:i?r.primary:r.neutral30}})},dropdownIndicator:ln,group:function(t,e){var n=t.theme.spacing;return e?{}:{paddingBottom:2*n.baseUnit,paddingTop:2*n.baseUnit}},groupHeading:function(t,e){var n=t.theme,i=n.colors,s=n.spacing;return h({label:"group",cursor:"default",display:"block"},e?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:3*s.baseUnit,paddingRight:3*s.baseUnit,textTransform:"uppercase"})},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(t,e){var n=t.isDisabled,i=t.theme,s=i.spacing.baseUnit,r=i.colors;return h({label:"indicatorSeparator",alignSelf:"stretch",width:1},e?{}:{backgroundColor:n?r.neutral10:r.neutral20,marginBottom:2*s,marginTop:2*s})},input:function(t,e){var n=t.isDisabled,i=t.value,s=t.theme,r=s.spacing,a=s.colors;return h(h({visibility:n?"hidden":"visible",transform:i?"translateZ(0)":""},gn),e?{}:{margin:r.baseUnit/2,paddingBottom:r.baseUnit/2,paddingTop:r.baseUnit/2,color:a.neutral80})},loadingIndicator:function(t,e){var n=t.isFocused,i=t.size,s=t.theme,r=s.colors,a=s.spacing.baseUnit;return h({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},e?{}:{color:n?r.neutral60:r.neutral20,padding:2*a})},loadingMessage:Ze,menu:function(t,e){var n,i=t.placement,s=t.theme,r=s.borderRadius,a=s.spacing,o=s.colors;return h((c(n={label:"menu"},function(t){return t?{bottom:"top",top:"bottom"}[t]:"bottom"}(i),"100%"),c(n,"position","absolute"),c(n,"width","100%"),c(n,"zIndex",1),n),e?{}:{backgroundColor:o.neutral0,borderRadius:r,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:a.menuGutter,marginTop:a.menuGutter})},menuList:function(t,e){var n=t.maxHeight,i=t.theme.spacing.baseUnit;return h({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},e?{}:{paddingBottom:i,paddingTop:i})},menuPortal:function(t){var e=t.rect,n=t.offset,i=t.position;return{left:e.left,position:i,top:n,width:e.width,zIndex:1}},multiValue:function(t,e){var n=t.theme,i=n.spacing,s=n.borderRadius,r=n.colors;return h({label:"multiValue",display:"flex",minWidth:0},e?{}:{backgroundColor:r.neutral10,borderRadius:s/2,margin:i.baseUnit/2})},multiValueLabel:function(t,e){var n=t.theme,i=n.borderRadius,s=n.colors,r=t.cropWithEllipsis;return h({overflow:"hidden",textOverflow:r||void 0===r?"ellipsis":void 0,whiteSpace:"nowrap"},e?{}:{borderRadius:i/2,color:s.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},multiValueRemove:function(t,e){var n=t.theme,i=n.spacing,s=n.borderRadius,r=n.colors,a=t.isFocused;return h({alignItems:"center",display:"flex"},e?{}:{borderRadius:s/2,backgroundColor:a?r.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:r.dangerLight,color:r.danger}})},noOptionsMessage:Qe,option:function(t,e){var n=t.isDisabled,i=t.isFocused,s=t.isSelected,r=t.theme,a=r.spacing,o=r.colors;return h({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},e?{}:{backgroundColor:s?o.primary:i?o.primary25:"transparent",color:n?o.neutral20:s?o.neutral0:"inherit",padding:"".concat(2*a.baseUnit,"px ").concat(3*a.baseUnit,"px"),":active":{backgroundColor:n?void 0:s?o.primary:o.primary50}})},placeholder:function(t,e){var n=t.theme,i=n.spacing,s=n.colors;return h({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},e?{}:{color:s.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},singleValue:function(t,e){var n=t.isDisabled,i=t.theme,s=i.spacing,r=i.colors;return h({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e?{}:{color:n?r.neutral40:r.neutral80,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},valueContainer:function(t,e){var n=t.theme.spacing,i=t.isMulti,s=t.hasValue,r=t.selectProps.controlShouldRenderValue;return h({alignItems:"center",display:i&&s&&r?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},e?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(2*n.baseUnit,"px")})}},ti={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},ei={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Oe(),captureMenuScroll:!Oe(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(t,e){if(t.data.__isNew__)return!0;var n=h({ignoreCase:!0,ignoreAccents:!0,stringify:Dn,trim:!0,matchFrom:"any"},undefined),i=n.ignoreCase,s=n.ignoreAccents,r=n.stringify,a=n.trim,o=n.matchFrom,l=a?Ln(e):e,c=a?Ln(r(t)):r(t);return i&&(l=l.toLowerCase(),c=c.toLowerCase()),s&&(l=Rn(l),c=In(c)),"start"===o?c.substr(0,l.length)===l:c.indexOf(l)>-1},formatGroupLabel:function(t){return t.label},getOptionLabel:function(t){return t.label},getOptionValue:function(t){return t.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(t){return!!t.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(t){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var e=t.count;return"".concat(e," result").concat(1!==e?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function ni(t,e,n,i){return{type:"option",data:e,isDisabled:di(t,e,n),isSelected:hi(t,e,n),label:li(t,e),value:ci(t,e),index:i}}function ii(t,e){return t.options.map((function(n,i){if("options"in n){var s=n.options.map((function(n,i){return ni(t,n,e,i)})).filter((function(e){return ai(t,e)}));return s.length>0?{type:"group",data:n,options:s,index:i}:void 0}var r=ni(t,n,e,i);return ai(t,r)?r:void 0})).filter(Ve)}function si(t){return t.reduce((function(t,e){return"group"===e.type?t.push.apply(t,x(e.options.map((function(t){return t.data})))):t.push(e.data),t}),[])}function ri(t,e){return t.reduce((function(t,n){return"group"===n.type?t.push.apply(t,x(n.options.map((function(t){return{data:t.data,id:"".concat(e,"-").concat(n.index,"-").concat(t.index)}})))):t.push({data:n.data,id:"".concat(e,"-").concat(n.index)}),t}),[])}function ai(t,e){var n=t.inputValue,i=void 0===n?"":n,s=e.data,r=e.isSelected,a=e.label,o=e.value;return(!pi(t)||!r)&&ui(t,{label:a,value:o,data:s},i)}var oi=function(t,e){var n;return(null===(n=t.find((function(t){return t.data===e})))||void 0===n?void 0:n.id)||null},li=function(t,e){return t.getOptionLabel(e)},ci=function(t,e){return t.getOptionValue(e)};function di(t,e,n){return"function"==typeof t.isOptionDisabled&&t.isOptionDisabled(e,n)}function hi(t,e,n){if(n.indexOf(e)>-1)return!0;if("function"==typeof t.isOptionSelected)return t.isOptionSelected(e,n);var i=ci(t,e);return n.some((function(e){return ci(t,e)===i}))}function ui(t,e,n){return!t.filterOption||t.filterOption(e,n)}var pi=function(t){var e=t.hideSelectedOptions,n=t.isMulti;return void 0===e?n:e},fi=1,gi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}(n,t);var e=function(t){var e=A();return function(){var n,i=w(t);if(e){var s=w(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}(n);function n(t){var i;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this,t)).state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},i.blockOptionHover=!1,i.isComposing=!1,i.commonProps=void 0,i.initialTouchX=0,i.initialTouchY=0,i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.isAppleDevice=Qn()||Jn(/^iPhone/i)||Jn(/^iPad/i)||Qn()&&navigator.maxTouchPoints>1,i.controlRef=null,i.getControlRef=function(t){i.controlRef=t},i.focusedOptionRef=null,i.getFocusedOptionRef=function(t){i.focusedOptionRef=t},i.menuListRef=null,i.getMenuListRef=function(t){i.menuListRef=t},i.inputRef=null,i.getInputRef=function(t){i.inputRef=t},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(t,e){var n=i.props,s=n.onChange,r=n.name;e.name=r,i.ariaOnChange(t,e),s(t,e)},i.setValue=function(t,e,n){var s=i.props,r=s.closeMenuOnSelect,a=s.isMulti,o=s.inputValue;i.onInputChange("",{action:"set-value",prevInputValue:o}),r&&(i.setState({inputIsHiddenAfterUpdate:!a}),i.onMenuClose()),i.setState({clearFocusValueOnUpdate:!0}),i.onChange(t,{action:e,option:n})},i.selectOption=function(t){var e=i.props,n=e.blurInputOnSelect,s=e.isMulti,r=e.name,a=i.state.selectValue,o=s&&i.isOptionSelected(t,a),l=i.isOptionDisabled(t,a);if(o){var c=i.getOptionValue(t);i.setValue(a.filter((function(t){return i.getOptionValue(t)!==c})),"deselect-option",t)}else{if(l)return void i.ariaOnChange(t,{action:"select-option",option:t,name:r});s?i.setValue([].concat(x(a),[t]),"select-option",t):i.setValue(t,"select-option")}n&&i.blurInput()},i.removeValue=function(t){var e=i.props.isMulti,n=i.state.selectValue,s=i.getOptionValue(t),r=n.filter((function(t){return i.getOptionValue(t)!==s})),a=je(e,r,r[0]||null);i.onChange(a,{action:"remove-value",removedValue:t}),i.focusInput()},i.clearValue=function(){var t=i.state.selectValue;i.onChange(je(i.props.isMulti,[],null),{action:"clear",removedValues:t})},i.popValue=function(){var t=i.props.isMulti,e=i.state.selectValue,n=e[e.length-1],s=e.slice(0,e.length-1),r=je(t,s,s[0]||null);n&&i.onChange(r,{action:"pop-value",removedValue:n})},i.getFocusedOptionId=function(t){return oi(i.state.focusableOptionsWithIds,t)},i.getFocusableOptionsWithIds=function(){return ri(ii(i.props,i.state.selectValue),i.getElementId("option"))},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Te.apply(void 0,[i.props.classNamePrefix].concat(e))},i.getOptionLabel=function(t){return li(i.props,t)},i.getOptionValue=function(t){return ci(i.props,t)},i.getStyles=function(t,e){var n=i.props.unstyled,s=Zn[t](e,n);s.boxSizing="border-box";var r=i.props.styles[t];return r?r(s,e):s},i.getClassNames=function(t,e){var n,s;return null===(n=(s=i.props.classNames)[t])||void 0===n?void 0:n.call(s,e)},i.getElementId=function(t){return"".concat(i.state.instancePrefix,"-").concat(t)},i.getComponents=function(){return t=i.props,h(h({},vn),t.components);var t},i.buildCategorizedOptions=function(){return ii(i.props,i.state.selectValue)},i.getCategorizedOptions=function(){return i.props.menuIsOpen?i.buildCategorizedOptions():[]},i.buildFocusableOptions=function(){return si(i.buildCategorizedOptions())},i.getFocusableOptions=function(){return i.props.menuIsOpen?i.buildFocusableOptions():[]},i.ariaOnChange=function(t,e){i.setState({ariaSelection:h({value:t},e)})},i.onMenuMouseDown=function(t){0===t.button&&(t.stopPropagation(),t.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(t){i.blockOptionHover=!1},i.onControlMouseDown=function(t){if(!t.defaultPrevented){var e=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&i.onMenuClose():e&&i.openMenu("first"):(e&&(i.openAfterFocus=!0),i.focusInput()),"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&t.preventDefault()}},i.onDropdownIndicatorMouseDown=function(t){if(!(t&&"mousedown"===t.type&&0!==t.button||i.props.isDisabled)){var e=i.props,n=e.isMulti,s=e.menuIsOpen;i.focusInput(),s?(i.setState({inputIsHiddenAfterUpdate:!n}),i.onMenuClose()):i.openMenu("first"),t.preventDefault()}},i.onClearIndicatorMouseDown=function(t){t&&"mousedown"===t.type&&0!==t.button||(i.clearValue(),t.preventDefault(),i.openAfterFocus=!1,"touchend"===t.type?i.focusInput():setTimeout((function(){return i.focusInput()})))},i.onScroll=function(t){"boolean"==typeof i.props.closeMenuOnScroll?t.target instanceof HTMLElement&&Ie(t.target)&&i.props.onMenuClose():"function"==typeof i.props.closeMenuOnScroll&&i.props.closeMenuOnScroll(t)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(t){var e=t.touches,n=e&&e.item(0);n&&(i.initialTouchX=n.clientX,i.initialTouchY=n.clientY,i.userIsDragging=!1)},i.onTouchMove=function(t){var e=t.touches,n=e&&e.item(0);if(n){var s=Math.abs(n.clientX-i.initialTouchX),r=Math.abs(n.clientY-i.initialTouchY);i.userIsDragging=s>5||r>5}},i.onTouchEnd=function(t){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(t.target)&&i.menuListRef&&!i.menuListRef.contains(t.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(t){i.userIsDragging||i.onControlMouseDown(t)},i.onClearIndicatorTouchEnd=function(t){i.userIsDragging||i.onClearIndicatorMouseDown(t)},i.onDropdownIndicatorTouchEnd=function(t){i.userIsDragging||i.onDropdownIndicatorMouseDown(t)},i.handleInputChange=function(t){var e=i.props.inputValue,n=t.currentTarget.value;i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange(n,{action:"input-change",prevInputValue:e}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(t){i.props.onFocus&&i.props.onFocus(t),i.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(t){var e=i.props.inputValue;i.menuListRef&&i.menuListRef.contains(document.activeElement)?i.inputRef.focus():(i.props.onBlur&&i.props.onBlur(t),i.onInputChange("",{action:"input-blur",prevInputValue:e}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1}))},i.onOptionHover=function(t){if(!i.blockOptionHover&&i.state.focusedOption!==t){var e=i.getFocusableOptions().indexOf(t);i.setState({focusedOption:t,focusedOptionId:e>-1?i.getFocusedOptionId(t):null})}},i.shouldHideSelectedOptions=function(){return pi(i.props)},i.onValueInputFocus=function(t){t.preventDefault(),t.stopPropagation(),i.focus()},i.onKeyDown=function(t){var e=i.props,n=e.isMulti,s=e.backspaceRemovesValue,r=e.escapeClearsValue,a=e.inputValue,o=e.isClearable,l=e.isDisabled,c=e.menuIsOpen,d=e.onKeyDown,h=e.tabSelectsValue,u=e.openMenuOnFocus,p=i.state,f=p.focusedOption,g=p.focusedValue,m=p.selectValue;if(!(l||"function"==typeof d&&(d(t),t.defaultPrevented))){switch(i.blockOptionHover=!0,t.key){case"ArrowLeft":if(!n||a)return;i.focusValue("previous");break;case"ArrowRight":if(!n||a)return;i.focusValue("next");break;case"Delete":case"Backspace":if(a)return;if(g)i.removeValue(g);else{if(!s)return;n?i.popValue():o&&i.clearValue()}break;case"Tab":if(i.isComposing)return;if(t.shiftKey||!c||!h||!f||u&&i.isOptionSelected(f,m))return;i.selectOption(f);break;case"Enter":if(229===t.keyCode)break;if(c){if(!f)return;if(i.isComposing)return;i.selectOption(f);break}return;case"Escape":c?(i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange("",{action:"menu-close",prevInputValue:a}),i.onMenuClose()):o&&r&&i.clearValue();break;case" ":if(a)return;if(!c){i.openMenu("first");break}if(!f)return;i.selectOption(f);break;case"ArrowUp":c?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":c?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!c)return;i.focusOption("pageup");break;case"PageDown":if(!c)return;i.focusOption("pagedown");break;case"Home":if(!c)return;i.focusOption("first");break;case"End":if(!c)return;i.focusOption("last");break;default:return}t.preventDefault()}},i.state.instancePrefix="react-select-"+(i.props.instanceId||++fi),i.state.selectValue=ke(t.value),t.menuIsOpen&&i.state.selectValue.length){var s=i.getFocusableOptionsWithIds(),r=i.buildFocusableOptions(),a=r.indexOf(i.state.selectValue[0]);i.state.focusableOptionsWithIds=s,i.state.focusedOption=r[a],i.state.focusedOptionId=oi(s,r[a])}return i}return function(t,e,n){e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1})}(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&Fe(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(t){var e=this.props,n=e.isDisabled,i=e.menuIsOpen,s=this.state.isFocused;(s&&!n&&t.isDisabled||s&&i&&!t.menuIsOpen)&&this.focusInput(),s&&n&&!t.isDisabled?this.setState({isFocused:!1},this.onMenuClose):s||n||!t.isDisabled||this.inputRef!==document.activeElement||this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(Fe(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(t,e){this.props.onInputChange(t,e)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(t){var e=this,n=this.state,i=n.selectValue,s=n.isFocused,r=this.buildFocusableOptions(),a="first"===t?0:r.length-1;if(!this.props.isMulti){var o=r.indexOf(i[0]);o>-1&&(a=o)}this.scrollToFocusedOptionOnUpdate=!(s&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:r[a],focusedOptionId:this.getFocusedOptionId(r[a])},(function(){return e.onMenuOpen()}))}},{key:"focusValue",value:function(t){var e=this.state,n=e.selectValue,i=e.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var s=n.indexOf(i);i||(s=-1);var r=n.length-1,a=-1;if(n.length){switch(t){case"previous":a=0===s?0:-1===s?r:s-1;break;case"next":s>-1&&s<r&&(a=s+1)}this.setState({inputIsHidden:-1!==a,focusedValue:n[a]})}}}},{key:"focusOption",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",e=this.props.pageSize,n=this.state.focusedOption,i=this.getFocusableOptions();if(i.length){var s=0,r=i.indexOf(n);n||(r=-1),"up"===t?s=r>0?r-1:i.length-1:"down"===t?s=(r+1)%i.length:"pageup"===t?(s=r-e)<0&&(s=0):"pagedown"===t?(s=r+e)>i.length-1&&(s=i.length-1):"last"===t&&(s=i.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:i[s],focusedValue:null,focusedOptionId:this.getFocusedOptionId(i[s])})}}},{key:"getTheme",value:function(){return this.props.theme?"function"==typeof this.props.theme?this.props.theme(ti):h(h({},ti),this.props.theme):ti}},{key:"getCommonProps",value:function(){var t=this.clearValue,e=this.cx,n=this.getStyles,i=this.getClassNames,s=this.getValue,r=this.selectOption,a=this.setValue,o=this.props,l=o.isMulti,c=o.isRtl,d=o.options;return{clearValue:t,cx:e,getStyles:n,getClassNames:i,getValue:s,hasValue:this.hasValue(),isMulti:l,isRtl:c,options:d,selectOption:r,selectProps:o,setValue:a,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var t=this.props,e=t.isClearable,n=t.isMulti;return void 0===e?n:e}},{key:"isOptionDisabled",value:function(t,e){return di(this.props,t,e)}},{key:"isOptionSelected",value:function(t,e){return hi(this.props,t,e)}},{key:"filterOption",value:function(t,e){return ui(this.props,t,e)}},{key:"formatOptionLabel",value:function(t,e){if("function"==typeof this.props.formatOptionLabel){var n=this.props.inputValue,i=this.state.selectValue;return this.props.formatOptionLabel(t,{context:e,inputValue:n,selectValue:i})}return this.getOptionLabel(t)}},{key:"formatGroupLabel",value:function(t){return this.props.formatGroupLabel(t)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var t=this.props,e=t.isDisabled,n=t.isSearchable,i=t.inputId,r=t.inputValue,a=t.tabIndex,o=t.form,l=t.menuIsOpen,c=t.required,d=this.getComponents().Input,u=this.state,p=u.inputIsHidden,f=u.ariaSelection,g=this.commonProps,m=i||this.getElementId("input"),v=h(h(h({"aria-autocomplete":"list","aria-expanded":l,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":c,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},l&&{"aria-controls":this.getElementId("listbox")}),!n&&{"aria-readonly":!0}),this.hasValue()?"initial-input-focus"===(null==f?void 0:f.action)&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return n?s.createElement(d,b({},g,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:m,innerRef:this.getInputRef,isDisabled:e,isHidden:p,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:a,form:o,type:"text",value:r},v)):s.createElement(On,b({id:m,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Ee,onFocus:this.onInputFocus,disabled:e,tabIndex:a,inputMode:"none",form:o,value:""},v))}},{key:"renderPlaceholderOrValue",value:function(){var t=this,e=this.getComponents(),n=e.MultiValue,i=e.MultiValueContainer,r=e.MultiValueLabel,a=e.MultiValueRemove,o=e.SingleValue,l=e.Placeholder,c=this.commonProps,d=this.props,h=d.controlShouldRenderValue,u=d.isDisabled,p=d.isMulti,f=d.inputValue,g=d.placeholder,m=this.state,v=m.selectValue,y=m.focusedValue,w=m.isFocused;if(!this.hasValue()||!h)return f?null:s.createElement(l,b({},c,{key:"placeholder",isDisabled:u,isFocused:w,innerProps:{id:this.getElementId("placeholder")}}),g);if(p)return v.map((function(e,o){var l=e===y,d="".concat(t.getOptionLabel(e),"-").concat(t.getOptionValue(e));return s.createElement(n,b({},c,{components:{Container:i,Label:r,Remove:a},isFocused:l,isDisabled:u,key:d,index:o,removeProps:{onClick:function(){return t.removeValue(e)},onTouchEnd:function(){return t.removeValue(e)},onMouseDown:function(t){t.preventDefault()}},data:e}),t.formatOptionLabel(e,"value"))}));if(f)return null;var A=v[0];return s.createElement(o,b({},c,{data:A,isDisabled:u}),this.formatOptionLabel(A,"value"))}},{key:"renderClearIndicator",value:function(){var t=this.getComponents().ClearIndicator,e=this.commonProps,n=this.props,i=n.isDisabled,r=n.isLoading,a=this.state.isFocused;if(!this.isClearable()||!t||i||!this.hasValue()||r)return null;var o={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return s.createElement(t,b({},e,{innerProps:o,isFocused:a}))}},{key:"renderLoadingIndicator",value:function(){var t=this.getComponents().LoadingIndicator,e=this.commonProps,n=this.props,i=n.isDisabled,r=n.isLoading,a=this.state.isFocused;return t&&r?s.createElement(t,b({},e,{innerProps:{"aria-hidden":"true"},isDisabled:i,isFocused:a})):null}},{key:"renderIndicatorSeparator",value:function(){var t=this.getComponents(),e=t.DropdownIndicator,n=t.IndicatorSeparator;if(!e||!n)return null;var i=this.commonProps,r=this.props.isDisabled,a=this.state.isFocused;return s.createElement(n,b({},i,{isDisabled:r,isFocused:a}))}},{key:"renderDropdownIndicator",value:function(){var t=this.getComponents().DropdownIndicator;if(!t)return null;var e=this.commonProps,n=this.props.isDisabled,i=this.state.isFocused,r={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return s.createElement(t,b({},e,{innerProps:r,isDisabled:n,isFocused:i}))}},{key:"renderMenu",value:function(){var t=this,e=this.getComponents(),n=e.Group,i=e.GroupHeading,r=e.Menu,a=e.MenuList,o=e.MenuPortal,l=e.LoadingMessage,c=e.NoOptionsMessage,d=e.Option,h=this.commonProps,u=this.state.focusedOption,p=this.props,f=p.captureMenuScroll,g=p.inputValue,m=p.isLoading,v=p.loadingMessage,y=p.minMenuHeight,w=p.maxMenuHeight,A=p.menuIsOpen,x=p.menuPlacement,S=p.menuPosition,_=p.menuPortalTarget,E=p.menuShouldBlockScroll,C=p.menuShouldScrollIntoView,T=p.noOptionsMessage,k=p.onMenuScrollToTop,M=p.onMenuScrollToBottom;if(!A)return null;var P,I=function(e,n){var i=e.type,r=e.data,a=e.isDisabled,o=e.isSelected,l=e.label,c=e.value,p=u===r,f=a?void 0:function(){return t.onOptionHover(r)},g=a?void 0:function(){return t.selectOption(r)},m="".concat(t.getElementId("option"),"-").concat(n),v={id:m,onClick:g,onMouseMove:f,onMouseOver:f,tabIndex:-1,role:"option","aria-selected":t.isAppleDevice?void 0:o};return s.createElement(d,b({},h,{innerProps:v,data:r,isDisabled:a,isSelected:o,key:m,label:l,type:i,value:c,isFocused:p,innerRef:p?t.getFocusedOptionRef:void 0}),t.formatOptionLabel(e.data,"menu"))};if(this.hasOptions())P=this.getCategorizedOptions().map((function(e){if("group"===e.type){var r=e.data,a=e.options,o=e.index,l="".concat(t.getElementId("group"),"-").concat(o),c="".concat(l,"-heading");return s.createElement(n,b({},h,{key:l,data:r,options:a,Heading:i,headingProps:{id:c,data:e.data},label:t.formatGroupLabel(e.data)}),e.options.map((function(t){return I(t,"".concat(o,"-").concat(t.index))})))}if("option"===e.type)return I(e,"".concat(e.index))}));else if(m){var R=v({inputValue:g});if(null===R)return null;P=s.createElement(l,h,R)}else{var L=T({inputValue:g});if(null===L)return null;P=s.createElement(c,h,L)}var D={minMenuHeight:y,maxMenuHeight:w,menuPlacement:x,menuPosition:S,menuShouldScrollIntoView:C},F=s.createElement(Ye,b({},h,D),(function(e){var n=e.ref,i=e.placerProps,o=i.placement,l=i.maxHeight;return s.createElement(r,b({},h,D,{innerRef:n,innerProps:{onMouseDown:t.onMenuMouseDown,onMouseMove:t.onMenuMouseMove},isLoading:m,placement:o}),s.createElement(Xn,{captureEnabled:f,onTopArrive:k,onBottomArrive:M,lockEnabled:E},(function(e){return s.createElement(a,b({},h,{innerRef:function(n){t.getMenuListRef(n),e(n)},innerProps:{role:"listbox","aria-multiselectable":h.isMulti,id:t.getElementId("listbox")},isLoading:m,maxHeight:l,focusedOption:u}),P)})))}));return _||"fixed"===S?s.createElement(o,b({},h,{appendTo:_,controlElement:this.controlRef,menuPlacement:x,menuPosition:S}),F):F}},{key:"renderFormField",value:function(){var t=this,e=this.props,n=e.delimiter,i=e.isDisabled,r=e.isMulti,a=e.name,o=e.required,l=this.state.selectValue;if(o&&!this.hasValue()&&!i)return s.createElement(Yn,{name:a,onFocus:this.onValueInputFocus});if(a&&!i){if(r){if(n){var c=l.map((function(e){return t.getOptionValue(e)})).join(n);return s.createElement("input",{name:a,type:"hidden",value:c})}var d=l.length>0?l.map((function(e,n){return s.createElement("input",{key:"i-".concat(n),name:a,type:"hidden",value:t.getOptionValue(e)})})):s.createElement("input",{name:a,type:"hidden",value:""});return s.createElement("div",null,d)}var h=l[0]?this.getOptionValue(l[0]):"";return s.createElement("input",{name:a,type:"hidden",value:h})}}},{key:"renderLiveRegion",value:function(){var t=this.commonProps,e=this.state,n=e.ariaSelection,i=e.focusedOption,r=e.focusedValue,a=e.isFocused,o=e.selectValue,l=this.getFocusableOptions();return s.createElement(_n,b({},t,{id:this.getElementId("live-region"),ariaSelection:n,focusedOption:i,focusedValue:r,isFocused:a,selectValue:o,focusableOptions:l,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var t=this.getComponents(),e=t.Control,n=t.IndicatorsContainer,i=t.SelectContainer,r=t.ValueContainer,a=this.props,o=a.className,l=a.id,c=a.isDisabled,d=a.menuIsOpen,h=this.state.isFocused,u=this.commonProps=this.getCommonProps();return s.createElement(i,b({},u,{className:o,innerProps:{id:l,onKeyDown:this.onKeyDown},isDisabled:c,isFocused:h}),this.renderLiveRegion(),s.createElement(e,b({},u,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:c,isFocused:h,menuIsOpen:d}),s.createElement(r,b({},u,{isDisabled:c}),this.renderPlaceholderOrValue(),this.renderInput()),s.createElement(n,b({},u,{isDisabled:c}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(t,e){var n=e.prevProps,i=e.clearFocusValueOnUpdate,s=e.inputIsHiddenAfterUpdate,r=e.ariaSelection,a=e.isFocused,o=e.prevWasFocused,l=e.instancePrefix,c=t.options,d=t.value,u=t.menuIsOpen,p=t.inputValue,f=t.isMulti,g=ke(d),m={};if(n&&(d!==n.value||c!==n.options||u!==n.menuIsOpen||p!==n.inputValue)){var b=u?function(t,e){return si(ii(t,e))}(t,g):[],v=u?ri(ii(t,g),"".concat(l,"-option")):[],y=i?function(t,e){var n=t.focusedValue,i=t.selectValue.indexOf(n);if(i>-1){if(e.indexOf(n)>-1)return n;if(i<e.length)return e[i]}return null}(e,g):null,w=function(t,e){var n=t.focusedOption;return n&&e.indexOf(n)>-1?n:e[0]}(e,b);m={selectValue:g,focusedOption:w,focusedOptionId:oi(v,w),focusableOptionsWithIds:v,focusedValue:y,clearFocusValueOnUpdate:!1}}var A=null!=s&&t!==n?{inputIsHidden:s,inputIsHiddenAfterUpdate:void 0}:{},x=r,S=a&&o;return a&&!S&&(x={value:je(f,g,g[0]||null),options:g,action:"initial-input-focus"},S=!o),"initial-input-focus"===(null==r?void 0:r.action)&&(x=null),h(h(h({},m),A),{},{prevProps:t,ariaSelection:x,prevWasFocused:S})}}]),n}(s.Component);gi.defaultProps=ei;var mi=(0,s.forwardRef)((function(t,e){var n=function(t){var e=t.defaultInputValue,n=void 0===e?"":e,i=t.defaultMenuIsOpen,r=void 0!==i&&i,a=t.defaultValue,o=void 0===a?null:a,l=t.inputValue,c=t.menuIsOpen,d=t.onChange,u=t.onInputChange,p=t.onMenuClose,b=t.onMenuOpen,v=t.value,y=g(t,m),w=f((0,s.useState)(void 0!==l?l:n),2),A=w[0],x=w[1],S=f((0,s.useState)(void 0!==c?c:r),2),_=S[0],E=S[1],C=f((0,s.useState)(void 0!==v?v:o),2),T=C[0],k=C[1],M=(0,s.useCallback)((function(t,e){"function"==typeof d&&d(t,e),k(t)}),[d]),P=(0,s.useCallback)((function(t,e){var n;"function"==typeof u&&(n=u(t,e)),x(void 0!==n?n:t)}),[u]),I=(0,s.useCallback)((function(){"function"==typeof b&&b(),E(!0)}),[b]),R=(0,s.useCallback)((function(){"function"==typeof p&&p(),E(!1)}),[p]),L=void 0!==l?l:A,D=void 0!==c?c:_,F=void 0!==v?v:T;return h(h({},y),{},{inputValue:L,menuIsOpen:D,onChange:M,onInputChange:P,onMenuClose:R,onMenuOpen:I,value:F})}(t);return s.createElement(gi,b({ref:e},n))})),bi=mi,vi=function(){return s.createElement("footer",{style:{textAlign:"center",marginTop:"20px"}},s.createElement("p",null,"Version: ","1.0.0.110"))},yi=function(){return yi=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},yi.apply(this,arguments)},wi=(0,s.memo)((function(t){return s.createElement(vn.SingleValue,yi({},t),s.createElement("div",{style:{display:"flex",alignItems:"center"}},s.createElement("img",{src:t.data.flag,alt:t.data.label,style:{width:"20px",height:"15px",marginRight:"10px"}}),t.data.label))})),Ai=(0,s.memo)((function(t){return s.createElement(vn.Option,yi({},t),s.createElement("div",{style:{display:"flex",alignItems:"center"}},s.createElement("img",{src:t.data.flag,alt:t.data.label,style:{width:"20px",height:"15px",marginRight:"10px"}}),t.data.label))})),xi=n(85072),Si=n.n(xi),_i=n(97825),Ei=n.n(_i),Ci=n(77659),Ti=n.n(Ci),ki=n(55056),Mi=n.n(ki),Pi=n(10540),Ii=n.n(Pi),Ri=n(41113),Li=n.n(Ri),Di=n(5171),Fi={};Fi.styleTagTransform=Li(),Fi.setAttributes=Mi(),Fi.insert=Ti().bind(null,"head"),Fi.domAPI=Ei(),Fi.insertStyleElement=Ii(),Si()(Di.A,Fi),Di.A&&Di.A.locals&&Di.A.locals;var Oi=function(t){var e=t.appSettings,n=t.encrypt,i=t.showLoggedInUI,r=(0,s.useState)(null),a=r[0],o=r[1],l=(0,s.useState)(""),c=l[0],d=l[1],h=(0,s.useState)(""),u=h[0],p=h[1],f=(0,s.useState)(null),g=f[0],m=f[1],b=(0,s.useState)(""),v=b[0],y=b[1],w=(0,s.useMemo)((function(){return Object.entries(e.AuthenticationUrls).map((function(t){var n=t[0],i=t[1];return{value:"".concat(i,"/login"),label:n,flag:e.AgencyFlags[n]}}))}),[e]);return(0,s.useEffect)((function(){w.length>0&&o(w[0])}),[w]),(0,s.useEffect)((function(){Office.onReady((function(){var t=Office.context.roamingSettings.get("accessToken"),e=Office.context.roamingSettings.get("userName");t&&e&&(m(t),d(e),i(t))}))}),[i]),s.createElement("div",{className:"login-container"},g?s.createElement("div",{className:"login-success"},s.createElement("p",null,"✅ You are now connected as ",s.createElement("strong",null,c),"."),s.createElement("button",{onClick:function(){Office.context.roamingSettings.remove("accessToken"),Office.context.roamingSettings.remove("refreshToken"),Office.context.roamingSettings.remove("userName"),Office.context.roamingSettings.saveAsync(),m(null),d(""),p(""),o(null)}},"Log Out")):s.createElement(s.Fragment,null,s.createElement("h2",{className:"login-title"},"Sign in to Invoice AI"),s.createElement("div",{className:"login-field"},s.createElement("label",{htmlFor:"agency-select"},"Select Agency:"),s.createElement(bi,{id:"agency-select",value:a,onChange:function(t){return o(t)},options:w,components:{SingleValue:wi,Option:Ai}})),s.createElement("div",{className:"login-field"},s.createElement("label",{htmlFor:"username"},"Username"),s.createElement("input",{id:"username",type:"text",value:c,onChange:function(t){return d(t.target.value)},placeholder:"Enter your username"})),s.createElement("div",{className:"login-field"},s.createElement("label",{htmlFor:"password"},"Password"),s.createElement("input",{id:"password",type:"password",value:u,onChange:function(t){return p(t.target.value)},placeholder:"Enter your password"})),v&&s.createElement("p",{style:{color:"red"}},v),s.createElement("div",{style:{textAlign:"center"}},s.createElement("button",{onClick:function(){return t=void 0,e=void 0,r=function(){var t,e,s,r,o,l,d,h,p;return function(t,e){var n,i,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,i&&(s=2&o[0]?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(f){switch(f.label){case 0:if(!a||!c||!u)return y("Please fill in all fields."),[2];t=a.value,e={userName:c,password:u,loginRsponse:{}},f.label=1;case 1:return f.trys.push([1,4,,5]),[4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 2:return[4,f.sent().json()];case 3:return s=f.sent(),r=null===(h=null==s?void 0:s.token)||void 0===h?void 0:h.access_token,o=null===(p=null==s?void 0:s.token)||void 0===p?void 0:p.refresh_token,r&&o?(l=n(r),d=n(o),Office.context.roamingSettings.set("accessToken",l),Office.context.roamingSettings.set("refreshToken",d),Office.context.roamingSettings.set("userName",c),Office.context.roamingSettings.set("selectedAgency",a.label),Office.context.roamingSettings.saveAsync(),m(l),i(l),[3,5]):(y("Login failed. Please check your credentials."),[2]);case 4:return f.sent(),y("An error occurred during login. Please try again."),[3,5];case 5:return[2]}}))},new((s=void 0)||(s=Promise))((function(n,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function o(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,o)}l((r=r.apply(t,e||[])).next())}));var t,e,s,r}},"Log In"))),s.createElement(vi,null))},Ni=function(t){var e=t.showAll,n=t.onToggle;return s.createElement("div",{style:{marginBottom:"10px"}},s.createElement("label",null,s.createElement("input",{type:"checkbox",checked:e,onChange:function(t){return n(t.target.checked)},style:{marginRight:"5px"}}),"Show All Attachments"))},Bi=function(t){var e=t.attachments,n=t.onSend,i=t.sending;return s.createElement("div",{className:"attachment-table"},s.createElement("table",null,s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",null,"Name"),s.createElement("th",null,"Size"),s.createElement("th",null,"Actions"))),s.createElement("tbody",null,e.map((function(t,e){return s.createElement("tr",{key:e},s.createElement("td",null,t.name),s.createElement("td",null,(t.size/1024).toFixed(2)," KB"),s.createElement("td",null,s.createElement("button",{onClick:function(){return n(t)},disabled:i},i?"Sending...":"Send to ERP")))})))))},Hi={d:(t,e)=>{for(var n in e)Hi.o(e,n)&&!Hi.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},zi=globalThis.pdfjsLib={};Hi.d(zi,{AbortException:()=>gs,AnnotationEditorLayer:()=>Xo,AnnotationEditorParamsType:()=>qi,AnnotationEditorType:()=>Gi,AnnotationEditorUIManager:()=>tr,AnnotationLayer:()=>Do,AnnotationMode:()=>Wi,ColorPicker:()=>Uo,DOMSVGFactory:()=>eo,DrawLayer:()=>Ko,FeatureTest:()=>ys,GlobalWorkerOptions:()=>Kr,ImageKind:()=>Ki,InvalidPDFException:()=>hs,MissingPDFException:()=>us,OPS:()=>Ji,OutputScale:()=>Ws,PDFDataRangeTransport:()=>Ha,PDFDateString:()=>Hs,PDFWorker:()=>$a,PasswordResponses:()=>Qi,PermissionFlag:()=>Xi,PixelsPerInch:()=>Ts,RenderingCancelledException:()=>Ps,TextLayer:()=>Ma,UnexpectedResponseException:()=>ps,Util:()=>As,VerbosityLevel:()=>Yi,XfaLayer:()=>no,build:()=>Ya,createValidAbsoluteUrl:()=>as,fetchData:()=>ks,getDocument:()=>Oa,getFilenameFromUrl:()=>Ls,getPdfFilenameFromUrl:()=>Ds,getXfaPageViewport:()=>zs,isDataScheme:()=>Is,isPdfFile:()=>Rs,noContextMenu:()=>Ns,normalizeUnicode:()=>_s,setLayerDimensions:()=>Us,shadow:()=>os,version:()=>Ka});const Vi=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),ji=[1,0,0,1,0,0],$i=[.001,0,0,.001,0,0],Ui=1.35,Wi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Gi={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},qi={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},Xi={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ki={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Yi={ERRORS:0,WARNINGS:1,INFOS:5},Ji={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Qi={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Zi=Yi.WARNINGS;function ts(t){Number.isInteger(t)&&(Zi=t)}function es(){return Zi}function ns(t){Zi>=Yi.INFOS&&console.log(`Info: ${t}`)}function is(t){Zi>=Yi.WARNINGS&&console.log(`Warning: ${t}`)}function ss(t){throw new Error(t)}function rs(t,e){t||ss(e)}function as(t,e=null,n=null){if(!t)return null;try{if(n&&"string"==typeof t){if(n.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(n.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch{}}const i=e?new URL(t,e):new URL(t);if(function(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null}function os(t,e,n,i=!1){return Object.defineProperty(t,e,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const ls=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}();class cs extends ls{constructor(t,e){super(t,"PasswordException"),this.code=e}}class ds extends ls{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class hs extends ls{constructor(t){super(t,"InvalidPDFException")}}class us extends ls{constructor(t){super(t,"MissingPDFException")}}class ps extends ls{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class fs extends ls{constructor(t){super(t,"FormatError")}}class gs extends ls{constructor(t){super(t,"AbortException")}}function ms(t){"object"==typeof t&&void 0!==t?.length||ss("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const i=[];for(let s=0;s<e;s+=n){const r=Math.min(s+n,e),a=t.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function bs(t){"string"!=typeof t&&ss("Invalid argument for stringToBytes");const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;++i)n[i]=255&t.charCodeAt(i);return n}function vs(t){const e=Object.create(null);for(const[n,i]of t)e[n]=i;return e}class ys{static get isLittleEndian(){return os(this,"isLittleEndian",function(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return os(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return os(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"!=typeof navigator&&"string"==typeof navigator?.platform?os(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:"string"==typeof navigator?.userAgent&&navigator.userAgent.includes("Firefox")}):os(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return os(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const ws=Array.from(Array(256).keys(),(t=>t.toString(16).padStart(2,"0")));class As{static makeHexColor(t,e,n){return`#${ws[t]}${ws[e]}${ws[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),r=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],s[0],r[0]),Math.min(n[1],i[1],s[1],r[1]),Math.max(n[0],i[0],s[0],r[0]),Math.max(n[1],i[1],s[1],r[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],r=t[2]*e[1]+t[3]*e[3],a=(n+r)/2,o=Math.sqrt((n+r)**2-4*(n*r-s*i))/2,l=a+o||1,c=a-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),r=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>r?null:[n,s,i,r]}static#t(t,e,n,i,s,r,a,o,l,c){if(l<=0||l>=1)return;const d=1-l,h=l*l,u=h*l,p=d*(d*(d*t+3*l*e)+3*h*n)+u*i,f=d*(d*(d*s+3*l*r)+3*h*a)+u*o;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}static#e(t,e,n,i,s,r,a,o,l,c,d,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&this.#t(t,e,n,i,s,r,a,o,-d/c,h));const u=c**2-4*d*l;if(u<0)return;const p=Math.sqrt(u),f=2*l;this.#t(t,e,n,i,s,r,a,o,(-c+p)/f,h),this.#t(t,e,n,i,s,r,a,o,(-c-p)/f,h)}static bezierBoundingBox(t,e,n,i,s,r,a,o,l){return l?(l[0]=Math.min(l[0],t,a),l[1]=Math.min(l[1],e,o),l[2]=Math.max(l[2],t,a),l[3]=Math.max(l[3],e,o)):l=[Math.min(t,a),Math.min(e,o),Math.max(t,a),Math.max(e,o)],this.#e(t,n,s,a,e,i,r,o,3*(3*(n-s)-t+a),6*(t-2*n+s),3*(n-t),l),this.#e(t,n,s,a,e,i,r,o,3*(3*(i-r)-e+o),6*(e-2*i+r),3*(i-e),l),l}}let xs=null,Ss=null;function _s(t){return xs||(xs=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ss=new Map([["ﬅ","ſt"]])),t.replaceAll(xs,((t,e,n)=>e?e.normalize("NFKC"):Ss.get(n)))}const Es="pdfjs_internal_id_",Cs="http://www.w3.org/2000/svg";class Ts{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ks(t,e="text"){if(Os(t,document.baseURI)){const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);switch(e){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise(((n,i)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200!==s.status&&0!==s.status)i(new Error(s.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":return void n(s.response)}n(s.responseText)}},s.send(null)}))}class Ms{constructor({viewBox:t,scale:e,rotation:n,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}){this.viewBox=t,this.scale=e,this.rotation=n,this.offsetX=i,this.offsetY=s;const a=(t[2]+t[0])/2,o=(t[3]+t[1])/2;let l,c,d,h,u,p,f,g;switch((n%=360)<0&&(n+=360),n){case 180:l=-1,c=0,d=0,h=1;break;case 90:l=0,c=1,d=1,h=0;break;case 270:l=0,c=-1,d=-1,h=0;break;case 0:l=1,c=0,d=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(d=-d,h=-h),0===l?(u=Math.abs(o-t[1])*e+i,p=Math.abs(a-t[0])*e+s,f=(t[3]-t[1])*e,g=(t[2]-t[0])*e):(u=Math.abs(a-t[0])*e+i,p=Math.abs(o-t[1])*e+s,f=(t[2]-t[0])*e,g=(t[3]-t[1])*e),this.transform=[l*e,c*e,d*e,h*e,u-l*e*a-d*e*o,p-c*e*a-h*e*o],this.width=f,this.height=g}get rawDims(){const{viewBox:t}=this;return os(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new Ms({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){return As.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=As.applyTransform([t[0],t[1]],this.transform),n=As.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return As.applyInverseTransform([t,e],this.transform)}}class Ps extends ls{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Is(t){const e=t.length;let n=0;for(;n<e&&""===t[n].trim();)n++;return"data:"===t.substring(n,n+5).toLowerCase()}function Rs(t){return"string"==typeof t&&/\.pdf$/i.test(t)}function Ls(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function Ds(t,e="document.pdf"){if("string"!=typeof t)return e;if(Is(t))return is('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||e}class Fs{started=Object.create(null);times=[];time(t){t in this.started&&is(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||is(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:t}of this.times)e=Math.max(t.length,e);for(const{name:n,start:i,end:s}of this.times)t.push(`${n.padEnd(e)} ${s-i}ms\n`);return t.join("")}}function Os(t,e){try{const{protocol:n}=e?new URL(t,e):new URL(t);return"http:"===n||"https:"===n}catch{return!1}}function Ns(t){t.preventDefault()}function Bs(t){console.log("Deprecated API usage: "+t)}class Hs{static#n;static toDateObject(t){if(!t||"string"!=typeof t)return null;this.#n||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#n.exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let r=parseInt(e[4],10);r=r>=0&&r<=23?r:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let o=parseInt(e[6],10);o=o>=0&&o<=59?o:0;const l=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(r+=c,a+=d):"+"===l&&(r-=c,a-=d),new Date(Date.UTC(n,i,s,r,a,o))}}function zs(t,{scale:e=1,rotation:n=0}){const{width:i,height:s}=t.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new Ms({viewBox:r,scale:e,rotation:n})}function Vs(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map((t=>parseInt(t))):t.startsWith("rgba(")?t.slice(5,-1).split(",").map((t=>parseInt(t))).slice(0,3):(is(`Not a valid color format: "${t}"`),[0,0,0])}function js(t){const{a:e,b:n,c:i,d:s,e:r,f:a}=t.getTransform();return[e,n,i,s,r,a]}function $s(t){const{a:e,b:n,c:i,d:s,e:r,f:a}=t.getTransform().invertSelf();return[e,n,i,s,r,a]}function Us(t,e,n=!1,i=!0){if(e instanceof Ms){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:r}=t,a=ys.isCSSRoundSupported,o=`var(--scale-factor) * ${i}px`,l=`var(--scale-factor) * ${s}px`,c=a?`round(down, ${o}, var(--scale-round-x, 1px))`:`calc(${o})`,d=a?`round(down, ${l}, var(--scale-round-y, 1px))`:`calc(${l})`;n&&e.rotation%180!=0?(r.width=d,r.height=c):(r.width=c,r.height=d)}i&&t.setAttribute("data-main-rotation",e.rotation)}class Ws{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}}class Gs{#i=null;#s=null;#r;#a=null;#o=null;static#l=null;constructor(t){this.#r=t,Gs.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#i=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#r._uiManager._signal;t.addEventListener("contextmenu",Ns,{signal:e}),t.addEventListener("pointerdown",Gs.#c,{signal:e});const n=this.#a=document.createElement("div");n.className="buttons",t.append(n);const i=this.#r.toolbarPosition;if(i){const{style:e}=t,n="ltr"===this.#r._uiManager.direction?1-i[0]:i[0];e.insetInlineEnd=100*n+"%",e.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),t}get div(){return this.#i}static#c(t){t.stopPropagation()}#h(t){this.#r._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()}#u(t){this.#r._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()}#p(t){const e=this.#r._uiManager._signal;t.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ns,{signal:e})}hide(){this.#i.classList.add("hidden"),this.#s?.hideDropdown()}show(){this.#i.classList.remove("hidden"),this.#o?.shown()}#d(){const{editorType:t,_uiManager:e}=this.#r,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",Gs.#l[t]),this.#p(n),n.addEventListener("click",(t=>{e.delete()}),{signal:e._signal}),this.#a.append(n)}get#f(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#p(e),this.#a.prepend(e,this.#f),this.#o=t}addColorPicker(t){this.#s=t;const e=t.renderButton();this.#p(e),this.#a.prepend(e,this.#f)}remove(){this.#i.remove(),this.#s?.destroy(),this.#s=null}}class qs{#a=null;#i=null;#g;constructor(t){this.#g=t}#m(){const t=this.#i=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ns,{signal:this.#g._signal});const e=this.#a=document.createElement("div");return e.className="buttons",t.append(e),this.#b(),t}#v(t,e){let n=0,i=0;for(const s of t){const t=s.y+s.height;if(t<n)continue;const r=s.x+(e?s.width:0);t>n?(i=r,n=t):e?r>i&&(i=r):r<i&&(i=r)}return[e?1-i:i,n]}show(t,e,n){const[i,s]=this.#v(e,n),{style:r}=this.#i||=this.#m();t.append(this.#i),r.insetInlineEnd=100*i+"%",r.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#i.remove()}#b(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#g._signal;t.addEventListener("contextmenu",Ns,{signal:n}),t.addEventListener("click",(()=>{this.#g.highlightSelection("floating_button")}),{signal:n}),this.#a.append(t)}}function Xs(t,e,n){for(const i of n)e.addEventListener(i,t[i].bind(t))}class Ks{#y=0;get id(){return"pdfjs_internal_editor_"+this.#y++}}class Ys{#w=function(){if("undefined"!=typeof crypto&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);if("undefined"!=typeof crypto&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(t);else for(let e=0;e<32;e++)t[e]=Math.floor(255*Math.random());return ms(t)}();#y=0;#A=null;static get _isSVGFittingCanvas(){const t=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',os(this,"_isSVGFittingCanvas",e.decode().then((()=>(t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0]))))}async#x(t,e){this.#A||=new Map;let n=this.#A.get(t);if(null===n)return null;if(n?.bitmap)return n.refCounter+=1,n;try{let t;if(n||={bitmap:null,id:`image_${this.#w}_${this.#y++}`,refCounter:0,isSvg:!1},"string"==typeof e?(n.url=e,t=await ks(e,"blob")):e instanceof File?t=n.file=e:e instanceof Blob&&(t=e),"image/svg+xml"===t.type){const e=Ys._isSVGFittingCanvas,i=new FileReader,s=new Image,r=new Promise(((t,r)=>{s.onload=()=>{n.bitmap=s,n.isSvg=!0,t()},i.onload=async()=>{const t=n.svgUrl=i.result;s.src=await e?`${t}#svgView(preserveAspectRatio(none))`:t},s.onerror=i.onerror=r}));i.readAsDataURL(t),await r}else n.bitmap=await createImageBitmap(t);n.refCounter=1}catch(t){console.error(t),n=null}return this.#A.set(t,n),n&&this.#A.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:i,type:s}=t;return this.#x(`${e}_${n}_${i}_${s}`,t)}async getFromUrl(t){return this.#x(t,t)}async getFromBlob(t,e){const n=await e;return this.#x(t,n)}async getFromId(t){this.#A||=new Map;const e=this.#A.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:t}=e;return delete e.blobPromise,this.getFromBlob(e.id,t)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#A||=new Map;let n=this.#A.get(t);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#w}_${this.#y++}`,refCounter:1,isSvg:!1},this.#A.set(t,n),this.#A.set(n.id,n),n}getSvgUrl(t){const e=this.#A.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#A||=new Map;const e=this.#A.get(t);if(!e)return;if(e.refCounter-=1,0!==e.refCounter)return;const{bitmap:n}=e;if(!e.url&&!e.file){const t=new OffscreenCanvas(n.width,n.height);t.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=t.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#w}_`)}}class Js{#S=[];#_=!1;#E;#C=-1;constructor(t=128){this.#E=t}add({cmd:t,undo:e,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:r=!1,keepUndo:a=!1}){if(i&&t(),this.#_)return;const o={cmd:t,undo:e,post:n,type:s};if(-1===this.#C)return this.#S.length>0&&(this.#S.length=0),this.#C=0,void this.#S.push(o);if(r&&this.#S[this.#C].type===s)return a&&(o.undo=this.#S[this.#C].undo),void(this.#S[this.#C]=o);const l=this.#C+1;l===this.#E?this.#S.splice(0,1):(this.#C=l,l<this.#S.length&&this.#S.splice(l)),this.#S.push(o)}undo(){if(-1===this.#C)return;this.#_=!0;const{undo:t,post:e}=this.#S[this.#C];t(),e?.(),this.#_=!1,this.#C-=1}redo(){if(this.#C<this.#S.length-1){this.#C+=1,this.#_=!0;const{cmd:t,post:e}=this.#S[this.#C];t(),e?.(),this.#_=!1}}hasSomethingToUndo(){return-1!==this.#C}hasSomethingToRedo(){return this.#C<this.#S.length-1}destroy(){this.#S=null}}class Qs{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ys.platform;for(const[n,i,s={}]of t)for(const t of n){const n=t.startsWith("mac+");e&&n?(this.callbacks.set(t.slice(4),{callback:i,options:s}),this.allKeys.add(t.split("+").at(-1))):e||n||(this.callbacks.set(t,{callback:i,options:s}),this.allKeys.add(t.split("+").at(-1)))}}#T(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#T(e));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:r=[],checker:a=null}}=n;a&&!a(t,e)||(i.bind(t,...r,e)(),s||(e.stopPropagation(),e.preventDefault()))}}class Zs{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return function(t){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const n of t.keys()){e.style.color=n;const i=window.getComputedStyle(e).color;t.set(n,Vs(i))}e.remove()}(t),os(this,"_colors",t)}convert(t){const e=Vs(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[t,n]of this._colors)if(n.every(((t,n)=>t===e[n])))return Zs._colorsMapping.get(t);return e}getHexCode(t){const e=this._colors.get(t);return e?As.makeHexColor(...e):t}}class tr{#k=new AbortController;#M=null;#P=new Map;#I=new Map;#R=null;#L=null;#D=null;#F=new Js;#O=null;#N=0;#B=new Set;#H=null;#z=null;#V=new Set;#j=!1;#$=!1;#U=!1;#W=null;#G=null;#q=null;#X=null;#K=!1;#Y=null;#J=new Ks;#Q=!1;#Z=!1;#tt=null;#et=null;#nt=null;#it=null;#st=Gi.NONE;#rt=new Set;#at=null;#ot=null;#lt=null;#ct={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#dt=[0,0];#ht=null;#ut=null;#pt=null;#ft=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=tr.prototype,e=t=>t.#ut.contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),n=(t,{target:e})=>{if(e instanceof HTMLInputElement){const{type:t}=e;return"text"!==t&&"number"!==t}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return os(this,"_keyboardManager",new Qs([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#ut.contains(e)&&!t.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#ut.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,n,i,s,r,a,o,l,c,d){const h=this._signal=this.#k.signal;this.#ut=t,this.#pt=e,this.#R=n,this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:h}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:h}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:h}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:h}),i._on("setpreference",this.onSetPreference.bind(this),{signal:h}),i._on("switchannotationeditorparams",(t=>this.updateParams(t.type,t.value)),{signal:h}),this.#gt(),this.#mt(),this.#bt(),this.#L=s.annotationStorage,this.#W=s.filterFactory,this.#ot=r,this.#X=a||null,this.#j=o,this.#$=l,this.#U=c,this.#it=d||null,this.viewParameters={realScale:Ts.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#ft?.resolve(),this.#ft=null,this.#k?.abort(),this.#k=null,this._signal=null;for(const t of this.#I.values())t.destroy();this.#I.clear(),this.#P.clear(),this.#V.clear(),this.#M=null,this.#rt.clear(),this.#F.destroy(),this.#R?.destroy(),this.#Y?.hide(),this.#Y=null,this.#G&&(clearTimeout(this.#G),this.#G=null),this.#ht&&(clearTimeout(this.#ht),this.#ht=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#it}get useNewAltTextFlow(){return this.#$}get useNewAltTextWhenAddingImage(){return this.#U}get hcmFilter(){return os(this,"hcmFilter",this.#ot?this.#W.addHCMFilter(this.#ot.foreground,this.#ot.background):"none")}get direction(){return os(this,"direction",getComputedStyle(this.#ut).direction)}get highlightColors(){return os(this,"highlightColors",this.#X?new Map(this.#X.split(",").map((t=>t.split("=").map((t=>t.trim()))))):null)}get highlightColorNames(){return os(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(t=>t.reverse()))):null)}setMainHighlightColorPicker(t){this.#nt=t}editAltText(t,e=!1){this.#R?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){"enableNewAltTextWhenAddingImage"===t&&(this.#U=e)}onPageChanging({pageNumber:t}){this.#N=t-1}focusMainContainer(){this.#ut.focus()}findParent(t,e){for(const n of this.#I.values()){const{x:i,y:s,width:r,height:a}=n.div.getBoundingClientRect();if(t>=i&&t<=i+r&&e>=s&&e<=s+a)return n}return null}disableUserSelect(t=!1){this.#pt.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#V.add(t)}removeShouldRescale(t){this.#V.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Ts.PDF_TO_CSS_UNITS;for(const t of this.#V)t.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#vt({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#yt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const e of this.#I.values())if(e.hasTextLayer(t))return e;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:r}=e,a=e.toString(),o=this.#vt(e).closest(".textLayer"),l=this.getSelectionBoxes(o);if(!l)return;e.empty();const c=this.#yt(o),d=this.#st===Gi.NONE,h=()=>{c?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:l,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:r,text:a}),d&&this.showAllEditors("highlight",!0,!0)};d?this.switchToMode(Gi.HIGHLIGHT,h):h()}#wt(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=this.#vt(t).closest(".textLayer"),n=this.getSelectionBoxes(e);n&&(this.#Y||=new qs(this),this.#Y.show(e,n,"ltr"===this.direction))}addToAnnotationStorage(t){t.isEmpty()||!this.#L||this.#L.has(t.id)||this.#L.setValue(t.id,t)}#At(){const t=document.getSelection();if(!t||t.isCollapsed)return void(this.#at&&(this.#Y?.hide(),this.#at=null,this.#xt({hasSelectedText:!1})));const{anchorNode:e}=t;if(e===this.#at)return;const n=this.#vt(t).closest(".textLayer");if(n){if(this.#Y?.hide(),this.#at=e,this.#xt({hasSelectedText:!0}),(this.#st===Gi.HIGHLIGHT||this.#st===Gi.NONE)&&(this.#st===Gi.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#K=this.isShiftKeyDown,!this.isShiftKeyDown)){const t=this.#st===Gi.HIGHLIGHT?this.#yt(n):null;t?.toggleDrawing();const e=new AbortController,i=this.combinedSignal(e),s=n=>{"pointerup"===n.type&&0!==n.button||(e.abort(),t?.toggleDrawing(!0),"pointerup"===n.type&&this.#St("main_toolbar"))};window.addEventListener("pointerup",s,{signal:i}),window.addEventListener("blur",s,{signal:i})}}else this.#at&&(this.#Y?.hide(),this.#at=null,this.#xt({hasSelectedText:!1}))}#St(t=""){this.#st===Gi.HIGHLIGHT?this.highlightSelection(t):this.#j&&this.#wt()}#gt(){document.addEventListener("selectionchange",this.#At.bind(this),{signal:this._signal})}#_t(){if(this.#q)return;this.#q=new AbortController;const t=this.combinedSignal(this.#q);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#Et(){this.#q?.abort(),this.#q=null}blur(){if(this.isShiftKeyDown=!1,this.#K&&(this.#K=!1,this.#St("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#rt)if(e.div.contains(t)){this.#et=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#et)return;const[t,e]=this.#et;this.#et=null,e.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),e.focus()}#bt(){if(this.#tt)return;this.#tt=new AbortController;const t=this.combinedSignal(this.#tt);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#Ct(){this.#tt?.abort(),this.#tt=null}#Tt(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#kt(){this.#O?.abort(),this.#O=null}#mt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#bt(),this.#Tt()}removeEditListeners(){this.#Ct(),this.#kt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#z)if(n.isHandlingMimeForPasting(e))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#z)if(n.isHandlingMimeForPasting(e.type))return n.paste(e,this.currentLayer),void t.preventDefault()}copy(t){if(t.preventDefault(),this.#M?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const t of this.#rt){const n=t.serialize(!0);n&&e.push(n)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const t of e.items)for(const e of this.#z)if(e.isHandlingMimeForPasting(t.type))return void e.paste(t,this.currentLayer);let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(t){return void is(`paste: "${t.message}".`)}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const t=[];for(const e of n){const n=await i.deserialize(e);if(!n)return;t.push(n)}const e=()=>{for(const e of t)this.#Mt(e);this.#Pt(t)},s=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:s,mustExec:!0})}catch(t){is(`paste: "${t.message}".`)}}keydown(t){this.isShiftKeyDown||"Shift"!==t.key||(this.isShiftKeyDown=!0),this.#st===Gi.NONE||this.isEditorHandlingKeyboard||tr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,this.#K&&(this.#K=!1,this.#St("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}#xt(t){Object.entries(t).some((([t,e])=>this.#ct[t]!==e))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#ct,t)}),this.#st===Gi.HIGHLIGHT&&!1===t.hasSelectedEditor&&this.#It([[qi.HIGHLIGHT_FREE,!0]]))}#It(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#_t(),this.#Tt(),this.#xt({isEditing:this.#st!==Gi.NONE,isEmpty:this.#Rt(),hasSomethingToUndo:this.#F.hasSomethingToUndo(),hasSomethingToRedo:this.#F.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#Et(),this.#kt(),this.#xt({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#z){this.#z=t;for(const t of this.#z)this.#It(t.defaultPropertiesToUpdate)}}getId(){return this.#J.id}get currentLayer(){return this.#I.get(this.#N)}getLayer(t){return this.#I.get(t)}get currentPageIndex(){return this.#N}addLayer(t){this.#I.set(t.pageIndex,t),this.#Q?t.enable():t.disable()}removeLayer(t){this.#I.delete(t.pageIndex)}async updateMode(t,e=null,n=!1){if(this.#st!==t&&(!this.#ft||(await this.#ft.promise,this.#ft))){if(this.#ft=Promise.withResolvers(),this.#st=t,t===Gi.NONE)return this.setEditingState(!1),this.#Lt(),void this.#ft.resolve();this.setEditingState(!0),await this.#Dt(),this.unselectAll();for(const e of this.#I.values())e.updateMode(t);if(!e)return n&&this.addNewEditorFromKeyboard(),void this.#ft.resolve();for(const t of this.#P.values())t.annotationElementId===e?(this.setSelected(t),t.enterInEditMode()):t.unselect();this.#ft.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#st&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#z){switch(t){case qi.CREATE:return void this.currentLayer.addNewEditor();case qi.HIGHLIGHT_DEFAULT_COLOR:this.#nt?.updateColor(e);break;case qi.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#lt||=new Map).set(t,e),this.showAllEditors("highlight",e)}for(const n of this.#rt)n.updateParams(t,e);for(const n of this.#z)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const n of this.#P.values())n.editorType===t&&n.show(e);(this.#lt?.get(qi.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#It([[qi.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#Z!==t){this.#Z=t;for(const e of this.#I.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#Dt(){if(!this.#Q){this.#Q=!0;const t=[];for(const e of this.#I.values())t.push(e.enable());await Promise.all(t);for(const t of this.#P.values())t.enable()}}#Lt(){if(this.unselectAll(),this.#Q){this.#Q=!1;for(const t of this.#I.values())t.disable();for(const t of this.#P.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#P.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#P.get(t)}addEditor(t){this.#P.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#G&&clearTimeout(this.#G),this.#G=setTimeout((()=>{this.focusMainContainer(),this.#G=null}),0)),this.#P.delete(t.id),this.unselect(t),t.annotationElementId&&this.#B.has(t.annotationElementId)||this.#L?.remove(t.id)}addDeletedAnnotationElement(t){this.#B.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#B.has(t)}removeDeletedAnnotationElement(t){this.#B.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Mt(t){const e=this.#I.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#M!==t&&(this.#M=t,t&&this.#It(t.propertiesToUpdate))}get#Ft(){let t=null;for(t of this.#rt);return t}updateUI(t){this.#Ft===t&&this.#It(t.propertiesToUpdate)}toggleSelected(t){if(this.#rt.has(t))return this.#rt.delete(t),t.unselect(),void this.#xt({hasSelectedEditor:this.hasSelection});this.#rt.add(t),t.select(),this.#It(t.propertiesToUpdate),this.#xt({hasSelectedEditor:!0})}setSelected(t){for(const e of this.#rt)e!==t&&e.unselect();this.#rt.clear(),this.#rt.add(t),t.select(),this.#It(t.propertiesToUpdate),this.#xt({hasSelectedEditor:!0})}isSelected(t){return this.#rt.has(t)}get firstSelectedEditor(){return this.#rt.values().next().value}unselect(t){t.unselect(),this.#rt.delete(t),this.#xt({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#rt.size}get isEnterHandled(){return 1===this.#rt.size&&this.firstSelectedEditor.isEnterHandled}undo(){this.#F.undo(),this.#xt({hasSomethingToUndo:this.#F.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Rt()})}redo(){this.#F.redo(),this.#xt({hasSomethingToUndo:!0,hasSomethingToRedo:this.#F.hasSomethingToRedo(),isEmpty:this.#Rt()})}addCommands(t){this.#F.add(t),this.#xt({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Rt()})}#Rt(){if(0===this.#P.size)return!0;if(1===this.#P.size)for(const t of this.#P.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...this.#rt];this.addCommands({cmd:()=>{for(const e of t)e.remove()},undo:()=>{for(const e of t)this.#Mt(e)},mustExec:!0})}commitOrRemove(){this.#M?.commitOrRemove()}hasSomethingToControl(){return this.#M||this.hasSelection}#Pt(t){for(const t of this.#rt)t.unselect();this.#rt.clear();for(const e of t)e.isEmpty()||(this.#rt.add(e),e.select());this.#xt({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#rt)t.commit();this.#Pt(this.#P.values())}unselectAll(){if((!this.#M||(this.#M.commitOrRemove(),this.#st===Gi.NONE))&&this.hasSelection){for(const t of this.#rt)t.unselect();this.#rt.clear(),this.#xt({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#dt[0]+=t,this.#dt[1]+=e;const[i,s]=this.#dt,r=[...this.#rt];this.#ht&&clearTimeout(this.#ht),this.#ht=setTimeout((()=>{this.#ht=null,this.#dt[0]=this.#dt[1]=0,this.addCommands({cmd:()=>{for(const t of r)this.#P.has(t.id)&&t.translateInPage(i,s)},undo:()=>{for(const t of r)this.#P.has(t.id)&&t.translateInPage(-i,-s)},mustExec:!1})}),1e3);for(const n of r)n.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#H=new Map;for(const t of this.#rt)this.#H.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#H)return!1;this.disableUserSelect(!1);const t=this.#H;this.#H=null;let e=!1;for(const[{x:n,y:i,pageIndex:s},r]of t)r.newX=n,r.newY=i,r.newPageIndex=s,e||=n!==r.savedX||i!==r.savedY||s!==r.savedPageIndex;if(!e)return!1;const n=(t,e,n,i)=>{if(this.#P.has(t.id)){const s=this.#I.get(i);s?t._setParentAndPosition(s,e,n):(t.pageIndex=i,t.x=e,t.y=n)}};return this.addCommands({cmd:()=>{for(const[e,{newX:i,newY:s,newPageIndex:r}]of t)n(e,i,s,r)},undo:()=>{for(const[e,{savedX:i,savedY:s,savedPageIndex:r}]of t)n(e,i,s,r)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#H)for(const n of this.#H.keys())n.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===this.#rt.size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#M===t}getActive(){return this.#M}getMode(){return this.#st}get imageManager(){return os(this,"imageManager",new Ys)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let n=0,i=e.rangeCount;n<i;n++)if(!t.contains(e.getRangeAt(n).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:r}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(t,e,a,o)=>({x:(e-i)/r,y:1-(t+a-n)/s,width:o/r,height:a/s});break;case"180":a=(t,e,a,o)=>({x:1-(t+a-n)/s,y:1-(e+o-i)/r,width:a/s,height:o/r});break;case"270":a=(t,e,a,o)=>({x:1-(e+o-i)/r,y:(t-n)/s,width:o/r,height:a/s});break;default:a=(t,e,a,o)=>({x:(t-n)/s,y:(e-i)/r,width:a/s,height:o/r})}const o=[];for(let t=0,n=e.rangeCount;t<n;t++){const n=e.getRangeAt(t);if(!n.collapsed)for(const{x:t,y:e,width:i,height:s}of n.getClientRects())0!==i&&0!==s&&o.push(a(t,e,i,s))}return 0===o.length?null:o}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#D||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#D?.delete(t)}renderAnnotationElement(t){const e=this.#D?.get(t.data.id);if(!e)return;const n=this.#L.getRawValue(e);n&&(this.#st!==Gi.NONE||n.hasBeenModified)&&n.renderAnnotationElement(t)}}class er{#o=null;#Ot=!1;#Nt=null;#Bt=null;#Ht=null;#zt=null;#Vt=!1;#jt=null;#r=null;#$t=null;#Ut=null;#Wt=!1;static#Gt=null;static _l10n=null;constructor(t){this.#r=t,this.#Wt=t._uiManager.useNewAltTextFlow,er.#Gt||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){er._l10n??=t}async render(){const t=this.#Nt=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#Bt=document.createElement("span");t.append(e),this.#Wt?(t.classList.add("new"),t.setAttribute("data-l10n-id",er.#Gt.missing),e.setAttribute("data-l10n-id",er.#Gt["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#r._uiManager._signal;t.addEventListener("contextmenu",Ns,{signal:n}),t.addEventListener("pointerdown",(t=>t.stopPropagation()),{signal:n});const i=t=>{t.preventDefault(),this.#r._uiManager.editAltText(this.#r),this.#Wt&&this.#r._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#qt}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",(e=>{e.target===t&&"Enter"===e.key&&(this.#Vt=!0,i(e))}),{signal:n}),await this.#Xt(),t}get#qt(){return(this.#o?"added":null===this.#o&&this.guessedText&&"review")||"missing"}finish(){this.#Nt&&(this.#Nt.focus({focusVisible:this.#Vt}),this.#Vt=!1)}isEmpty(){return this.#Wt?null===this.#o:!this.#o&&!this.#Ot}hasData(){return this.#Wt?null!==this.#o||!!this.#$t:this.isEmpty()}get guessedText(){return this.#$t}async setGuessedText(t){null===this.#o&&(this.#$t=t,this.#Ut=await er._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#Xt())}toggleAltTextBadge(t=!1){if(!this.#Wt||this.#o)return this.#jt?.remove(),void(this.#jt=null);if(!this.#jt){const t=this.#jt=document.createElement("div");t.className="noAltTextBadge",this.#r.div.append(t)}this.#jt.classList.toggle("hidden",!t)}serialize(t){let e=this.#o;return t||this.#$t!==e||(e=this.#Ut),{altText:e,decorative:this.#Ot,guessedText:this.#$t,textWithDisclaimer:this.#Ut}}get data(){return{altText:this.#o,decorative:this.#Ot}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(this.#$t=n,this.#Ut=i),this.#o===t&&this.#Ot===e||(s||(this.#o=t,this.#Ot=e),this.#Xt())}toggle(t=!1){this.#Nt&&(!t&&this.#zt&&(clearTimeout(this.#zt),this.#zt=null),this.#Nt.disabled=!t)}shown(){this.#r._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#qt}})}destroy(){this.#Nt?.remove(),this.#Nt=null,this.#Bt=null,this.#Ht=null,this.#jt?.remove(),this.#jt=null}async#Xt(){const t=this.#Nt;if(!t)return;if(this.#Wt){if(t.classList.toggle("done",!!this.#o),t.setAttribute("data-l10n-id",er.#Gt[this.#qt]),this.#Bt?.setAttribute("data-l10n-id",er.#Gt[`${this.#qt}-label`]),!this.#o)return void this.#Ht?.remove()}else{if(!this.#o&&!this.#Ot)return t.classList.remove("done"),void this.#Ht?.remove();t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#Ht;if(!e){this.#Ht=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#r.id}`;const n=100,i=this.#r._uiManager._signal;i.addEventListener("abort",(()=>{clearTimeout(this.#zt),this.#zt=null}),{once:!0}),t.addEventListener("mouseenter",(()=>{this.#zt=setTimeout((()=>{this.#zt=null,this.#Ht.classList.add("show"),this.#r._reportTelemetry({action:"alt_text_tooltip"})}),n)}),{signal:i}),t.addEventListener("mouseleave",(()=>{this.#zt&&(clearTimeout(this.#zt),this.#zt=null),this.#Ht?.classList.remove("show")}),{signal:i})}this.#Ot?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#o),e.parentNode||t.append(e);const n=this.#r.getImageForAltText();n?.setAttribute("aria-describedby",e.id)}}class nr{#Kt=null;#Yt=null;#o=null;#Jt=!1;#Qt=!1;#Zt=null;#te=null;#ee=null;#ne="";#ie=!1;#se=null;#re=!1;#ae=!1;#oe=!1;#le=null;#ce=0;#de=0;#he=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#ue=!1;#pe=nr._zIndex++;static _borderLineWidth=-1;static _colorManager=new Zs;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=nr.prototype._resizeWithKeyboard,e=tr.TRANSLATE_SMALL,n=tr.TRANSLATE_BIG;return os(this,"_resizerKeyboardManager",new Qs([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],nr.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:r}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,r];const[a,o]=this.parentDimensions;this.x=t.x/a,this.y=t.y/o,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return os(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new ir({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(nr._l10n??=t,nr._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),-1!==nr._borderLineWidth)return;const n=getComputedStyle(document.documentElement);nr._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){ss("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#ue}set _isDraggable(t){this.#ue=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#pe}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#fe(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#ie?this.#ie=!1:this.parent.setSelected(this))}focusout(t){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const e=t.relatedTarget;e?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[s,r]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/s,this.y=(e+i)/r,this.fixAndSetPosition()}#ge([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this.fixAndSetPosition()}translate(t,e){this.#ge(this.parentDimensions,t,e)}translateInPage(t,e){this.#se||=[this.x,this.y],this.#ge(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#se||=[this.x,this.y];const[n,i]=this.parentDimensions;if(this.x+=t/n,this.y+=e/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:r}=this;const[a,o]=this.getBaseTranslation();s+=a,r+=o,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#se&&(this.#se[0]!==this.x||this.#se[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=nr,i=n/t,s=n/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,n]=this.pageDimensions;let{x:i,y:s,width:r,height:a}=this;if(r*=e,a*=n,i*=e,s*=n,this._mustFixPosition)switch(t){case 0:i=Math.max(0,Math.min(e-r,i)),s=Math.max(0,Math.min(n-a,s));break;case 90:i=Math.max(0,Math.min(e-a,i)),s=Math.min(n,Math.max(r,s));break;case 180:i=Math.min(e,Math.max(r,i)),s=Math.min(n,Math.max(a,s));break;case 270:i=Math.min(e,Math.max(a,i)),s=Math.max(0,Math.min(n-r,s))}this.x=i/=e,this.y=s/=n;const[o,l]=this.getBaseTranslation();i+=o,s+=l;const{style:c}=this.div;c.left=`${(100*i).toFixed(2)}%`,c.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#me(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return nr.#me(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return nr.#me(t,e,360-this.parentRotation)}#be(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions;this.div.style.width=`${(100*t/n).toFixed(2)}%`,this.#Qt||(this.div.style.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),s=!this.#Qt&&e.endsWith("%");if(i&&s)return;const[r,a]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/r).toFixed(2)}%`),this.#Qt||s||(t.height=`${(100*parseFloat(e)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#ve(){if(this.#Zt)return;this.#Zt=document.createElement("div"),this.#Zt.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const t=document.createElement("div");this.#Zt.append(t),t.classList.add("resizer",n),t.setAttribute("data-resizer-name",n),t.addEventListener("pointerdown",this.#ye.bind(this,n),{signal:e}),t.addEventListener("contextmenu",Ns,{signal:e}),t.tabIndex=-1}this.div.prepend(this.#Zt)}#ye(t,e){e.preventDefault();const{isMac:n}=ys.platform;if(0!==e.button||e.ctrlKey&&n)return;this.#o?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#we.bind(this,t),{passive:!0,capture:!0,signal:r}),window.addEventListener("contextmenu",Ns,{signal:r});const a=this.x,o=this.y,l=this.width,c=this.height,d=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#o?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=d,this.div.style.cursor=h,this.#Ae(a,o,l,c)};window.addEventListener("pointerup",u,{signal:r}),window.addEventListener("blur",u,{signal:r})}#Ae(t,e,n,i){const s=this.x,r=this.y,a=this.width,o=this.height;s===t&&r===e&&a===n&&o===i||this.addCommands({cmd:()=>{this.width=a,this.height=o,this.x=s,this.y=r;const[t,e]=this.parentDimensions;this.setDims(t*a,e*o),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=i,this.x=t,this.y=e;const[s,r]=this.parentDimensions;this.setDims(s*n,r*i),this.fixAndSetPosition()},mustExec:!0})}#we(t,e){const[n,i]=this.parentDimensions,s=this.x,r=this.y,a=this.width,o=this.height,l=nr.MIN_SIZE/n,c=nr.MIN_SIZE/i,d=t=>Math.round(1e4*t)/1e4,h=this.#be(this.rotation),u=(t,e)=>[h[0]*t+h[2]*e,h[1]*t+h[3]*e],p=this.#be(360-this.rotation);let f,g,m=!1,b=!1;switch(t){case"topLeft":m=!0,f=(t,e)=>[0,0],g=(t,e)=>[t,e];break;case"topMiddle":f=(t,e)=>[t/2,0],g=(t,e)=>[t/2,e];break;case"topRight":m=!0,f=(t,e)=>[t,0],g=(t,e)=>[0,e];break;case"middleRight":b=!0,f=(t,e)=>[t,e/2],g=(t,e)=>[0,e/2];break;case"bottomRight":m=!0,f=(t,e)=>[t,e],g=(t,e)=>[0,0];break;case"bottomMiddle":f=(t,e)=>[t/2,e],g=(t,e)=>[t/2,0];break;case"bottomLeft":m=!0,f=(t,e)=>[0,e],g=(t,e)=>[t,0];break;case"middleLeft":b=!0,f=(t,e)=>[0,e/2],g=(t,e)=>[t,e/2]}const v=f(a,o),y=g(a,o);let w=u(...y);const A=d(s+w[0]),x=d(r+w[1]);let S=1,_=1,[E,C]=this.screenToPageTranslation(e.movementX,e.movementY);var T,k;if([E,C]=(T=E/n,k=C/i,[p[0]*T+p[2]*k,p[1]*T+p[3]*k]),m){const t=Math.hypot(a,o);S=_=Math.max(Math.min(Math.hypot(y[0]-v[0]-E,y[1]-v[1]-C)/t,1/a,1/o),l/a,c/o)}else b?S=Math.max(l,Math.min(1,Math.abs(y[0]-v[0]-E)))/a:_=Math.max(c,Math.min(1,Math.abs(y[1]-v[1]-C)))/o;const M=d(a*S),P=d(o*_);w=u(...g(M,P));const I=A-w[0],R=x-w[1];this.width=M,this.height=P,this.x=I,this.y=R,this.setDims(n*M,i*P),this.fixAndSetPosition()}altTextFinish(){this.#o?.finish()}async addEditToolbar(){return this._editToolbar||this.#ae||(this._editToolbar=new Gs(this),this.div.append(this._editToolbar.render()),this.#o&&await this._editToolbar.addAltText(this.#o)),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#o?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#o||(er.initialize(nr._l10n),this.#o=new er(this),this.#Kt&&(this.#o.data=this.#Kt,this.#Kt=null),await this.addEditToolbar())}get altTextData(){return this.#o?.data}set altTextData(t){this.#o&&(this.#o.data=t)}get guessedAltText(){return this.#o?.guessedText}async setGuessedAltText(t){await(this.#o?.setGuessedText(t))}serializeAltText(t){return this.#o?.serialize(t)}hasAltText(){return!!this.#o&&!this.#o.isEmpty()}hasAltTextData(){return this.#o?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#Jt?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#xe();const[t,e]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),Xs(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=ys.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(this.#ie=!0,this._isDraggable?this.#Se(t):this.#_e(t))}get isSelected(){return this._uiManager.isSelected(this)}#_e(t){const{isMac:e}=ys.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#Se(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();const n=new AbortController,i=this._uiManager.combinedSignal(n);if(e){this.div.classList.add("moving"),this.#ce=t.clientX,this.#de=t.clientY;const e=t=>{const{clientX:e,clientY:n}=t,[i,s]=this.screenToPageTranslation(e-this.#ce,n-this.#de);this.#ce=e,this.#de=n,this._uiManager.dragSelectedEditors(i,s)};window.addEventListener("pointermove",e,{passive:!0,capture:!0,signal:i})}const s=()=>{n.abort(),e&&this.div.classList.remove("moving"),this.#ie=!1,this._uiManager.endDragSession()||this.#_e(t)};window.addEventListener("pointerup",s,{signal:i}),window.addEventListener("blur",s,{signal:i})}moveInDOM(){this.#le&&clearTimeout(this.#le),this.#le=setTimeout((()=>{this.#le=null,this.parent?.moveEditorInDOM(this)}),0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition()}getRect(t,e,n=this.rotation){const i=this.parentScale,[s,r]=this.pageDimensions,[a,o]=this.pageTranslation,l=t/i,c=e/i,d=this.x*s,h=this.y*r,u=this.width*s,p=this.height*r;switch(n){case 0:return[d+l+a,r-h-c-p+o,d+l+u+a,r-h-c+o];case 90:return[d+c+a,r-h+l+o,d+c+p+a,r-h+l+u+o];case 180:return[d-l-u+a,r-h+c+o,d-l+a,r-h+c+p+o];case 270:return[d-c-p+a,r-h-l-u+o,d-c+a,r-h-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,s,r]=t,a=s-n,o=r-i;switch(this.rotation){case 0:return[n,e-r,a,o];case 90:return[n,e-i,o,a];case 180:return[s,e-i,a,o];case 270:return[s,e-r,o,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#ae=!0}disableEditMode(){this.#ae=!1}isInEditMode(){return this.#ae}shouldGetKeyboardEvents(){return this.#oe}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#xe(){if(this.#ee||!this.div)return;this.#ee=new AbortController;const t=this._uiManager.combinedSignal(this.#ee);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#xe()}rotate(t){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){ss("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,i.#Kt=t.accessibilityData;const[s,r]=i.pageDimensions,[a,o,l,c]=i.getRectInCurrentCoords(t.rect,r);return i.x=a/s,i.y=o/r,i.width=l/s,i.height=c/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(this.#ee?.abort(),this.#ee=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#le&&(clearTimeout(this.#le),this.#le=null),this.#fe(),this.removeEditToolbar(),this.#he){for(const t of this.#he.values())clearTimeout(t);this.#he=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#ve(),this.#Zt.classList.remove("hidden"),Xs(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),this.#te={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#Zt.children;if(!this.#Yt){this.#Yt=Array.from(e);const t=this.#Ee.bind(this),n=this.#Ce.bind(this),i=this._uiManager._signal;for(const e of this.#Yt){const s=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",t,{signal:i}),e.addEventListener("blur",n,{signal:i}),e.addEventListener("focus",this.#Te.bind(this,s),{signal:i}),e.setAttribute("data-l10n-id",nr._l10nResizer[s])}}const n=this.#Yt[0];let i=0;for(const t of e){if(t===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#Yt.length/4);if(s!==i){if(s<i)for(let t=0;t<i-s;t++)this.#Zt.append(this.#Zt.firstChild);else if(s>i)for(let t=0;t<s-i;t++)this.#Zt.firstChild.before(this.#Zt.lastChild);let t=0;for(const n of e){const e=this.#Yt[t++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",nr._l10nResizer[e])}}this.#ke(0),this.#oe=!0,this.#Zt.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Ee(t){nr._resizerKeyboardManager.exec(this,t)}#Ce(t){this.#oe&&t.relatedTarget?.parentNode!==this.#Zt&&this.#fe()}#Te(t){this.#ne=this.#oe?t:""}#ke(t){if(this.#Yt)for(const e of this.#Yt)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#oe&&this.#we(this.#ne,{movementX:t,movementY:e})}#fe(){if(this.#oe=!1,this.#ke(-1),this.#te){const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=this.#te;this.#Ae(t,e,n,i),this.#te=null}}_stopResizingWithKeyboard(){this.#fe(),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),this.#o?.toggleAltTextBadge(!1)):this.addEditToolbar().then((()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()}))}unselect(){this.#Zt?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#o?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#re}set isEditing(t){this.#re=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#Qt=!0;const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#he||=new Map;const{action:e}=t;let n=this.#he.get(e);return n&&clearTimeout(n),n=setTimeout((()=>{this._reportTelemetry(t),this.#he.delete(e),0===this.#he.size&&(this.#he=null)}),nr._telemetryTimeout),void this.#he.set(e,n)}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#Jt=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#Jt=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const t=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===e?.nodeName&&e.classList.contains("annotationContent")&&e.remove()}}class ir extends nr{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const sr=3285377520,rr=4294901760,ar=65535;class or{constructor(t){this.h1=t?4294967295&t:sr,this.h2=t?4294967295&t:sr}update(t){let e,n;if("string"==typeof t){e=new Uint8Array(2*t.length),n=0;for(let i=0,s=t.length;i<s;i++){const s=t.charCodeAt(i);s<=255?e[n++]=s:(e[n++]=s>>>8,e[n++]=255&s)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),n=e.byteLength}const i=n>>2,s=n-4*i,r=new Uint32Array(e.buffer,0,i);let a=0,o=0,l=this.h1,c=this.h2;const d=3432918353,h=461845907,u=11601,p=13715;for(let t=0;t<i;t++)1&t?(a=r[t],a=a*d&rr|a*u&ar,a=a<<15|a>>>17,a=a*h&rr|a*p&ar,l^=a,l=l<<13|l>>>19,l=5*l+3864292196):(o=r[t],o=o*d&rr|o*u&ar,o=o<<15|o>>>17,o=o*h&rr|o*p&ar,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(a=0,s){case 3:a^=e[4*i+2]<<16;case 2:a^=e[4*i+1]<<8;case 1:a^=e[4*i],a=a*d&rr|a*u&ar,a=a<<15|a>>>17,a=a*h&rr|a*p&ar,1&i?l^=a:c^=a}this.h1=l,this.h2=c}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&rr|36045*t&ar,e=4283543511*e&rr|(2950163797*(e<<16|t>>>16)&rr)>>>16,t^=e>>>1,t=444984403*t&rr|60499*t&ar,e=3301882366*e&rr|(3120437893*(e<<16|t>>>16)&rr)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const lr=Object.freeze({map:null,hash:"",transfer:void 0});class cr{#Me=!1;#Pe=null;#Ie=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#Ie.get(t);return void 0===n?e:Object.assign(e,n)}getRawValue(t){return this.#Ie.get(t)}remove(t){if(this.#Ie.delete(t),0===this.#Ie.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const t of this.#Ie.values())if(t instanceof nr)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#Ie.get(t);let i=!1;if(void 0!==n)for(const[t,s]of Object.entries(e))n[t]!==s&&(i=!0,n[t]=s);else i=!0,this.#Ie.set(t,e);i&&this.#Re(),e instanceof nr&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#Ie.has(t)}getAll(){return this.#Ie.size>0?vs(this.#Ie):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return this.#Ie.size}#Re(){this.#Me||(this.#Me=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#Me&&(this.#Me=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new dr(this)}get serializable(){if(0===this.#Ie.size)return lr;const t=new Map,e=new or,n=[],i=Object.create(null);let s=!1;for(const[n,r]of this.#Ie){const a=r instanceof nr?r.serialize(!1,i):r;a&&(t.set(n,a),e.update(`${n}:${JSON.stringify(a)}`),s||=!!a.bitmap)}if(s)for(const e of t.values())e.bitmap&&n.push(e.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:lr}get editorStats(){let t=null;const e=new Map;for(const n of this.#Ie.values()){if(!(n instanceof nr))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const r=t[s]||=new Map;for(const[t,e]of Object.entries(i)){if("type"===t)continue;let n=r.get(t);n||(n=new Map,r.set(t,n));const i=n.get(e)??0;n.set(e,i+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#Pe=null}get modifiedIds(){if(this.#Pe)return this.#Pe;const t=[];for(const e of this.#Ie.values())e instanceof nr&&e.annotationElementId&&e.serialize()&&t.push(e.annotationElementId);return this.#Pe={ids:new Set(t),hash:t.join(",")}}}class dr extends cr{#Le;constructor(t){super();const{map:e,hash:n,transfer:i}=t.serializable,s=structuredClone(e,i?{transfer:i}:null);this.#Le={map:s,hash:n,transfer:i}}get print(){ss("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#Le}get modifiedIds(){return os(this,"modifiedIds",{ids:new Set,hash:""})}}class hr{#De=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#De.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(t&&!this.#De.has(t.loadedName))if(rs(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:s}=t,r=new FontFace(n,i,s);this.addNativeFontFace(r);try{await r.load(),this.#De.add(n),e?.(t)}catch{is(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}}else ss("Not implemented: loadSystemFont without the Font Loading API.")}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void await this.loadSystemFont(t);if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(n){throw is(`Failed to load font '${e.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise((e=>{const n=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,n)}))}}get isFontLoadingAPISupported(){return os(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){let t=!1;return(Vi||"undefined"!=typeof navigator&&"string"==typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),os(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const{loadingRequests:e}=this,n={done:!1,complete:function(){for(rs(!n.done,"completeRequest() cannot be called twice."),n.done=!0;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(n),n}get _loadTestFont(){return os(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,e){function n(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function i(t,e,n,i){return t.substring(0,e)+i+t.substring(e+n)}let s,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const o=a.getContext("2d");let l=0;const c=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=i(d,976,c.length,c);const h=1482184792;let u=n(d,16);for(s=0,r=c.length-3;s<r;s+=4)u=u-h+n(c,s)|0;var p;s<c.length&&(u=u-h+n(c+"XXX",s)|0),d=i(d,16,4,(p=u,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f=`@font-face {font-family:"${c}";src:url(data:font/opentype;base64,${btoa(d)});}`;this.insertRule(f);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const e of[t.loadedName,c]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=e,g.append(t)}this._document.body.append(g),function t(e,n){if(++l>30)return is("Load test font never loaded."),void n();o.font="30px "+e,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?n():setTimeout(t.bind(null,e,n))}(c,(()=>{g.remove(),e.complete()}))}}class ur{constructor(t,{disableFontFace:e=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const e in t)this[e]=t[e];this.disableFontFace=!0===e,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${e=this.data,Uint8Array.prototype.toBase64?e.toBase64():btoa(ms(e))});`;var e;let n;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this._inspectFont?.(this,t),n}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];let n;try{n=t.get(this.loadedName+"_path_"+e)}catch(t){is(`getPathGenerator - ignoring character: "${t}".`)}if(!Array.isArray(n)||0===n.length)return this.compiledGlyphs[e]=function(t,e){};const i=[];for(let t=0,e=n.length;t<e;)switch(n[t++]){case 0:{const[e,s,r,a,o,l]=n.slice(t,t+6);i.push((t=>t.bezierCurveTo(e,s,r,a,o,l))),t+=6}break;case 1:{const[e,s]=n.slice(t,t+2);i.push((t=>t.moveTo(e,s))),t+=2}break;case 2:{const[e,s]=n.slice(t,t+2);i.push((t=>t.lineTo(e,s))),t+=2}break;case 3:{const[e,s,r,a]=n.slice(t,t+4);i.push((t=>t.quadraticCurveTo(e,s,r,a))),t+=4}break;case 4:i.push((t=>t.restore()));break;case 5:i.push((t=>t.save()));break;case 6:rs(2===i.length,"Scale command is only valid at the third position.");break;case 7:{const[e,s,r,a,o,l]=n.slice(t,t+6);i.push((t=>t.transform(e,s,r,a,o,l))),t+=6}break;case 8:{const[e,s]=n.slice(t,t+2);i.push((t=>t.translate(e,s))),t+=2}}return this.compiledGlyphs[e]=function(t,e){i[0](t),i[1](t),t.scale(e,-e);for(let e=2,n=i.length;e<n;e++)i[e](t)}}}class pr{#Fe=!1;constructor({enableHWA:t=!1}){this.#Fe=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#Fe})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){ss("Abstract method `_createCanvas` called.")}}class fr{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then((t=>({cMapData:t,isCompressed:this.isCompressed}))).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)}))}async _fetch(t){ss("Abstract method `_fetch` called.")}}class gr extends fr{async _fetch(t){const e=await ks(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):bs(e)}}class mr{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,s){return"none"}destroy(t=!1){}}class br{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch((t=>{throw new Error(`Unable to load font data at: ${e}`)}))}async _fetch(t){ss("Abstract method `_fetch` called.")}}class vr extends br{async _fetch(t){const e=await ks(t,"arraybuffer");return new Uint8Array(e)}}if(Vi){var yr=Promise.withResolvers(),wr=null;(async()=>{const t=await import("fs"),e=await import("http"),n=await import("https"),i=await import("url");return new Map(Object.entries({fs:t,http:e,https:n,url:i,canvas:void 0,path2d:void 0}))})().then((t=>{wr=t,yr.resolve()}),(t=>{is(`loadPackages: ${t}`),wr=new Map,yr.resolve()}))}class Ar{static get promise(){return yr.promise}static get(t){return wr?.get(t)}}async function xr(t){const e=Ar.get("fs"),n=await e.promises.readFile(t);return new Uint8Array(n)}const Sr="Fill",_r="Stroke",Er="Shading";function Cr(t,e){if(!e)return;const n=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],n,i),t.clip(s)}class Tr{getPattern(){ss("Abstract method `getPattern` called.")}}class kr extends Tr{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)e.addColorStop(t[0],t[1]);return e}getPattern(t,e,n,i){let s;if(i===_r||i===Sr){const r=e.current.getClippedPathBoundingBox(i,js(t))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,o=Math.ceil(r[3]-r[1])||1,l=e.cachedCanvases.getCanvas("pattern",a,o),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),n=As.transform(n,[1,0,0,1,r[0],r[1]]),c.transform(...e.baseTransform),this.matrix&&c.transform(...this.matrix),Cr(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=t.createPattern(l.canvas,"no-repeat");const d=new DOMMatrix(n);s.setTransform(d)}else Cr(t,this._bbox),s=this._createGradient(t);return s}}function Mr(t,e,n,i,s,r,a,o){const l=e.coords,c=e.colors,d=t.data,h=4*t.width;let u;l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=r,r=a,a=u),l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=a,a=o,o=u),l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=r,r=a,a=u);const p=(l[n]+e.offsetX)*e.scaleX,f=(l[n+1]+e.offsetY)*e.scaleY,g=(l[i]+e.offsetX)*e.scaleX,m=(l[i+1]+e.offsetY)*e.scaleY,b=(l[s]+e.offsetX)*e.scaleX,v=(l[s+1]+e.offsetY)*e.scaleY;if(f>=v)return;const y=c[r],w=c[r+1],A=c[r+2],x=c[a],S=c[a+1],_=c[a+2],E=c[o],C=c[o+1],T=c[o+2],k=Math.round(f),M=Math.round(v);let P,I,R,L,D,F,O,N;for(let t=k;t<=M;t++){if(t<m){const e=t<f?0:(f-t)/(f-m);P=p-(p-g)*e,I=y-(y-x)*e,R=w-(w-S)*e,L=A-(A-_)*e}else{let e;e=t>v?1:m===v?0:(m-t)/(m-v),P=g-(g-b)*e,I=x-(x-E)*e,R=S-(S-C)*e,L=_-(_-T)*e}let e;e=t<f?0:t>v?1:(f-t)/(f-v),D=p-(p-b)*e,F=y-(y-E)*e,O=w-(w-C)*e,N=A-(A-T)*e;const n=Math.round(Math.min(P,D)),i=Math.round(Math.max(P,D));let s=h*t+4*n;for(let t=n;t<=i;t++)e=(P-t)/(P-D),e<0?e=0:e>1&&(e=1),d[s++]=I-(I-F)*e|0,d[s++]=R-(R-O)*e|0,d[s++]=L-(L-N)*e|0,d[s++]=255}}function Pr(t,e,n){const i=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let e=r*o;for(let r=0;r<c;r++,e++)Mr(t,n,i[e],i[e+1],i[e+o],s[e],s[e+1],s[e+o]),Mr(t,n,i[e+o+1],i[e+1],i[e+o],s[e+o+1],s[e+1],s[e+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)Mr(t,n,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class Ir extends Tr{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const i=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,a=Math.ceil(this._bounds[3])-s,o=Math.min(Math.ceil(Math.abs(r*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(a*t[1]*1.1)),3e3),c=r/o,d=a/l,h={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-s,scaleX:1/c,scaleY:1/d},u=o+4,p=l+4,f=n.getCanvas("mesh",u,p),g=f.context,m=g.createImageData(o,l);if(e){const t=m.data;for(let n=0,i=t.length;n<i;n+=4)t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=255}for(const t of this._figures)Pr(m,t,h);return g.putImageData(m,2,2),{canvas:f.canvas,offsetX:i-2*c,offsetY:s-2*d,scaleX:c,scaleY:d}}getPattern(t,e,n,i){let s;if(Cr(t,this._bbox),i===Er)s=As.singularValueDecompose2dScale(js(t));else if(s=As.singularValueDecompose2dScale(e.baseTransform),this.matrix){const t=As.singularValueDecompose2dScale(this.matrix);s=[s[0]*t[0],s[1]*t[1]]}const r=this._createMeshCanvas(s,i===Er?null:this._background,e.cachedCanvases);return i!==Er&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(r.offsetX,r.offsetY),t.scale(r.scaleX,r.scaleY),t.createPattern(r.canvas,"no-repeat")}}class Rr extends Tr{getPattern(){return"hotpink"}}class Lr{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,i,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:s,color:r,canvasGraphicsFactory:a}=this;let{xstep:o,ystep:l}=this;o=Math.abs(o),l=Math.abs(l),ns("TilingType: "+s);const c=e[0],d=e[1],h=e[2],u=e[3],p=h-c,f=u-d,g=As.singularValueDecompose2dScale(this.matrix),m=As.singularValueDecompose2dScale(this.baseTransform),b=g[0]*m[0],v=g[1]*m[1];let y=p,w=f,A=!1,x=!1;const S=Math.ceil(o*b),_=Math.ceil(l*v);S>=Math.ceil(p*b)?y=o:A=!0,_>=Math.ceil(f*v)?w=l:x=!0;const E=this.getSizeAndScale(y,this.ctx.canvas.width,b),C=this.getSizeAndScale(w,this.ctx.canvas.height,v),T=t.cachedCanvases.getCanvas("pattern",E.size,C.size),k=T.context,M=a.createCanvasGraphics(k);if(M.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(M,i,r),k.translate(-E.scale*c,-C.scale*d),M.transform(E.scale,0,0,C.scale,0,0),k.save(),this.clipBbox(M,c,d,h,u),M.baseTransform=js(M.ctx),M.executeOperatorList(n),M.endDrawing(),k.restore(),A||x){const e=T.canvas;A&&(y=o),x&&(w=l);const n=this.getSizeAndScale(y,this.ctx.canvas.width,b),i=this.getSizeAndScale(w,this.ctx.canvas.height,v),s=n.size,r=i.size,a=t.cachedCanvases.getCanvas("pattern-workaround",s,r),h=a.context,u=A?Math.floor(p/o):0,g=x?Math.floor(f/l):0;for(let t=0;t<=u;t++)for(let n=0;n<=g;n++)h.drawImage(e,s*t,r*n,s,r,0,0,s,r);return{canvas:a.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:c,offsetY:d}}return{canvas:T.canvas,scaleX:E.scale,scaleY:C.scale,offsetX:c,offsetY:d}}getSizeAndScale(t,e,n){const i=Math.max(Lr.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*n);return s>=i?s=i:n=s/t,{scale:n,size:s}}clipBbox(t,e,n,i,s){const r=i-e,a=s-n;t.ctx.rect(e,n,r,a),t.current.updateRectMinMax(js(t.ctx),[e,n,i,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,s=t.current;switch(e){case 1:const t=this.ctx;i.fillStyle=t.fillStyle,i.strokeStyle=t.strokeStyle,s.fillColor=t.fillStyle,s.strokeColor=t.strokeStyle;break;case 2:const r=As.makeHexColor(n[0],n[1],n[2]);i.fillStyle=r,i.strokeStyle=r,s.fillColor=r,s.strokeColor=r;break;default:throw new fs(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let s=n;i!==Er&&(s=As.transform(s,e.baseTransform),this.matrix&&(s=As.transform(s,this.matrix)));const r=this.createPatternCanvas(e);let a=new DOMMatrix(s);a=a.translate(r.offsetX,r.offsetY),a=a.scale(1/r.scaleX,1/r.scaleY);const o=t.createPattern(r.canvas,"repeat");return o.setTransform(a),o}}function Dr({src:t,srcPos:e=0,dest:n,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ys.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],d=i>>3,h=7&i,u=t.length;n=new Uint32Array(n.buffer);let p=0;for(let i=0;i<s;i++){for(const i=e+d;e<i;e++){const i=e<u?t[e]:255;n[p++]=128&i?c:l,n[p++]=64&i?c:l,n[p++]=32&i?c:l,n[p++]=16&i?c:l,n[p++]=8&i?c:l,n[p++]=4&i?c:l,n[p++]=2&i?c:l,n[p++]=1&i?c:l}if(0===h)continue;const i=e<u?t[e++]:255;for(let t=0;t<h;t++)n[p++]=i&1<<7-t?c:l}return{srcPos:e,destPos:p}}const Fr=16;class Or{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return void 0!==this.cache[t]?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Nr(t,e,n,i,s,r,a,o,l,c){const[d,h,u,p,f,g]=js(t);if(0===h&&0===u){const m=a*d+f,b=Math.round(m),v=o*p+g,y=Math.round(v),w=(a+l)*d+f,A=Math.abs(Math.round(w)-b)||1,x=(o+c)*p+g,S=Math.abs(Math.round(x)-y)||1;return t.setTransform(Math.sign(d),0,0,Math.sign(p),b,y),t.drawImage(e,n,i,s,r,0,0,A,S),t.setTransform(d,h,u,p,f,g),[A,S]}if(0===d&&0===p){const m=o*u+f,b=Math.round(m),v=a*h+g,y=Math.round(v),w=(o+c)*u+f,A=Math.abs(Math.round(w)-b)||1,x=(a+l)*h+g,S=Math.abs(Math.round(x)-y)||1;return t.setTransform(0,Math.sign(h),Math.sign(u),0,b,y),t.drawImage(e,n,i,s,r,0,0,S,A),t.setTransform(d,h,u,p,f,g),[S,A]}return t.drawImage(e,n,i,s,r,a,o,l,c),[Math.hypot(d,h)*l,Math.hypot(u,p)*c]}class Br{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=ji,this.textMatrixScale=1,this.fontMatrix=$i,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=0,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=As.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=As.applyTransform(e,t),i=As.applyTransform(e.slice(2),t),s=As.applyTransform([e[0],e[3]],t),r=As.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],s[0],r[0]),this.minY=Math.min(this.minY,n[1],i[1],s[1],r[1]),this.maxX=Math.max(this.maxX,n[0],i[0],s[0],r[0]),this.maxY=Math.max(this.maxY,n[1],i[1],s[1],r[1])}updateScalingPathMinMax(t,e){As.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,s,r,a,o,l,c){const d=As.bezierBoundingBox(e,n,i,s,r,a,o,l,c);c||this.updateRectMinMax(t,d)}getPathBoundingBox(t=Sr,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===_r){e||ss("Stroke bounding box must include transform.");const t=As.singularValueDecompose2dScale(e),i=t[0]*this.lineWidth/2,s=t[1]*this.lineWidth/2;n[0]-=i,n[1]-=s,n[2]+=i,n[3]+=s}return n}updateClipFromPath(){const t=As.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Sr,e=null){return As.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Hr(t,e){if("undefined"!=typeof ImageData&&e instanceof ImageData)return void t.putImageData(e,0,0);const n=e.height,i=e.width,s=n%Fr,r=(n-s)/Fr,a=0===s?r:r+1,o=t.createImageData(i,Fr);let l,c=0;const d=e.data,h=o.data;let u,p,f,g;if(e.kind===Ki.GRAYSCALE_1BPP){const e=d.byteLength,n=new Uint32Array(h.buffer,0,h.byteLength>>2),g=n.length,m=i+7>>3,b=4294967295,v=ys.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(f=u<r?Fr:s,l=0,p=0;p<f;p++){const t=e-c;let s=0;const r=t>m?i:8*t-7,a=-8&r;let o=0,h=0;for(;s<a;s+=8)h=d[c++],n[l++]=128&h?b:v,n[l++]=64&h?b:v,n[l++]=32&h?b:v,n[l++]=16&h?b:v,n[l++]=8&h?b:v,n[l++]=4&h?b:v,n[l++]=2&h?b:v,n[l++]=1&h?b:v;for(;s<r;s++)0===o&&(h=d[c++],o=128),n[l++]=h&o?b:v,o>>=1}for(;l<g;)n[l++]=0;t.putImageData(o,0,u*Fr)}}else if(e.kind===Ki.RGBA_32BPP){for(p=0,g=i*Fr*4,u=0;u<r;u++)h.set(d.subarray(c,c+g)),c+=g,t.putImageData(o,0,p),p+=Fr;u<a&&(g=i*s*4,h.set(d.subarray(c,c+g)),t.putImageData(o,0,p))}else{if(e.kind!==Ki.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(f=Fr,g=i*f,u=0;u<a;u++){for(u>=r&&(f=s,g=i*f),l=0,p=g;p--;)h[l++]=d[c++],h[l++]=d[c++],h[l++]=d[c++],h[l++]=255;t.putImageData(o,0,u*Fr)}}}function zr(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const n=e.height,i=e.width,s=n%Fr,r=(n-s)/Fr,a=0===s?r:r+1,o=t.createImageData(i,Fr);let l=0;const c=e.data,d=o.data;for(let e=0;e<a;e++){const n=e<r?Fr:s;({srcPos:l}=Dr({src:c,srcPos:l,dest:d,width:i,height:n,nonBlackColor:0})),t.putImageData(o,0,e*Fr)}}function Vr(t,e){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==t[i]&&(e[i]=t[i]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function jr(t){if(t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0),!Vi){const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}}function $r(t,e){if(e)return!0;const n=As.singularValueDecompose2dScale(t);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Ts.PDF_TO_CSS_UNITS);return n[0]<=i&&n[1]<=i}const Ur=["butt","round","square"],Wr=["miter","round","bevel"],Gr={},qr={};class Xr{constructor(t,e,n,i,s,{optionalContentConfig:r,markedContentStack:a=null},o,l){this.ctx=t,this.current=new Br(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=r,this.cachedCanvases=new Or(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,r=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,r),this.ctx.fillStyle=a,n){const t=this.cachedCanvases.getCanvas("transparent",s,r);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...js(this.compositeCtx))}this.ctx.save(),jr(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=js(this.ctx)}executeOperatorList(t,e,n,i){const s=t.argsArray,r=t.fnArray;let a=e||0;const o=s.length;if(o===a)return a;const l=o-a>10&&"function"==typeof n,c=l?Date.now()+15:0;let d=0;const h=this.commonObjs,u=this.objs;let p;for(;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if(p=r[a],p!==Ji.dependency)this[p].apply(this,s[a]);else for(const t of s[a]){const e=t.startsWith("g_")?h:u;if(!e.has(t))return e.get(t,n),a}if(a++,a===o)return a;if(l&&++d>10){if(Date.now()>c)return n(),a;d=0}}}#Oe(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#Oe(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#Ne()}#Ne(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let s,r,a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=n,c=i,d="prescale1";for(;a>2&&l>1||o>2&&c>1;){let e=l,n=c;a>2&&l>1&&(e=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),a/=l/e),o>2&&c>1&&(n=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/n),s=this.cachedCanvases.getCanvas(d,e,n),r=s.context,r.clearRect(0,0,e,n),r.drawImage(t,0,0,l,c,0,0,e,n),t=s.canvas,l=e,c=n,d="prescale1"===d?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,s=this.current.fillColor,r=this.current.patternFill,a=js(e);let o,l,c,d;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;l=JSON.stringify(r?a:[a.slice(0,4),s]),o=this._cachedBitmapsMap.get(e),o||(o=new Map,this._cachedBitmapsMap.set(e,o));const n=o.get(l);if(n&&!r)return{canvas:n,offsetX:Math.round(Math.min(a[0],a[2])+a[4]),offsetY:Math.round(Math.min(a[1],a[3])+a[5])};c=n}c||(d=this.cachedCanvases.getCanvas("maskCanvas",n,i),zr(d.context,t));let h=As.transform(a,[1/n,0,0,-1/i,0,0]);h=As.transform(h,[1,0,0,1,0,-i]);const[u,p,f,g]=As.getAxialAlignedBoundingBox([0,0,n,i],h),m=Math.round(f-u)||1,b=Math.round(g-p)||1,v=this.cachedCanvases.getCanvas("fillCanvas",m,b),y=v.context,w=u,A=p;y.translate(-w,-A),y.transform(...h),c||(c=this._scaleImage(d.canvas,$s(y)),c=c.img,o&&r&&o.set(l,c)),y.imageSmoothingEnabled=$r(js(y),t.interpolate),Nr(y,c,0,0,c.width,c.height,0,0,n,i),y.globalCompositeOperation="source-in";const x=As.transform($s(y),[1,0,0,1,-w,-A]);return y.fillStyle=r?s.getPattern(e,this,x,Sr):s,y.fillRect(0,0,n,i),o&&!r&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,v.canvas)),{canvas:v.canvas,offsetX:Math.round(w),offsetY:Math.round(A)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Ur[t]}setLineJoin(t){this.ctx.lineJoin=Wr[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...js(this.suspendedCtx)),Vr(this.suspendedCtx,s),function(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},t.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},t.transform=function(t,n,i,s,r,a){e.transform(t,n,i,s,r,a),this.__originalTransform(t,n,i,s,r,a)},t.setTransform=function(t,n,i,s,r,a){e.setTransform(t,n,i,s,r,a),this.__originalSetTransform(t,n,i,s,r,a)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},t.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},t.bezierCurveTo=function(t,n,i,s,r,a){e.bezierCurveTo(t,n,i,s,r,a),this.__originalBezierCurveTo(t,n,i,s,r,a)},t.rect=function(t,n,i,s){e.rect(t,n,i,s),this.__originalRect(t,n,i,s)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Vr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const s=i[0],r=i[1],a=i[2]-s,o=i[3]-r;0!==a&&0!==o&&(this.genericComposeSMask(e.context,n,a,o,e.subtype,e.backdrop,e.transferMap,s,r,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,s,r,a,o,l,c,d){let h=t.canvas,u=o-c,p=l-d;if(r){const e=As.makeHexColor(...r);if(u<0||p<0||u+n>h.width||p+i>h.height){const t=this.cachedCanvases.getCanvas("maskExtension",n,i),s=t.context;s.drawImage(h,-u,-p),s.globalCompositeOperation="destination-atop",s.fillStyle=e,s.fillRect(0,0,n,i),s.globalCompositeOperation="source-over",h=t.canvas,u=p=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const s=new Path2D;s.rect(u,p,n,i),t.clip(s),t.globalCompositeOperation="destination-atop",t.fillStyle=e,t.fillRect(u,p,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===s&&a?e.filter=this.filterFactory.addAlphaFilter(a):"Luminosity"===s&&(e.filter=this.filterFactory.addLuminosityFilter(a));const f=new Path2D;f.rect(o,l,n,i),e.clip(f),e.globalCompositeOperation="destination-in",e.drawImage(h,u,p,n,i,o,l,n,i),e.restore()}save(){this.inSMaskMode?(Vr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Vr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,s,r){this.ctx.transform(t,e,n,i,s,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,s=this.current;let r,a,o=s.x,l=s.y;const c=js(i),d=0===c[0]&&0===c[3]||0===c[1]&&0===c[2],h=d?n.slice(0):null;for(let n=0,u=0,p=t.length;n<p;n++)switch(0|t[n]){case Ji.rectangle:o=e[u++],l=e[u++];const t=e[u++],n=e[u++],p=o+t,f=l+n;i.moveTo(o,l),0===t||0===n?i.lineTo(p,f):(i.lineTo(p,l),i.lineTo(p,f),i.lineTo(o,f)),d||s.updateRectMinMax(c,[o,l,p,f]),i.closePath();break;case Ji.moveTo:o=e[u++],l=e[u++],i.moveTo(o,l),d||s.updatePathMinMax(c,o,l);break;case Ji.lineTo:o=e[u++],l=e[u++],i.lineTo(o,l),d||s.updatePathMinMax(c,o,l);break;case Ji.curveTo:r=o,a=l,o=e[u+4],l=e[u+5],i.bezierCurveTo(e[u],e[u+1],e[u+2],e[u+3],o,l),s.updateCurvePathMinMax(c,r,a,e[u],e[u+1],e[u+2],e[u+3],o,l,h),u+=6;break;case Ji.curveTo2:r=o,a=l,i.bezierCurveTo(o,l,e[u],e[u+1],e[u+2],e[u+3]),s.updateCurvePathMinMax(c,r,a,o,l,e[u],e[u+1],e[u+2],e[u+3],h),o=e[u+2],l=e[u+3],u+=4;break;case Ji.curveTo3:r=o,a=l,o=e[u+2],l=e[u+3],i.bezierCurveTo(e[u],e[u+1],o,l,o,l),s.updateCurvePathMinMax(c,r,a,e[u],e[u+1],o,l,o,l,h),u+=4;break;case Ji.closePath:i.closePath()}d&&s.updateScalingPathMinMax(c,h),s.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof n&&n?.getPattern?(e.save(),e.strokeStyle=n.getPattern(e,this,$s(e),_r),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor;let i=!1;this.current.patternFill&&(e.save(),e.fillStyle=n.getPattern(e,this,$s(e),Sr),i=!0);const s=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==s&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),i&&e.restore(),t&&this.consumePath(s)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Gr}eoClip(){this.pendingClip=qr}beginText(){this.current.textMatrix=ji,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(const n of t)e.setTransform(...n.transform),e.translate(n.x,n.y),n.addToPath(e,n.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||$i,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||is("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const s=n.loadedName||"sans-serif",r=n.systemFontInfo?.css||`"${s}", ${n.fallbackName}`;let a="normal";n.black?a="900":n.bold&&(a="bold");const o=n.italic?"italic":"normal";let l=e;e<16?l=16:e>100&&(l=100),this.current.fontSizeScale=e/l,this.ctx.font=`${o} ${a} ${l}px ${r}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,s,r){this.current.textMatrix=[t,e,n,i,s,r],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i){const s=this.ctx,r=this.current,a=r.font,o=r.textRenderingMode,l=r.fontSize/r.fontSizeScale,c=3&o,d=!!(4&o),h=r.patternFill&&!a.missingFile;let u;(a.disableFontFace||d||h)&&(u=a.getPathGenerator(this.commonObjs,t)),a.disableFontFace||h?(s.save(),s.translate(e,n),s.beginPath(),u(s,l),i&&s.setTransform(...i),0!==c&&2!==c||s.fill(),1!==c&&2!==c||s.stroke(),s.restore()):(0!==c&&2!==c||s.fillText(t,e,n),1!==c&&2!==c||s.strokeText(t,e,n)),d&&(this.pendingTextPaths||=[]).push({transform:js(s),x:e,y:n,fontSize:l,addToPath:u})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let t=3;t<e.length;t+=4)if(e[t]>0&&e[t]<255){n=!0;break}return os(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(0===i)return;const s=this.ctx,r=e.fontSizeScale,a=e.charSpacing,o=e.wordSpacing,l=e.fontDirection,c=e.textHScale*l,d=t.length,h=n.vertical,u=h?1:-1,p=n.defaultVMetrics,f=i*e.fontMatrix[0],g=0===e.textRenderingMode&&!n.disableFontFace&&!e.patternFill;let m;if(s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),l>0?s.scale(c,-1):s.scale(c,1),e.patternFill){s.save();const t=e.fillColor.getPattern(s,this,$s(s),Sr);m=js(s),s.restore(),s.fillStyle=t}let b=e.lineWidth;const v=e.textMatrixScale;if(0===v||0===b){const t=3&e.textRenderingMode;1!==t&&2!==t||(b=this.getSinglePixelWidth())}else b/=v;if(1!==r&&(s.scale(r,r),b/=r),s.lineWidth=b,n.isInvalidPDFjsFont){const n=[];let i=0;for(const e of t)n.push(e.unicode),i+=e.width;return s.fillText(n.join(""),0,0),e.x+=i*f*c,s.restore(),void this.compose()}let y,w=0;for(y=0;y<d;++y){const e=t[y];if("number"==typeof e){w+=u*e*i/1e3;continue}let c=!1;const d=(e.isSpace?o:0)+a,b=e.fontChar,v=e.accent;let A,x,S=e.width;if(h){const t=e.vmetric||p,n=-(e.vmetric?t[1]:.5*S)*f,i=t[2]*f;S=t?-t[0]:S,A=n/r,x=(w+i)/r}else A=w/r,x=0;if(n.remeasure&&S>0){const t=1e3*s.measureText(b).width/i*r;if(S<t&&this.isFontSubpixelAAEnabled){const e=S/t;c=!0,s.save(),s.scale(e,1),A/=e}else S!==t&&(A+=(S-t)/2e3*i/r)}if(this.contentVisible&&(e.isInFont||n.missingFile))if(g&&!v)s.fillText(b,A,x);else if(this.paintChar(b,A,x,m),v){const t=A+i*v.offset.x/r,e=x-i*v.offset.y/r;this.paintChar(v.fontChar,t,e,m)}w+=h?S*f-d*l:S*f+d*l,c&&s.restore()}h?e.y-=w:e.x+=w*c,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,s=n.fontSize,r=n.fontDirection,a=i.vertical?1:-1,o=n.charSpacing,l=n.wordSpacing,c=n.textHScale*r,d=n.fontMatrix||$i,h=t.length;let u,p,f,g;if(3!==n.textRenderingMode&&0!==s){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(c,r),u=0;u<h;++u){if(p=t[u],"number"==typeof p){g=a*p*s/1e3,this.ctx.translate(g,0),n.x+=g*c;continue}const r=(p.isSpace?l:0)+o,h=i.charProcOperatorList[p.operatorListId];h?(this.contentVisible&&(this.processingType3=p,this.save(),e.scale(s,s),e.transform(...d),this.executeOperatorList(h),this.restore()),f=As.applyTransform([p.width,0],d)[0]*s+r,e.translate(f,0),n.x+=f*c):is(`Type3 character "${p.operatorListId}" is not available.`)}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,s,r){this.ctx.rect(n,i,s-n,r-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const n=t[1],i=this.baseTransform||js(this.ctx),s={createCanvasGraphics:t=>new Xr(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Lr(t,n,this.ctx,s,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=As.makeHexColor(t,e,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=As.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=function(t){switch(t[0]){case"RadialAxial":return new kr(t);case"Mesh":return new Ir(t);case"Dummy":return new Rr}throw new Error(`Unknown IR type: ${t[0]}`)}(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,$s(e),Er);const i=$s(e);if(i){const{width:t,height:n}=e.canvas,[s,r,a,o]=As.getAxialAlignedBoundingBox([0,0,t,n],i);this.ctx.fillRect(s,r,a-s,o-r)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ss("Should not call beginInlineImage")}beginImageData(){ss("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=js(this.ctx),e)){const t=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],t,n),this.current.updateRectMinMax(js(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ns("TODO: Support non-isolated groups."),t.knockout&&is("Knockout groups not supported.");const n=js(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=As.getAxialAlignedBoundingBox(t.bbox,js(e));const s=[0,0,e.canvas.width,e.canvas.height];i=As.intersect(i,s)||[0,0,0,0];const r=Math.floor(i[0]),a=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-r,1),l=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;t.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,o,l),h=d.context;h.translate(-r,-a),h.transform(...n),t.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:r,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(r,a),e.save()),Vr(e,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=js(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...t);const n=As.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,n,i,s){if(this.#Oe(),jr(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const i=e[2]-e[0],r=e[3]-e[1];if(s&&this.annotationCanvasMap){(n=n.slice())[4]-=e[0],n[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=i,e[3]=r;const[s,a]=As.singularValueDecompose2dScale(js(this.ctx)),{viewportScale:o}=this,l=Math.ceil(i*this.outputScaleX*o),c=Math.ceil(r*this.outputScaleY*o);this.annotationCanvas=this.canvasFactory.create(l,c);const{canvas:d,context:h}=this.annotationCanvas;this.annotationCanvasMap.set(t,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=h,this.ctx.save(),this.ctx.setTransform(s,0,0,-a,0,r*a),jr(this.ctx)}else jr(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],i,r),this.ctx.clip(),this.ctx.beginPath()}this.current=new Br(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#Ne(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const n=this.ctx,i=this.processingType3;if(i&&(void 0===i.compiled&&(i.compiled=function(t){const{width:e,height:n}=t;if(e>1e3||n>1e3)return null;const i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1;let r,a,o,l=new Uint8Array(s*(n+1));const c=e+7&-8;let d=new Uint8Array(c*n),h=0;for(const e of t.data){let t=128;for(;t>0;)d[h++]=e&t?0:255,t>>=1}let u=0;for(h=0,0!==d[h]&&(l[0]=1,++u),a=1;a<e;a++)d[h]!==d[h+1]&&(l[a]=d[h]?2:1,++u),h++;for(0!==d[h]&&(l[a]=2,++u),r=1;r<n;r++){h=r*c,o=r*s,d[h-c]!==d[h]&&(l[o]=d[h]?1:8,++u);let t=(d[h]?4:0)+(d[h-c]?8:0);for(a=1;a<e;a++)t=(t>>2)+(d[h+1]?4:0)+(d[h-c+1]?8:0),i[t]&&(l[o+a]=i[t],++u),h++;if(d[h-c]!==d[h]&&(l[o+a]=d[h]?2:4,++u),u>1e3)return null}for(h=c*(n-1),o=r*s,0!==d[h]&&(l[o]=8,++u),a=1;a<e;a++)d[h]!==d[h+1]&&(l[o+a]=d[h]?4:8,++u),h++;if(0!==d[h]&&(l[o+a]=4,++u),u>1e3)return null;const p=new Int32Array([0,s,-1,0,-s,0,0,0,1]),f=new Path2D;for(r=0;u&&r<=n;r++){let t=r*s;const n=t+e;for(;t<n&&!l[t];)t++;if(t===n)continue;f.moveTo(t%s,r);const i=t;let a=l[t];do{const e=p[a];do{t+=e}while(!l[t]);const n=l[t];5!==n&&10!==n?(a=n,l[t]=0):(a=n&51*a>>4,l[t]&=a>>2|a<<2),f.lineTo(t%s,t/s|0),l[t]||--u}while(i!==t);--r}return d=null,l=null,function(t){t.save(),t.scale(1/e,-1/n),t.translate(0,-n),t.fill(f),t.beginPath(),t.restore()}}(t)),i.compiled))return void i.compiled(n);const s=this._createMaskCanvas(t),r=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,s,r){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const o=js(a);a.transform(e,n,i,s,0,0);const l=this._createMaskCanvas(t);a.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let t=0,c=r.length;t<c;t+=2){const c=As.transform(o,[e,n,i,s,r[t],r[t+1]]),[d,h]=As.applyTransform([0,0],c);a.drawImage(l.canvas,d,h)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:t,width:r,height:a,transform:o}=s,l=this.cachedCanvases.getCanvas("maskCanvas",r,a),c=l.context;c.save(),zr(c,this.getObject(t,s)),c.globalCompositeOperation="source-in",c.fillStyle=i?n.getPattern(c,this,$s(e),Sr):n,c.fillRect(0,0,r,a),c.restore(),e.save(),e.transform(...o),e.scale(1,-1),Nr(e,l.canvas,0,0,r,a,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):is("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s)return void is("Dependent image isn't ready yet");const r=s.width,a=s.height,o=[];for(let t=0,s=i.length;t<s;t+=2)o.push({transform:[e,0,0,n,i[t],i[t+1]],x:0,y:0,w:r,h:a});this.paintInlineImageXObjectGroup(s,o)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:n,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",n,i),r=s.context;return r.filter=this.current.transferMaps,r.drawImage(e,0,0),r.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!Vi){const{filter:t}=i;"none"!==t&&""!==t&&(i.filter="none")}let s;if(i.scale(1/e,-1/n),t.bitmap)s=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)s=t;else{const i=this.cachedCanvases.getCanvas("inlineImage",e,n).context;Hr(i,t),s=this.applyTransferMapsToCanvas(i)}const r=this._scaleImage(s,$s(i));i.imageSmoothingEnabled=$r(js(i),t.interpolate),Nr(i,r.img,0,0,r.paintWidth,r.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const e=t.width,n=t.height,s=this.cachedCanvases.getCanvas("inlineImage",e,n).context;Hr(s,t),i=this.applyTransferMapsToCanvas(s)}for(const t of e)n.save(),n.transform(...t.transform),n.scale(1,-1),Nr(n,i,t.x,t.y,t.w,t.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===qr?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=js(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:s}=this.ctx.getTransform();let r,a;if(0===n&&0===i){const n=Math.abs(e),i=Math.abs(s);if(n===i)if(0===t)r=a=1/n;else{const e=n*t;r=a=e<1?1/e:1}else if(0===t)r=1/n,a=1/i;else{const e=n*t,s=i*t;r=e<1?1/e:1,a=s<1?1/s:1}}else{const o=Math.abs(e*s-n*i),l=Math.hypot(e,n),c=Math.hypot(i,s);if(0===t)r=c/o,a=l/o;else{const e=t*o;r=c>e?c/e:1,a=l>e?l/e:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,s]=this.getScaleForStroking();if(e.lineWidth=n||1,1===i&&1===s)return void e.stroke();const r=e.getLineDash();if(t&&e.save(),e.scale(i,s),r.length>0){const t=Math.max(i,s);e.setLineDash(r.map((e=>e/t))),e.lineDashOffset/=t}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const t in Ji)void 0!==Xr.prototype[t]&&(Xr.prototype[Ji[t]]=Xr.prototype[t]);class Kr{static#Be=null;static#He="";static get workerPort(){return this.#Be}static set workerPort(t){if(!("undefined"!=typeof Worker&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");this.#Be=t}static get workerSrc(){return this.#He}static set workerSrc(t){if("string"!=typeof t)throw new Error("Invalid `workerSrc` type.");this.#He=t}}function Yr(t){switch(t instanceof Error||"object"==typeof t&&null!==t||ss('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new gs(t.message);case"MissingPDFException":return new us(t.message);case"PasswordException":return new cs(t.message,t.code);case"UnexpectedResponseException":return new ps(t.message,t.status);case"UnknownErrorException":return new ds(t.message,t.details);default:return new ds(t.message,t.toString())}}class Jr{#ze=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#Ve.bind(this),{signal:this.#ze.signal})}#Ve({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#je(t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],1===t.callback)n.resolve(t.data);else{if(2!==t.callback)throw new Error("Unexpected callback case");n.reject(Yr(t.reason))}return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,s=this.comObj;new Promise((function(n){n(e(t.data))})).then((function(e){s.postMessage({sourceName:n,targetName:i,callback:1,callbackId:t.callbackId,data:e})}),(function(e){s.postMessage({sourceName:n,targetName:i,callback:2,callbackId:t.callbackId,reason:Yr(e)})}))}else t.streamId?this.#$e(t):e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(t){s.reject(t)}return s.promise}sendWithStream(t,e,n,i){const s=this.streamId++,r=this.sourceName,a=this.targetName,o=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[s]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:r,targetName:a,action:t,streamId:s,data:e,desiredSize:n.desiredSize},i),l.promise},pull:t=>{const e=Promise.withResolvers();return this.streamControllers[s].pullCall=e,o.postMessage({sourceName:r,targetName:a,stream:6,streamId:s,desiredSize:t.desiredSize}),e.promise},cancel:t=>{rs(t instanceof Error,"cancel must have a valid reason");const e=Promise.withResolvers();return this.streamControllers[s].cancelCall=e,this.streamControllers[s].isClosed=!0,o.postMessage({sourceName:r,targetName:a,stream:1,streamId:s,reason:Yr(t)}),e.promise}},n)}#$e(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,r=this,a=this.actionHandler[t.action],o={enqueue(t,r=1,a){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=r,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:4,streamId:e,chunk:t},a)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:3,streamId:e}),delete r.streamSinks[e])},error(t){rs(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:5,streamId:e,reason:Yr(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,new Promise((function(e){e(a(t.data,o))})).then((function(){s.postMessage({sourceName:n,targetName:i,stream:8,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:n,targetName:i,stream:8,streamId:e,reason:Yr(t)})}))}#je(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,s=this.comObj,r=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case 8:t.success?r.startCall.resolve():r.startCall.reject(Yr(t.reason));break;case 7:t.success?r.pullCall.resolve():r.pullCall.reject(Yr(t.reason));break;case 6:if(!a){s.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,new Promise((function(t){t(a.onPull?.())})).then((function(){s.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,reason:Yr(t)})}));break;case 4:if(rs(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(t.chunk);break;case 3:if(rs(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),this.#Ue(r,e);break;case 5:rs(r,"error should have stream controller"),r.controller.error(Yr(t.reason)),this.#Ue(r,e);break;case 2:t.success?r.cancelCall.resolve():r.cancelCall.reject(Yr(t.reason)),this.#Ue(r,e);break;case 1:if(!a)break;new Promise((function(e){e(a.onCancel?.(Yr(t.reason)))})).then((function(){s.postMessage({sourceName:n,targetName:i,stream:2,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:n,targetName:i,stream:2,streamId:e,reason:Yr(t)})})),a.sinkCapability.reject(Yr(t.reason)),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#Ue(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#ze?.abort(),this.#ze=null}}class Qr{#We;#Ge;constructor({parsedData:t,rawData:e}){this.#We=t,this.#Ge=e}getRaw(){return this.#Ge}get(t){return this.#We.get(t)??null}getAll(){return vs(this.#We)}has(t){return this.#We.has(t)}}const Zr=Symbol("INTERNAL");class ta{#qe=!1;#Xe=!1;#Ke=!1;#Ye=!0;constructor(t,{name:e,intent:n,usage:i,rbGroups:s}){this.#qe=!!(2&t),this.#Xe=!!(4&t),this.name=e,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(this.#Ke)return this.#Ye;if(!this.#Ye)return!1;const{print:t,view:e}=this.usage;return this.#qe?"OFF"!==e?.viewState:!this.#Xe||"OFF"!==t?.printState}_setVisible(t,e,n=!1){t!==Zr&&ss("Internal method `_setVisible` called."),this.#Ke=n,this.#Ye=e}}class ea{#Je=null;#Qe=new Map;#Ze=null;#tn=null;constructor(t,e=2){if(this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,this.#tn=t.order;for(const n of t.groups)this.#Qe.set(n.id,new ta(e,n));if("OFF"===t.baseState)for(const t of this.#Qe.values())t._setVisible(Zr,!1);for(const e of t.on)this.#Qe.get(e)._setVisible(Zr,!0);for(const e of t.off)this.#Qe.get(e)._setVisible(Zr,!1);this.#Ze=this.getHash()}}#en(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const e=t[i];let s;if(Array.isArray(e))s=this.#en(e);else{if(!this.#Qe.has(e))return is(`Optional content group not found: ${e}`),!0;s=this.#Qe.get(e).visible}switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===n}isVisible(t){if(0===this.#Qe.size)return!0;if(!t)return ns("Optional content group not defined."),!0;if("OCG"===t.type)return this.#Qe.has(t.id)?this.#Qe.get(t.id).visible:(is(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return this.#en(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!this.#Qe.has(e))return is(`Optional content group not found: ${e}`),!0;if(this.#Qe.get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!this.#Qe.has(e))return is(`Optional content group not found: ${e}`),!0;if(!this.#Qe.get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!this.#Qe.has(e))return is(`Optional content group not found: ${e}`),!0;if(!this.#Qe.get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!this.#Qe.has(e))return is(`Optional content group not found: ${e}`),!0;if(this.#Qe.get(e).visible)return!1}return!0}return is(`Unknown optional content policy ${t.policy}.`),!0}return is(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const i=this.#Qe.get(t);if(i){if(n&&e&&i.rbGroups.length)for(const e of i.rbGroups)for(const n of e)n!==t&&this.#Qe.get(n)?._setVisible(Zr,!1,!0);i._setVisible(Zr,!!e,!0),this.#Je=null}else is(`Optional content group not found: ${t}`)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const t=this.#Qe.get(i);if(t)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!t.visible,e)}}this.#Je=null}get hasInitialVisibility(){return null===this.#Ze||this.getHash()===this.#Ze}getOrder(){return this.#Qe.size?this.#tn?this.#tn.slice():[...this.#Qe.keys()]:null}getGroups(){return this.#Qe.size>0?vs(this.#Qe):null}getGroup(t){return this.#Qe.get(t)||null}getHash(){if(null!==this.#Je)return this.#Je;const t=new or;for(const[e,n]of this.#Qe)t.update(`${e}:${n.visible}`);return this.#Je=t.hexdigest()}}class na{constructor(t,{disableRange:e=!1,disableStream:n=!1}){rs(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:r,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=a,s?.length>0){const t=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener(((t,e)=>{this._onReceiveData({begin:t,chunk:e})})),t.addProgressListener(((t,e)=>{this._onProgress({loaded:t,total:e})})),t.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),t.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;void 0===t?this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n):rs(this._rangeReaders.some((function(e){return e._begin===t&&(e._enqueue(n),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){rs(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new ia(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new sa(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class ia{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=Rs(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class sa{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function ra(t,e){const n=new Headers;if(!t||!e||"object"!=typeof e)return n;for(const t in e){const i=e[t];void 0!==i&&n.append(t,i)}return n}function aa({responseHeaders:t,isHttp:e,rangeChunkSize:n,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(t.get("Content-Length"),10);return Number.isInteger(r)?(s.suggestedLength=r,r<=2*n||i||!e||"bytes"!==t.get("Accept-Ranges")||"identity"!==(t.get("Content-Encoding")||"identity")||(s.allowRangeRequests=!0),s):s}function oa(t){const e=t.get("Content-Disposition");if(e){let t=function(t){let e=!0,n=i("filename\\*","i").exec(t);if(n){n=n[1];let t=a(n);return t=unescape(t),t=o(t),t=l(t),r(t)}if(n=function(t){const e=[];let n;const s=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=s.exec(t));){let[,t,i,s]=n;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[i,s]}const r=[];for(let t=0;t<e.length&&t in e;++t){let[n,i]=e[t];i=a(i),n&&(i=unescape(i),0===t&&(i=o(i))),r.push(i)}return r.join("")}(t),n)return r(l(n));if(n=i("filename","i").exec(t),n){n=n[1];let t=a(n);return t=l(t),r(t)}function i(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function s(t,n){if(t){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(t,{fatal:!0}),s=bs(n);n=i.decode(s),e=!1}catch{}}return n}function r(t){return e&&/[\x80-\xff]/.test(t)&&(t=s("utf-8",t),e&&(t=s("iso-8859-1",t))),t}function a(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const n=e[t].indexOf('"');-1!==n&&(e[t]=e[t].slice(0,n),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function o(t){const e=t.indexOf("'");return-1===e?t:s(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function l(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,n,i){if("q"===n||"Q"===n)return s(e,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})));try{i=atob(i)}catch{}return s(e,i)}))}return""}(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Rs(t))return t}return null}function la(t,e){return 404===t||0===t&&e.startsWith("file:")?new us('Missing PDF "'+e+'".'):new ps(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)}function ca(t){return 200===t||206===t}function da(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function ha(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(is(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class ua{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=ra(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return rs(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new pa(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new fa(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class pa{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,da(n,this._withCredentials,this._abortController)).then((e=>{if(!ca(e.status))throw la(e.status,i);this._reader=e.body.getReader(),this._headersCapability.resolve();const n=e.headers,{allowRangeRequests:s,suggestedLength:r}=aa({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=r||this._contentLength,this._filename=oa(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new gs("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:ha(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class fa{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${n-1}`);const r=i.url;fetch(r,da(s,this._withCredentials,this._abortController)).then((t=>{if(!ca(t.status))throw la(t.status,r);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:ha(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class ga{constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=ra(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,n){const i={begin:t,end:e};for(const t in n)i[t]=n[t];return this.request(i)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[t,n]of this.headers)e.setRequestHeader(t,n);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=206):i.expectedStatus=200,e.responseType="arraybuffer",t.onError&&(e.onerror=function(n){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===i.status&&this.isHttp)return void n.onError?.(i.status);const s=i.status||200;if((200!==s||206!==n.expectedStatus)&&s!==n.expectedStatus)return void n.onError?.(i.status);const r=function(t){const e=t.response;return"string"!=typeof e?e:bs(e).buffer}(i);if(206===s){const t=i.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);n.onDone({begin:parseInt(e[1],10),chunk:r})}else r?n.onDone({begin:0,chunk:r}):n.onError?.(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class ma{constructor(t){this._source=t,this._manager=new ga(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return rs(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ba(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new va(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class ba{constructor(t,e){this._manager=t;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(n),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),n=new Headers(e.getAllResponseHeaders().trim().split(/[\r\n]+/).map((t=>{const[e,...n]=t.split(": ");return[e,n.join(": ")]}))),{allowRangeRequests:i,suggestedLength:s}=aa({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=oa(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=la(t,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class va{constructor(t,e,n){this._manager=t;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=la(t,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const ya=/^[a-z][a-z0-9\-+.]+:/i;function wa(t,e,n){return"http:"===t.protocol?Ar.get("http").request(t,{headers:e},n):Ar.get("https").request(t,{headers:e},n)}class Aa{constructor(t){this.source=t,this.url=function(t){if(ya.test(t))return new URL(t);const e=Ar.get("url");return new URL(e.pathToFileURL(t))}(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.headers=ra(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return rs(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Ca(this):new _a(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new Ta(this,t,e):new Ea(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class xa{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new gs("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Sa{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}class _a extends xa{constructor(t){super(t);const e=Object.fromEntries(t.headers);this._request=wa(this._url,e,(e=>{if(404===e.statusCode){const t=new us(`Missing PDF "${this._url}".`);return this._storedError=t,void this._headersCapability.reject(t)}this._headersCapability.resolve(),this._setReadableStream(e);const n=new Headers(this._readableStream.headers),{allowRangeRequests:i,suggestedLength:s}=aa({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=s||this._contentLength,this._filename=oa(n)})),this._request.on("error",(t=>{this._storedError=t,this._headersCapability.reject(t)})),this._request.end()}}class Ea extends Sa{constructor(t,e,n){super(t);const i=Object.fromEntries(t.headers);i.Range=`bytes=${e}-${n-1}`,this._request=wa(this._url,i,(t=>{if(404!==t.statusCode)this._setReadableStream(t);else{const t=new us(`Missing PDF "${this._url}".`);this._storedError=t}})),this._request.on("error",(t=>{this._storedError=t})),this._request.end()}}class Ca extends xa{constructor(t){super(t);const e=Ar.get("fs");e.promises.lstat(this._url).then((t=>{this._contentLength=t.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()}),(t=>{"ENOENT"===t.code&&(t=new us(`Missing PDF "${this._url}".`)),this._storedError=t,this._headersCapability.reject(t)}))}}class Ta extends Sa{constructor(t,e,n){super(t);const i=Ar.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:e,end:n-1}))}}const ka=30;class Ma{#nn=Promise.withResolvers();#ut=null;#in=!1;#sn=!!globalThis.FontInspector?.enabled;#rn=null;#an=null;#on=0;#ln=0;#cn=null;#dn=null;#hn=0;#un=0;#pn=Object.create(null);#fn=[];#gn=null;#mn=[];#bn=new WeakMap;#vn=null;static#yn=new Map;static#wn=new Map;static#An=new WeakMap;static#xn=null;static#Sn=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#gn=t;else{if("object"!=typeof t)throw new Error('No "textContentSource" parameter specified.');this.#gn=new ReadableStream({start(e){e.enqueue(t),e.close()}})}this.#ut=this.#dn=e,this.#un=n.scale*(globalThis.devicePixelRatio||1),this.#hn=n.rotation,this.#an={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:s,pageX:r,pageY:a}=n.rawDims;this.#vn=[1,0,0,-1,-r,a+s],this.#ln=i,this.#on=s,Ma.#_n(),Us(e,n),this.#nn.promise.finally((()=>{Ma.#Sn.delete(this),this.#an=null,this.#pn=null})).catch((()=>{}))}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=ys.platform;return os(this,"fontFamilyMap",new Map([["sans-serif",(t&&e?"Calibri, ":"")+"sans-serif"],["monospace",(t&&e?"Lucida Console, ":"")+"monospace"]]))}render(){const t=()=>{this.#cn.read().then((({value:e,done:n})=>{n?this.#nn.resolve():(this.#rn??=e.lang,Object.assign(this.#pn,e.styles),this.#En(e.items),t())}),this.#nn.reject)};return this.#cn=this.#gn.getReader(),Ma.#Sn.add(this),t(),this.#nn.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==this.#hn&&(e?.(),this.#hn=i,Us(this.#dn,{rotation:i})),n!==this.#un){e?.(),this.#un=n;const t={div:null,properties:null,ctx:Ma.#Cn(this.#rn)};for(const e of this.#mn)t.properties=this.#bn.get(e),t.div=e,this.#Tn(t)}}cancel(){const t=new gs("TextLayer task cancelled.");this.#cn?.cancel(t).catch((()=>{})),this.#cn=null,this.#nn.reject(t)}get textDivs(){return this.#mn}get textContentItemsStr(){return this.#fn}#En(t){if(this.#in)return;this.#an.ctx??=Ma.#Cn(this.#rn);const e=this.#mn,n=this.#fn;for(const i of t){if(e.length>1e5)return is("Ignoring additional textDivs for performance reasons."),void(this.#in=!0);if(void 0!==i.str)n.push(i.str),this.#kn(i);else if("beginMarkedContentProps"===i.type||"beginMarkedContent"===i.type){const t=this.#ut;this.#ut=document.createElement("span"),this.#ut.classList.add("markedContent"),null!==i.id&&this.#ut.setAttribute("id",`${i.id}`),t.append(this.#ut)}else"endMarkedContent"===i.type&&(this.#ut=this.#ut.parentNode)}}#kn(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};this.#mn.push(e);const i=As.transform(this.#vn,t.transform);let s=Math.atan2(i[1],i[0]);const r=this.#pn[t.fontName];r.vertical&&(s+=Math.PI/2);let a=this.#sn&&r.fontSubstitution||r.fontFamily;a=Ma.fontFamilyMap.get(a)||a;const o=Math.hypot(i[2],i[3]),l=o*Ma.#Mn(a,this.#rn);let c,d;0===s?(c=i[4],d=i[5]-l):(c=i[4]+l*Math.sin(s),d=i[5]-l*Math.cos(s));const h="calc(var(--scale-factor)*",u=e.style;this.#ut===this.#dn?(u.left=`${(100*c/this.#ln).toFixed(2)}%`,u.top=`${(100*d/this.#on).toFixed(2)}%`):(u.left=`${h}${c.toFixed(2)}px)`,u.top=`${h}${d.toFixed(2)}px)`),u.fontSize=`${h}${(Ma.#xn*o).toFixed(2)}px)`,u.fontFamily=a,n.fontSize=o,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#sn&&(e.dataset.fontName=r.fontSubstitutionLoadedName||t.fontName),0!==s&&(n.angle=s*(180/Math.PI));let p=!1;if(t.str.length>1)p=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(p=!0)}if(p&&(n.canvasWidth=r.vertical?t.height:t.width),this.#bn.set(e,n),this.#an.div=e,this.#an.properties=n,this.#Tn(this.#an),n.hasText&&this.#ut.append(e),n.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this.#ut.append(t)}}#Tn(t){const{div:e,properties:n,ctx:i}=t,{style:s}=e;let r="";if(Ma.#xn>1&&(r=`scale(${1/Ma.#xn})`),0!==n.canvasWidth&&n.hasText){const{fontFamily:t}=s,{canvasWidth:a,fontSize:o}=n;Ma.#Pn(i,o*this.#un,t);const{width:l}=i.measureText(e.textContent);l>0&&(r=`scaleX(${a*this.#un/l}) ${r}`)}0!==n.angle&&(r=`rotate(${n.angle}deg) ${r}`),r.length>0&&(s.transform=r)}static cleanup(){if(!(this.#Sn.size>0)){this.#yn.clear();for(const{canvas:t}of this.#wn.values())t.remove();this.#wn.clear()}}static#Cn(t=null){let e=this.#wn.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#wn.set(t,e),this.#An.set(e,{size:0,family:""})}return e}static#Pn(t,e,n){const i=this.#An.get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)}static#_n(){if(null!==this.#xn)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#xn=t.getBoundingClientRect().height,t.remove()}static#Mn(t,e){const n=this.#yn.get(t);if(n)return n;const i=this.#Cn(e);i.canvas.width=i.canvas.height=ka,this.#Pn(i,ka,t);const s=i.measureText("");let r=s.fontBoundingBoxAscent,a=Math.abs(s.fontBoundingBoxDescent);if(r){const e=r/(r+a);return this.#yn.set(t,e),i.canvas.width=i.canvas.height=0,e}i.strokeStyle="red",i.clearRect(0,0,ka,ka),i.strokeText("g",0,0);let o=i.getImageData(0,0,ka,ka).data;a=0;for(let t=o.length-1-3;t>=0;t-=4)if(o[t]>0){a=Math.ceil(t/4/ka);break}i.clearRect(0,0,ka,ka),i.strokeText("A",0,ka),o=i.getImageData(0,0,ka,ka).data,r=0;for(let t=0,e=o.length;t<e;t+=4)if(o[t]>0){r=ka-Math.floor(t/4/ka);break}i.canvas.width=i.canvas.height=0;const l=r?r/(r+a):.8;return this.#yn.set(t,l),l}}class Pa{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};return function t(n){if(!n)return;let i=null;const s=n.name;if("#text"===s)i=n.value;else{if(!Pa.shouldBuildText(s))return;n?.attributes?.textContent?i=n.attributes.textContent:n.value&&(i=n.value)}if(null!==i&&e.push({str:i}),n.children)for(const e of n.children)t(e)}(t),n}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}const Ia=65536,Ra=Vi?class extends pr{_createCanvas(t,e){return Ar.get("canvas").createCanvas(t,e)}}:class extends pr{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}},La=Vi?class extends fr{async _fetch(t){return xr(t)}}:gr,Da=Vi?class extends mr{}:class extends mr{#In;#Rn;#Ln;#Dn;#Fn;#On;#y=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#Dn=t,this.#Fn=e}get#A(){return this.#Rn||=new Map}get#Nn(){return this.#On||=new Map}get#Bn(){if(!this.#Ln){const t=this.#Fn.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#Fn.createElementNS(Cs,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#Ln=this.#Fn.createElementNS(Cs,"defs"),t.append(n),n.append(this.#Ln),this.#Fn.body.append(t)}return this.#Ln}#Hn(t){if(1===t.length){const e=t[0],n=new Array(256);for(let t=0;t<256;t++)n[t]=e[t]/255;const i=n.join(",");return[i,i,i]}const[e,n,i]=t,s=new Array(256),r=new Array(256),a=new Array(256);for(let t=0;t<256;t++)s[t]=e[t]/255,r[t]=n[t]/255,a[t]=i[t]/255;return[s.join(","),r.join(","),a.join(",")]}#zn(t){if(void 0===this.#In){this.#In="";const t=this.#Fn.URL;t!==this.#Fn.baseURI&&(Is(t)?is('#createUrl: ignore "data:"-URL for performance reasons.'):this.#In=t.split("#",1)[0])}return`url(${this.#In}#${t})`}addFilter(t){if(!t)return"none";let e=this.#A.get(t);if(e)return e;const[n,i,s]=this.#Hn(t),r=1===t.length?n:`${n}${i}${s}`;if(e=this.#A.get(r),e)return this.#A.set(t,e),e;const a=`g_${this.#Dn}_transfer_map_${this.#y++}`,o=this.#zn(a);this.#A.set(t,o),this.#A.set(r,o);const l=this.#Vn(a);return this.#jn(n,i,s,l),o}addHCMFilter(t,e){const n=`${t}-${e}`,i="base";let s=this.#Nn.get(i);if(s?.key===n)return s.url;if(s?(s.filter?.remove(),s.key=n,s.url="none",s.filter=null):(s={key:n,url:"none",filter:null},this.#Nn.set(i,s)),!t||!e)return s.url;const r=this.#$n(t);t=As.makeHexColor(...r);const a=this.#$n(e);if(e=As.makeHexColor(...a),this.#Bn.style.color="","#000000"===t&&"#ffffff"===e||t===e)return s.url;const o=new Array(256);for(let t=0;t<=255;t++){const e=t/255;o[t]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const l=o.join(","),c=`g_${this.#Dn}_hcm_filter`,d=s.filter=this.#Vn(c);this.#jn(l,l,l,d),this.#Un(d);const h=(t,e)=>{const n=r[t]/255,i=a[t]/255,s=new Array(e+1);for(let t=0;t<=e;t++)s[t]=n+t/e*(i-n);return s.join(",")};return this.#jn(h(0,5),h(1,5),h(2,5),d),s.url=this.#zn(c),s.url}addAlphaFilter(t){let e=this.#A.get(t);if(e)return e;const[n]=this.#Hn([t]),i=`alpha_${n}`;if(e=this.#A.get(i),e)return this.#A.set(t,e),e;const s=`g_${this.#Dn}_alpha_map_${this.#y++}`,r=this.#zn(s);this.#A.set(t,r),this.#A.set(i,r);const a=this.#Vn(s);return this.#Wn(n,a),r}addLuminosityFilter(t){let e,n,i=this.#A.get(t||"luminosity");if(i)return i;if(t?([e]=this.#Hn([t]),n=`luminosity_${e}`):n="luminosity",i=this.#A.get(n),i)return this.#A.set(t,i),i;const s=`g_${this.#Dn}_luminosity_map_${this.#y++}`,r=this.#zn(s);this.#A.set(t,r),this.#A.set(n,r);const a=this.#Vn(s);return this.#Gn(a),t&&this.#Wn(e,a),r}addHighlightHCMFilter(t,e,n,i,s){const r=`${e}-${n}-${i}-${s}`;let a=this.#Nn.get(t);if(a?.key===r)return a.url;if(a?(a.filter?.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},this.#Nn.set(t,a)),!e||!n)return a.url;const[o,l]=[e,n].map(this.#$n.bind(this));let c=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[h,u]=[i,s].map(this.#$n.bind(this));d<c&&([c,d,h,u]=[d,c,u,h]),this.#Bn.style.color="";const p=(t,e,n)=>{const i=new Array(256),s=(d-c)/n,r=t/255,a=(e-t)/(255*n);let o=0;for(let t=0;t<=n;t++){const e=Math.round(c+t*s),n=r+t*a;for(let t=o;t<=e;t++)i[t]=n;o=e+1}for(let t=o;t<256;t++)i[t]=i[o-1];return i.join(",")},f=`g_${this.#Dn}_hcm_${t}_filter`,g=a.filter=this.#Vn(f);return this.#Un(g),this.#jn(p(h[0],u[0],5),p(h[1],u[1],5),p(h[2],u[2],5),g),a.url=this.#zn(f),a.url}destroy(t=!1){t&&0!==this.#Nn.size||(this.#Ln&&(this.#Ln.parentNode.parentNode.remove(),this.#Ln=null),this.#Rn&&(this.#Rn.clear(),this.#Rn=null),this.#y=0)}#Gn(t){const e=this.#Fn.createElementNS(Cs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#Un(t){const e=this.#Fn.createElementNS(Cs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#Vn(t){const e=this.#Fn.createElementNS(Cs,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#Bn.append(e),e}#qn(t,e,n){const i=this.#Fn.createElementNS(Cs,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}#jn(t,e,n,i){const s=this.#Fn.createElementNS(Cs,"feComponentTransfer");i.append(s),this.#qn(s,"feFuncR",t),this.#qn(s,"feFuncG",e),this.#qn(s,"feFuncB",n)}#Wn(t,e){const n=this.#Fn.createElementNS(Cs,"feComponentTransfer");e.append(n),this.#qn(n,"feFuncA",t)}#$n(t){return this.#Bn.style.color=t,Vs(getComputedStyle(this.#Bn).getPropertyValue("color"))}},Fa=Vi?class extends br{async _fetch(t){return xr(t)}}:vr;function Oa(t={}){"string"==typeof t||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e=new Ba,{docId:n}=e,i=t.url?function(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(Vi&&"string"==typeof t)return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(t.url):null,s=t.data?function(t){if(Vi&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return bs(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"==typeof t&&!isNaN(t?.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(t.data):null,r=t.httpHeaders||null,a=!0===t.withCredentials,o=t.password??null,l=t.range instanceof Ha?t.range:null,c=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:Ia;let d=t.worker instanceof $a?t.worker:null;const h=t.verbosity,u="string"!=typeof t.docBaseUrl||Is(t.docBaseUrl)?null:t.docBaseUrl,p="string"==typeof t.cMapUrl?t.cMapUrl:null,f=!1!==t.cMapPacked,g=t.CMapReaderFactory||La,m="string"==typeof t.standardFontDataUrl?t.standardFontDataUrl:null,b=t.StandardFontDataFactory||Fa,v=!0!==t.stopAtErrors,y=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,w=!1!==t.isEvalSupported,A="boolean"==typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!Vi,x="boolean"==typeof t.isChrome?t.isChrome:!ys.platform.isFirefox&&"undefined"!=typeof window&&!!window?.chrome,S=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,_="boolean"==typeof t.disableFontFace?t.disableFontFace:Vi,E=!0===t.fontExtraProperties,C=!0===t.enableXfa,T=t.ownerDocument||globalThis.document,k=!0===t.disableRange,M=!0===t.disableStream,P=!0===t.disableAutoFetch,I=!0===t.pdfBug,R=t.CanvasFactory||Ra,L=t.FilterFactory||Da,D=!0===t.enableHWA,F=l?l.length:t.length??NaN,O="boolean"==typeof t.useSystemFonts?t.useSystemFonts:!Vi&&!_,N="boolean"==typeof t.useWorkerFetch?t.useWorkerFetch:g===gr&&b===vr&&p&&m&&Os(p,document.baseURI)&&Os(m,document.baseURI);t.canvasFactory&&Bs("`canvasFactory`-instance option, please use `CanvasFactory` instead."),t.filterFactory&&Bs("`filterFactory`-instance option, please use `FilterFactory` instead."),ts(h);const B={canvasFactory:new R({ownerDocument:T,enableHWA:D}),filterFactory:new L({docId:n,ownerDocument:T}),cMapReaderFactory:N?null:new g({baseUrl:p,isCompressed:f}),standardFontDataFactory:N?null:new b({baseUrl:m})};if(!d){const t={verbosity:h,port:Kr.workerPort};d=t.port?$a.fromPort(t):new $a(t),e._worker=d}const H={docId:n,apiVersion:"4.8.69",data:s,password:o,disableAutoFetch:P,rangeChunkSize:c,length:F,docBaseUrl:u,enableXfa:C,evaluatorOptions:{maxImageSize:y,disableFontFace:_,ignoreErrors:v,isEvalSupported:w,isOffscreenCanvasSupported:A,isChrome:x,canvasMaxAreaInBytes:S,fontExtraProperties:E,useSystemFonts:O,cMapUrl:N?p:null,standardFontDataUrl:N?m:null}},z={disableFontFace:_,fontExtraProperties:E,ownerDocument:T,pdfBug:I,styleElement:null,loadingParams:{disableAutoFetch:P,enableXfa:C}};return d.promise.then((function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const t=d.messageHandler.sendWithPromise("GetDocRequest",H,s?[s.buffer]:null);let o;if(l)o=new na(l,{disableRange:k,disableStream:M});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let t;t=Vi?"undefined"!=typeof fetch&&"undefined"!=typeof Response&&"body"in Response.prototype&&Os(i)?ua:Aa:Os(i)?ua:ma,o=new t({url:i,length:F,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:k,disableStream:M})}return t.then((t=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const i=new Jr(n,t,d.port),s=new Ua(i,e,o,z,B);e._transport=s,i.send("Ready",null)}))})).catch(e._capability.reject),e}function Na(t){return"object"==typeof t&&Number.isInteger(t?.num)&&t.num>=0&&Number.isInteger(t?.gen)&&t.gen>=0}class Ba{static#Dn=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+Ba.#Dn++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}class Ha{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then((()=>{for(const n of this._progressListeners)n(t,e)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const e of this._progressiveReadListeners)e(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){ss("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class za{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return os(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Va{#Xn=null;#Kn=!1;constructor(t,e,n,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new Fs:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new Ga,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new Ms({viewBox:this.view,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return os(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=Wi.ENABLE,transform:s=null,background:r=null,optionalContentConfigPromise:a=null,annotationCanvasMap:o=null,pageColors:l=null,printAnnotationStorage:c=null,isEditing:d=!1}){this._stats?.time("Overall");const h=this._transport.getRenderingIntent(n,i,c,d),{renderingIntent:u,cacheKey:p}=h;this.#Kn=!1,this.#Yn(),a||=this._transport.getOptionalContentConfig(u);let f=this._intentStates.get(p);f||(f=Object.create(null),this._intentStates.set(p,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const g=!!(4&u);f.displayReadyCapability||(f.displayReadyCapability=Promise.withResolvers(),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));const m=t=>{f.renderTasks.delete(b),(this._maybeCleanupAfterRender||g)&&(this.#Kn=!0),this.#Jn(!g),t?(b.capability.reject(t),this._abortOperatorList({intentState:f,reason:t instanceof Error?t:new Error(t)})):b.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},b=new Xa({callback:m,params:{canvasContext:t,viewport:e,transform:s,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!g,pdfBug:this._pdfBug,pageColors:l});(f.renderTasks||=new Set).add(b);const v=b.task;return Promise.all([f.displayReadyCapability.promise,a]).then((([t,e])=>{if(this.destroyed)m();else{if(this._stats?.time("Rendering"),!(e.renderingIntent&u))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");b.initializeGraphics({transparency:t,optionalContentConfig:e}),b.operatorListChanged()}})).catch(m),v}getOperatorList({intent:t="display",annotationMode:e=Wi.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){const s=this._transport.getRenderingIntent(t,e,n,i,!0);let r,a=this._intentStates.get(s.cacheKey);return a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a)),a.opListReadCapability||(r=Object.create(null),r.operatorListChanged=function(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(r))},a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(r),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size(t){return t.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then((t=>Pa.textContent(t)));const e=this.streamTextContent(t);return new Promise((function(t,n){const i=e.getReader(),s={items:[],styles:Object.create(null),lang:null};!function e(){i.read().then((function({value:n,done:i}){i?t(s):(s.lang??=n.lang,Object.assign(s.styles,n.styles),s.items.push(...n.items),e())}),n)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#Kn=!1,this.#Yn(),Promise.all(t)}cleanup(t=!1){this.#Kn=!0;const e=this.#Jn(!1);return t&&e&&(this._stats&&=new Fs),e}#Jn(t=!1){if(this.#Yn(),!this.#Kn||this.destroyed)return!1;if(t)return this.#Xn=setTimeout((()=>{this.#Xn=null,this.#Jn(!1)}),5e3),!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#Kn=!1,!0}#Yn(){this.#Xn&&(clearTimeout(this.#Xn),this.#Xn=null)}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const t of e.renderTasks)t.operatorListChanged();t.lastChunk&&this.#Jn(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:r}=n,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},r).getReader(),o=this._intentStates.get(e);o.streamReader=a;const l=()=>{a.read().then((({value:t,done:e})=>{e?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),l())}),(t=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const t of o.renderTasks)t.operatorListChanged();this.#Jn(!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(t);else{if(!o.opListReadCapability)throw t;o.opListReadCapability.reject(t)}}}))};l()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Ps){let n=100;return e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})}),n))}}if(t.streamReader.cancel(new gs(e.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}class ja{#Qn=new Map;#Zn=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#Zn.then((()=>{for(const[t]of this.#Qn)t.call(this,n)}))}addEventListener(t,e,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:s}=n;if(s.aborted)return void is("LoopbackPort - cannot use an `aborted` signal.");const r=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",r),s.addEventListener("abort",r)}this.#Qn.set(e,i)}removeEventListener(t,e){const n=this.#Qn.get(e);n?.(),this.#Qn.delete(e)}terminate(){for(const[,t]of this.#Qn)t?.();this.#Qn.clear()}}class $a{static#ti=0;static#ei=!1;static#ni;static{Vi&&(this.#ei=!0,Kr.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||"null"===n.origin)return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},this._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}}constructor({name:t=null,port:e=null,verbosity:n=es()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if($a.#ni?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");return($a.#ni||=new WeakMap).set(e,this),void this._initializeFromPort(e)}this._initialize()}get promise(){return Vi?Promise.all([Ar.promise,this._readyCapability.promise]):this._readyCapability.promise}#ii(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Jr("main","worker",t),this._messageHandler.on("ready",(function(){})),this.#ii()}_initialize(){if($a.#ei||$a.#si)return void this._setupFakeWorker();let{workerSrc:t}=$a;try{$a._isSameOrigin(window.location.href,t)||(t=$a._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Jr("main","worker",e),i=()=>{s.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;e.addEventListener("error",(()=>{this._webWorker||i()}),{signal:s.signal}),n.on("test",(t=>{s.abort(),!this.destroyed&&t?(this._messageHandler=n,this._port=e,this._webWorker=e,this.#ii()):i()})),n.on("ready",(t=>{if(s.abort(),this.destroyed)i();else try{r()}catch{this._setupFakeWorker()}}));const r=()=>{const t=new Uint8Array;n.send("test",t,[t.buffer])};return void r()}catch{ns("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){$a.#ei||(is("Setting up fake worker."),$a.#ei=!0),$a._setupFakeWorkerGlobal.then((t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new ja;this._port=e;const n="fake"+$a.#ti++,i=new Jr(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new Jr(n,n+"_worker",e),this.#ii()})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),$a.#ni?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=this.#ni?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new $a(t)}static get workerSrc(){if(Kr.workerSrc)return Kr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#si(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return os(this,"_setupFakeWorkerGlobal",(async()=>this.#si?this.#si:(await import(this.workerSrc)).WorkerMessageHandler)())}}class Ua{#ri=new Map;#ai=new Map;#oi=new Map;#li=new Map;#ci=null;constructor(t,e,n,i,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Ga,this.fontLoader=new hr({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#di(t,e=null){const n=this.#ri.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return this.#ri.set(t,i),i}get annotationStorage(){return os(this,"annotationStorage",new cr)}getRenderingIntent(t,e=Wi.ENABLE,n=null,i=!1,s=!1){let r=2,a=lr;switch(t){case"any":r=1;break;case"display":break;case"print":r=4;break;default:is(`getRenderingIntent - invalid intent: ${t}`)}const o=4&r&&n instanceof dr?n:this.annotationStorage;switch(e){case Wi.DISABLE:r+=64;break;case Wi.ENABLE:break;case Wi.ENABLE_FORMS:r+=16;break;case Wi.ENABLE_STORAGE:r+=32,a=o.serializable;break;default:is(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(r+=128),s&&(r+=256);const{ids:l,hash:c}=o.modifiedIds;return{renderingIntent:r,cacheKey:[r,a.hash,c].join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#ci?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const e of this.#ai.values())t.push(e._destroy());this.#ai.clear(),this.#oi.clear(),this.#li.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#ri.clear(),this.filterFactory.destroy(),Ma.cleanup(),this._networkStream?.cancelAllRequests(new gs("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",((t,e)=>{rs(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then((function({value:t,done:n}){n?e.close():(rs(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(async t=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:s}=this._fullReader;return n&&i||(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:s}})),t.on("GetRangeReader",((t,e)=>{rs(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(t.begin,t.end);n?(e.onPull=()=>{n.read().then((function({value:t,done:n}){n?e.close():(rs(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{n.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}):e.close()})),t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,e._capability.resolve(new za(t,this))})),t.on("DocException",(function(t){let n;switch(t.name){case"PasswordException":n=new cs(t.message,t.code);break;case"InvalidPDFException":n=new hs(t.message);break;case"MissingPDFException":n=new us(t.message);break;case"UnexpectedResponseException":n=new ps(t.message,t.status);break;case"UnknownErrorException":n=new ds(t.message,t.details);break;default:ss("DocException - expected a valid Error.")}e._capability.reject(n)})),t.on("PasswordRequest",(t=>{if(this.#ci=Promise.withResolvers(),e.onPassword){const n=t=>{t instanceof Error?this.#ci.reject(t):this.#ci.resolve({password:t})};try{e.onPassword(n,t.code)}catch(t){this.#ci.reject(t)}}else this.#ci.reject(new cs(t.message,t.code));return this.#ci.promise})),t.on("DataLoaded",(t=>{e.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{this.destroyed||this.#ai.get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)})),t.on("commonobj",(([e,n,i])=>{if(this.destroyed)return null;if(this.commonObjs.has(e))return null;switch(n){case"Font":const{disableFontFace:s,fontExtraProperties:r,pdfBug:a}=this._params;if("error"in i){const t=i.error;is(`Error during font loading: ${t}`),this.commonObjs.resolve(e,t);break}const o=a&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,l=new ur(i,{disableFontFace:s,inspectFont:o});this.fontLoader.bind(l).catch((()=>t.sendWithPromise("FontFallback",{id:e}))).finally((()=>{!r&&l.data&&(l.data=null),this.commonObjs.resolve(e,l)}));break;case"CopyLocalImage":const{imageRef:c}=i;rs(c,"The imageRef must be defined.");for(const t of this.#ai.values())for(const[,n]of t.objs)if(n?.ref===c)return n.dataLen?(this.commonObjs.resolve(e,structuredClone(n)),n.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null})),t.on("obj",(([t,e,n,i])=>{if(this.destroyed)return;const s=this.#ai.get(e);if(!s.objs.has(t))if(0!==s._intentStates.size)switch(n){case"Image":s.objs.resolve(t,i),i?.dataLen>1e7&&(s._maybeCleanupAfterRender=!0);break;case"Pattern":s.objs.resolve(t,i);break;default:throw new Error(`Got unknown object type ${n}`)}else i?.bitmap?.close()})),t.on("DocProgress",(t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})})),t.on("FetchBuiltInCMap",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(t)})),t.on("FetchStandardFontData",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(t)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&is("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally((()=>{this.annotationStorage.resetModified()}))}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#oi.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then((n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&this.#li.set(n.refStr,t);const i=new Va(e,n,this,this._params.pdfBug);return this.#ai.set(e,i),i}));return this.#oi.set(e,i),i}getPageIndex(t){return Na(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#di("GetFieldObjects")}hasJSActions(){return this.#di("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#di("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#di("GetOptionalContentConfig").then((e=>new ea(e,t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#ri.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then((t=>({info:t[0],metadata:t[1]?new Qr(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#ri.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#ai.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#ri.clear(),this.filterFactory.destroy(!0),Ma.cleanup()}}cachedPageNumber(t){if(!Na(t))return null;const e=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return this.#li.get(e)??null}}const Wa=Symbol("INITIAL_DATA");class Ga{#hi=Object.create(null);#ui(t){return this.#hi[t]||={...Promise.withResolvers(),data:Wa}}get(t,e=null){if(e){const n=this.#ui(t);return n.promise.then((()=>e(n.data))),null}const n=this.#hi[t];if(!n||n.data===Wa)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#hi[t];return!!e&&e.data!==Wa}resolve(t,e=null){const n=this.#ui(t);n.data=e,n.resolve()}clear(){for(const t in this.#hi){const{data:e}=this.#hi[t];e?.bitmap?.close()}this.#hi=Object.create(null)}*[Symbol.iterator](){for(const t in this.#hi){const{data:e}=this.#hi[t];e!==Wa&&(yield[t,e])}}}class qa{#pi=null;constructor(t){this.#pi=t,this.onContinue=null}get promise(){return this.#pi.capability.promise}cancel(t=0){this.#pi.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#pi.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#pi;return t.form||t.canvas&&e?.size>0}}class Xa{#fi=null;static#gi=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:r,pageIndex:a,canvasFactory:o,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:d=!1,pageColors:h=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=a,this.canvasFactory=o,this.filterFactory=l,this._pdfBug=d,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!=typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new qa(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Xa.#gi.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Xa.#gi.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:s,background:r}=this.params;this.gfx=new Xr(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#fi&&(window.cancelAnimationFrame(this.#fi),this.#fi=null),Xa.#gi.delete(this._canvas),this.callback(t||new Ps(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#fi=window.requestAnimationFrame((()=>{this.#fi=null,this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Xa.#gi.delete(this._canvas),this.callback())))}}const Ka="4.8.69",Ya="3634dab10";function Ja(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function Qa(t){return Math.max(0,Math.min(255,255*t))}class Za{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return[t=Qa(t),t,t]}static G_HTML([t]){const e=Ja(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(Qa)}static RGB_HTML(t){return`#${t.map(Ja).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[Qa(1-Math.min(1,t+i)),Qa(1-Math.min(1,n+i)),Qa(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,s=1-e,r=1-n;return["CMYK",i,s,r,Math.min(i,s,r)]}}class to{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){ss("Abstract method `_createSVG` called.")}}class eo extends to{_createSVG(t){return document.createElementNS(Cs,t)}}class no{static setupStorage(t,e,n,i,s){const r=i.getValue(e,{value:null});switch(n.name){case"textarea":if(null!==r.value&&(t.textContent=r.value),"print"===s)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(r.value===n.attributes.xfaOn?t.setAttribute("checked",!0):r.value===n.attributes.xfaOff&&t.removeAttribute("checked"),"print"===s)break;t.addEventListener("change",(t=>{i.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==r.value&&t.setAttribute("value",r.value),"print"===s)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==r.value){t.setAttribute("value",r.value);for(const t of n.children)t.attributes.value===r.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",(t=>{const n=t.target.options,s=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(e,{value:s})}))}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:s}){const{attributes:r}=e,a=t instanceof HTMLAnchorElement;"radio"===r.type&&(r.name=`${r.name}-${i}`);for(const[e,n]of Object.entries(r))if(null!=n)switch(e){case"class":n.length&&t.setAttribute(e,n.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",n);break;case"style":Object.assign(t.style,n);break;case"textContent":t.textContent=n;break;default:(!a||"href"!==e&&"newWindow"!==e)&&t.setAttribute(e,n)}a&&s.addLinkAttributes(t,r.href,r.newWindow),n&&r.dataId&&this.setupStorage(t,r.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,s=t.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:s,linkService:n});const a="richText"!==s,o=t.div;if(o.append(r),t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;o.style.transform=e}a&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const t=document.createTextNode(i.value);r.append(t),a&&Pa.shouldBuildText(i.name)&&l.push(t)}return{textDivs:l}}const c=[[i,-1,r]];for(;c.length>0;){const[t,i,r]=c.at(-1);if(i+1===t.children.length){c.pop();continue}const o=t.children[++c.at(-1)[1]];if(null===o)continue;const{name:d}=o;if("#text"===d){const t=document.createTextNode(o.value);l.push(t),r.append(t);continue}const h=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,d):document.createElement(d);if(r.append(h),o.attributes&&this.setAttributes({html:h,element:o,storage:e,intent:s,linkService:n}),o.children?.length>0)c.push([o,-1,h]);else if(o.value){const t=document.createTextNode(o.value);a&&Pa.shouldBuildText(d)&&l.push(t),h.append(t)}}for(const t of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0);return{textDivs:l}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const io=1e3,so=new WeakSet;function ro(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class ao{static create(t){switch(t.data.annotationType){case 2:return new lo(t);case 1:return new co(t);case 20:switch(t.data.fieldType){case"Tx":return new uo(t);case"Btn":return t.data.radioButton?new go(t):t.data.checkBox?new fo(t):new mo(t);case"Ch":return new bo(t);case"Sig":return new po(t)}return new ho(t);case 16:return new vo(t);case 3:return new wo(t);case 4:return new Ao(t);case 5:return new xo(t);case 6:return new So(t);case 8:return new _o(t);case 14:return new Co(t);case 15:return new To(t);case 7:return new Eo(t);case 9:return new ko(t);case 10:return new Mo(t);case 11:return new Po(t);case 12:return new Io(t);case 13:return new Ro(t);case 17:return new Lo(t);default:return new oo(t)}}}class oo{#mi=null;#bi=!1;#vi=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t?.str||e?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return oo._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#mi||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#yi(e),this.#vi?.popup.updateEdited(t)}resetEdited(){this.#mi&&(this.#yi(this.#mi.rect),this.#vi?.popup.resetEdited(),this.#mi=null)}#yi(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}}}=this;n?.splice(0,4,...t);const{width:l,height:c}=ro(t);e.left=100*(t[0]-a)/s+"%",e.top=100*(r-t[3]+o)/r+"%",0===i?(e.width=100*l/s+"%",e.height=100*c/r+"%"):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof ho||(s.tabIndex=io);const{style:r}=s;if(r.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof vo){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,s),s}const{width:a,height:o}=ro(e.rect);if(!t&&e.borderStyle.width>0){r.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,n=e.borderStyle.verticalCornerRadius;if(t>0||n>0){const e=`calc(${t}px * var(--scale-factor)) / calc(${n}px * var(--scale-factor))`;r.borderRadius=e}else if(this instanceof go){const t=`calc(${a}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;r.borderRadius=t}switch(e.borderStyle.style){case 1:r.borderStyle="solid";break;case 2:r.borderStyle="dashed";break;case 3:is("Unimplemented border style: beveled");break;case 4:is("Unimplemented border style: inset");break;case 5:r.borderBottomStyle="solid"}const i=e.borderColor||null;i?(this.#bi=!0,r.borderColor=As.makeHexColor(0|i[0],0|i[1],0|i[2])):r.borderWidth=0}const l=As.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:d,pageX:h,pageY:u}=i.rawDims;r.left=100*(l[0]-h)/c+"%",r.top=100*(l[1]-u)/d+"%";const{rotation:p}=e;return e.hasOwnCanvas||0===p?(r.width=100*a/c+"%",r.height=100*o/d+"%"):this.setRotation(p,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:r}=ro(this.data.rect);let a,o;t%180==0?(a=100*s/n,o=100*r/i):(a=100*r/n,o=100*s/i),e.style.width=`${a}%`,e.style.height=`${o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,n)=>{const i=n.detail[t],s=i[0],r=i.slice(1);n.target.style[e]=Za[`${s}_HTML`](r),this.annotationStorage.setValue(this.data.id,{[e]:Za[`${s}_rgb`](r)})};return os(this,"_commonActions",{display:t=>{const{display:e}=t.detail,n=e%2==1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const s=t[i]||n[i];s?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,s]of Object.entries(e)){const r=n[i];r&&(r({detail:{[i]:s},target:t}),delete e[i])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,s]=this.data.rect.map((t=>Math.fround(t)));if(8===t.length){const[r,a,o,l]=t.subarray(2,6);if(i===r&&s===a&&e===o&&n===l)return}const{style:r}=this.container;let a;if(this.#bi){const{borderColor:t,borderWidth:e}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${t}" stroke-width="${e}">`],this.container.classList.add("hasBorder")}const o=i-e,l=s-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=c.createElement("defs");d.append(h);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),h.append(u);for(let n=2,i=t.length;n<i;n+=8){const i=t[n],r=t[n+1],d=t[n+2],h=t[n+3],p=c.createElement("rect"),f=(d-e)/o,g=(s-r)/l,m=(i-d)/o,b=(r-h)/l;p.setAttribute("x",f),p.setAttribute("y",g),p.setAttribute("width",m),p.setAttribute("height",b),u.append(p),a?.push(`<rect vector-effect="non-scaling-stroke" x="${f}" y="${g}" width="${m}" height="${b}"/>`)}this.#bi&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:t}=this,e=this.#vi=new vo({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){ss("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:t,id:s,exportValues:r}of i){if(-1===t)continue;if(s===e)continue;const i="string"==typeof r?r:null,a=document.querySelector(`[data-element-id="${s}"]`);!a||so.has(a)?n.push({id:s,exportValue:i,domElement:a}):is(`_getElementsByName - element not allowed: ${s}`)}return n}for(const i of document.getElementsByName(t)){const{exportValue:t}=i,s=i.getAttribute("data-element-id");s!==e&&so.has(i)&&n.push({id:s,exportValue:t,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})}))}}class lo extends oo{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action),i=!0):t.attachment?(this.#wi(n,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(this.#Ai(n,t.setOCGState),i=!0):t.dest?(this._bindLink(n,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#xi(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&this.#xi()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#xi()}#wi(t,e,n=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),this.#xi()}#Ai(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#xi()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const s=n.get(i);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}t.onclick||(t.onclick=()=>!1),this.#xi()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#xi(),!this._fieldObjects)return is('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(t.onclick=()=>!1));t.onclick=()=>{n?.();const{fields:t,refs:i,include:s}=e,r=[];if(0!==t.length||0!==i.length){const e=new Set(i);for(const n of t){const t=this._fieldObjects[n]||[];for(const{id:n}of t)e.add(n)}for(const t of Object.values(this._fieldObjects))for(const n of t)e.has(n.id)===s&&r.push(n)}else for(const t of Object.values(this._fieldObjects))r.push(...t);const a=this.annotationStorage,o=[];for(const t of r){const{id:e}=t;switch(o.push(e),t.type){case"text":{const n=t.defaultValue||"";a.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;a.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";a.setValue(e,{value:n});break}default:continue}const n=document.querySelector(`[data-element-id="${e}"]`);n&&(so.has(n)?n.dispatchEvent(new Event("resetform")):is(`_bindResetFormAction - element not allowed: ${e}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}}}class co extends oo{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ho extends oo{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ys.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,s){n.includes("mouse")?t.addEventListener(n,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(n,(t=>{if("blur"===n){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===n){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(t)}})}))}_setEventListeners(t,e,n,i){for(const[s,r]of n)("Action"===r||this.data.actions?.[r])&&("Focus"!==r&&"Blur"!==r||(e||={focused:!1}),this._setEventListener(t,e,s,r,i),"Focus"!==r||this.data.actions?.Blur?"Blur"!==r||this.data.actions?.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":As.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const{fontColor:e}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||9,i=t.style;let s;const r=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(Ui*n))||1);s=Math.min(n,r(e/Ui))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);s=Math.min(n,r(t/Ui))}i.fontSize=`calc(${s}px * var(--scale-factor))`,i.color=As.makeHexColor(e[0],e[1],e[2]),null!==this.data.textAlignment&&(i.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class uo extends ho{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,n,i){const s=this.annotationStorage;for(const r of this._getElementsByName(t.name,t.id))r.domElement&&(r.domElement[e]=n),s.setValue(r.id,{[i]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let s=i.value||"";const r=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;r&&s.length>r&&(s=s.slice(0,r));let a=i.formattedValue||this.data.textContent?.join("\n")||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const o={userValue:s,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=a??s,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",a??s),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),so.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=io,this._setRequired(n,this.data.required),r&&(n.maxLength=r),n.addEventListener("input",(i=>{t.setValue(e,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),o.formattedValue=null})),n.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue??"";n.value=o.userValue=e,o.formattedValue=null}));let l=t=>{const{formattedValue:e}=o;null!=e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",(t=>{if(o.focused)return;const{target:e}=t;o.userValue&&(e.value=o.userValue),o.lastCommittedValue=e.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)})),n.addEventListener("updatefromsandbox",(n=>{this.showElementAndHideCanvas(n.target);const i={value(n){o.userValue=n.detail.value??"",t.setValue(e,{value:o.userValue.toString()}),n.target.value=o.userValue},formattedValue(n){const{formattedValue:i}=n.detail;o.formattedValue=i,null!=i&&n.target!==document.activeElement&&(n.target.value=i),t.setValue(e,{formattedValue:i})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:n=>{const{charLimit:i}=n.detail,{target:s}=n;if(0===i)return void s.removeAttribute("maxLength");s.setAttribute("maxLength",i);let r=o.userValue;!r||r.length<=i||(r=r.slice(0,i),s.value=o.userValue=r,t.setValue(e,{value:r}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,willCommit:!0,commitKey:1,selStart:s.selectionStart,selEnd:s.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)})),n.addEventListener("keydown",(t=>{o.commitKey=1;let n=-1;if("Escape"===t.key?n=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):n=2,-1===n)return;const{value:i}=t.target;o.lastCommittedValue!==i&&(o.lastCommittedValue=i,o.userValue=i,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:i,willCommit:!0,commitKey:n,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const i=l;l=null,n.addEventListener("blur",(t=>{if(!o.focused||!t.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:n}=t.target;o.userValue=n,o.lastCommittedValue!==n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),i(t)})),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",(t=>{o.lastCommittedValue=null;const{data:n,target:i}=t,{value:s,selectionStart:r,selectionEnd:a}=i;let l=r,c=a;switch(t.inputType){case"deleteWordBackward":{const t=s.substring(0,r).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=s.substring(r).match(/^[^\w]*\w*/);t&&(c+=t[0].length);break}case"deleteContentBackward":r===a&&(l-=1);break;case"deleteContentForward":r===a&&(c+=1)}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,change:n||"",willCommit:!1,selStart:l,selEnd:c}})})),this._setEventListeners(n,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(l&&n.addEventListener("blur",l),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/r;n.classList.add("comb"),n.style.letterSpacing=`calc(${t}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class po extends ho{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class fo extends ho{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;"string"==typeof i&&(i="Off"!==i,t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return so.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=io,s.addEventListener("change",(i=>{const{name:s,checked:r}=i.target;for(const i of this._getElementsByName(s,n)){const n=r&&i.exportValue===e.exportValue;i.domElement&&(i.domElement.checked=n),t.setValue(i.id,{value:n})}t.setValue(n,{value:r})})),s.addEventListener("resetform",(t=>{const n=e.defaultFieldValue||"Off";t.target.checked=n===e.exportValue})),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",(e=>{const i={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(n,{value:e.target.checked})}};this._dispatchEventFromSandbox(i,e)})),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class go extends ho{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof i&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const i of this._getElementsByName(e.fieldName,n))t.setValue(i.id,{value:!1});const s=document.createElement("input");if(so.add(s),s.setAttribute("data-element-id",n),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=io,s.addEventListener("change",(e=>{const{name:i,checked:s}=e.target;for(const e of this._getElementsByName(i,n))t.setValue(e.id,{value:!1});t.setValue(n,{value:s})})),s.addEventListener("resetform",(t=>{const n=e.defaultFieldValue;t.target.checked=null!=n&&n===e.buttonValue})),this.enableScripting&&this.hasJSActions){const i=e.buttonValue;s.addEventListener("updatefromsandbox",(e=>{const s={value:e=>{const s=i===e.detail.value;for(const i of this._getElementsByName(e.target.name)){const e=s&&i.id===n;i.domElement&&(i.domElement.checked=e),t.setValue(i.id,{value:e})}}};this._dispatchEventFromSandbox(s,e)})),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class mo extends lo{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",(t=>{this._dispatchEventFromSandbox({},t)}))),t}}class bo extends ho{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");so.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=io;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue;for(const t of i.options)t.selected=t.value===e}));for(const t of this.data.options){const e=document.createElement("option");e.textContent=t.displayValue,e.value=t.exportValue,n.value.includes(t.exportValue)&&(e.setAttribute("selected",!0),s=!1),i.append(e)}let r=null;if(s){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),i.prepend(t),r=()=>{t.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const a=t=>{const e=t?"value":"textContent",{options:n,multiple:s}=i;return s?Array.prototype.filter.call(n,(t=>t.selected)).map((t=>t[e])):-1===n.selectedIndex?null:n[n.selectedIndex][e]};let o=a(!1);const l=t=>{const e=t.target.options;return Array.prototype.map.call(e,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(n=>{const s={value(n){r?.();const s=n.detail.value,l=new Set(Array.isArray(s)?s:[s]);for(const t of i.options)t.selected=l.has(t.value);t.setValue(e,{value:a(!0)}),o=a(!1)},multipleSelection(t){i.multiple=!0},remove(n){const s=i.options,r=n.detail.remove;s[r].selected=!1,i.remove(r),s.length>0&&-1===Array.prototype.findIndex.call(s,(t=>t.selected))&&(s[0].selected=!0),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},clear(n){for(;0!==i.length;)i.remove(0);t.setValue(e,{value:null,items:[]}),o=a(!1)},insert(n){const{index:s,displayValue:r,exportValue:c}=n.detail.insert,d=i.children[s],h=document.createElement("option");h.textContent=r,h.value=c,d?d.before(h):i.append(h),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},items(n){const{items:s}=n.detail;for(;0!==i.length;)i.remove(0);for(const t of s){const{displayValue:e,exportValue:n}=t,s=document.createElement("option");s.textContent=e,s.value=n,i.append(s)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},indices(n){const i=new Set(n.detail.indices);for(const t of n.target.options)t.selected=i.has(t.index);t.setValue(e,{value:a(!0)}),o=a(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(s,n)})),i.addEventListener("input",(n=>{const i=a(!0),s=a(!1);t.setValue(e,{value:i}),n.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,change:s,changeEx:i,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(t=>t.target.value))):i.addEventListener("input",(function(n){t.setValue(e,{value:a(!0)})})),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class vo extends oo{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:oo._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new yo({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map((t=>`${Es}${t}`)).join(",")),this.container}}class yo{#Si=this.#_i.bind(this);#Ei=this.#Ci.bind(this);#Ti=this.#ki.bind(this);#Mi=this.#Pi.bind(this);#Ii=null;#ut=null;#Ri=null;#Li=null;#Di=null;#Fi=null;#Oi=null;#Ni=!1;#Bi=null;#C=null;#Hi=null;#zi=null;#Vi=null;#mi=null;#ji=!1;constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:s,contentsObj:r,richText:a,parent:o,rect:l,parentRect:c,open:d}){this.#ut=t,this.#Vi=i,this.#Ri=r,this.#zi=a,this.#Fi=o,this.#Ii=e,this.#Hi=l,this.#Oi=c,this.#Di=n,this.#Li=Hs.toDateObject(s),this.trigger=n.flatMap((t=>t.getElementsToTriggerPopup()));for(const t of this.trigger)t.addEventListener("click",this.#Mi),t.addEventListener("mouseenter",this.#Ti),t.addEventListener("mouseleave",this.#Ei),t.classList.add("popupTriggerArea");for(const t of n)t.container?.addEventListener("keydown",this.#Si);this.#ut.hidden=!0,d&&this.#Pi()}render(){if(this.#Bi)return;const t=this.#Bi=document.createElement("div");if(t.className="popup",this.#Ii){const e=t.style.outlineColor=As.makeHexColor(...this.#Ii);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))t.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`;else{const e=.7;t.style.backgroundColor=As.makeHexColor(...this.#Ii.map((t=>Math.floor(e*(255-t)+t))))}}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),({dir:n.dir,str:n.textContent}=this.#Vi),t.append(e),this.#Li){const t=document.createElement("span");t.classList.add("popupDate"),t.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),t.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#Li.valueOf()})),e.append(t)}const i=this.#$i;if(i)no.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const e=this._formatContents(this.#Ri);t.append(e)}this.#ut.append(t)}get#$i(){const t=this.#zi,e=this.#Ri;return!t?.str||e?.str&&e.str!==t.str?null:this.#zi.html||null}get#Ui(){return this.#$i?.attributes?.style?.fontSize||0}get#Wi(){return this.#$i?.attributes?.style?.color||null}#Gi(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#Wi,fontSize:this.#Ui?`calc(${this.#Ui}px * var(--scale-factor))`:""}};for(const n of t.split("\n"))e.push({name:"span",value:n,attributes:i});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let t=0,e=i.length;t<e;++t){const s=i[t];n.append(document.createTextNode(s)),t<e-1&&n.append(document.createElement("br"))}return n}#_i(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&this.#Ni)&&this.#Pi()}updateEdited({rect:t,popupContent:e}){this.#mi||={contentsObj:this.#Ri,richText:this.#zi},t&&(this.#C=null),e&&(this.#zi=this.#Gi(e),this.#Ri=null),this.#Bi?.remove(),this.#Bi=null}resetEdited(){this.#mi&&(({contentsObj:this.#Ri,richText:this.#zi}=this.#mi),this.#mi=null,this.#Bi?.remove(),this.#Bi=null,this.#C=null)}#qi(){if(null!==this.#C)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:s}}}=this.#Fi;let r=!!this.#Oi,a=r?this.#Oi:this.#Hi;for(const t of this.#Di)if(!a||null!==As.intersect(t.data.rect,a)){a=t.data.rect,r=!0;break}const o=As.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),l=r?a[2]-a[0]+5:0,c=o[0]+l,d=o[1];this.#C=[100*(c-i)/e,100*(d-s)/n];const{style:h}=this.#ut;h.left=`${this.#C[0]}%`,h.top=`${this.#C[1]}%`}#Pi(){this.#Ni=!this.#Ni,this.#Ni?(this.#ki(),this.#ut.addEventListener("click",this.#Mi),this.#ut.addEventListener("keydown",this.#Si)):(this.#Ci(),this.#ut.removeEventListener("click",this.#Mi),this.#ut.removeEventListener("keydown",this.#Si))}#ki(){this.#Bi||this.render(),this.isVisible?this.#Ni&&this.#ut.classList.add("focused"):(this.#qi(),this.#ut.hidden=!1,this.#ut.style.zIndex=parseInt(this.#ut.style.zIndex)+1e3)}#Ci(){this.#ut.classList.remove("focused"),!this.#Ni&&this.isVisible&&(this.#ut.hidden=!0,this.#ut.style.zIndex=parseInt(this.#ut.style.zIndex)-1e3)}forceHide(){this.#ji=this.isVisible,this.#ji&&(this.#ut.hidden=!0)}maybeShow(){this.#ji&&(this.#Bi||this.#ki(),this.#ji=!1,this.#ut.hidden=!1)}get isVisible(){return!1===this.#ut.hidden}}class wo extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Gi.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Ao extends oo{#Xi=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:n}=ro(t.rect),i=this.svgFactory.create(e,n,!0),s=this.#Xi=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Xi}addHighlightArea(){this.container.classList.add("highlightArea")}}class xo extends oo{#Ki=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:n}=ro(t.rect),i=this.svgFactory.create(e,n,!0),s=t.borderStyle.width,r=this.#Ki=this.svgFactory.createElement("svg:rect");return r.setAttribute("x",s/2),r.setAttribute("y",s/2),r.setAttribute("width",e-s),r.setAttribute("height",n-s),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Ki}addHighlightArea(){this.container.classList.add("highlightArea")}}class So extends oo{#Yi=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:n}=ro(t.rect),i=this.svgFactory.create(e,n,!0),s=t.borderStyle.width,r=this.#Yi=this.svgFactory.createElement("svg:ellipse");return r.setAttribute("cx",e/2),r.setAttribute("cy",n/2),r.setAttribute("rx",e/2-s/2),r.setAttribute("ry",n/2-s/2),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Yi}addHighlightArea(){this.container.classList.add("highlightArea")}}class _o extends oo{#Ji=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:i}}=this;if(!e)return this.container;const{width:s,height:r}=ro(t),a=this.svgFactory.create(s,r,!0);let o=[];for(let n=0,i=e.length;n<i;n+=2){const i=e[n]-t[0],s=t[3]-e[n+1];o.push(`${i},${s}`)}o=o.join(" ");const l=this.#Ji=this.svgFactory.createElement(this.svgElementName);return l.setAttribute("points",o),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Ji}addHighlightArea(){this.container.classList.add("highlightArea")}}class Eo extends _o{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Co extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class To extends oo{#Qi=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?Gi.HIGHLIGHT:Gi.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,inkLists:e,borderStyle:n,popupRef:i}}=this,{width:s,height:r}=ro(t),a=this.svgFactory.create(s,r,!0);for(const i of e){let e=[];for(let n=0,s=i.length;n<s;n+=2){const s=i[n]-t[0],r=t[3]-i[n+1];e.push(`${s},${r}`)}e=e.join(" ");const s=this.svgFactory.createElement(this.svgElementName);this.#Qi.push(s),s.setAttribute("points",e),s.setAttribute("stroke-width",n.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),a.append(s)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(a),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#Qi}addHighlightArea(){this.container.classList.add("highlightArea")}}class ko extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Gi.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Mo extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Po extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Io extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ro extends oo{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Gi.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Lo extends oo{#Zi=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||0===e.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(100*e.fillAlpha)}%);`)),n.addEventListener("dblclick",this.#ts.bind(this)),this.#Zi=n;const{isMac:i}=ys.platform;return t.addEventListener("keydown",(t=>{"Enter"===t.key&&(i?t.metaKey:t.ctrlKey)&&this.#ts()})),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#Zi}addHighlightArea(){this.container.classList.add("highlightArea")}#ts(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Do{#es=null;#ns=null;#is=new Map;#ss=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:r,structTreeLayer:a}){this.div=t,this.#es=e,this.#ns=n,this.#ss=a||null,this.page=s,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#is.size>0}async#rs(t,e){const n=t.firstChild||t,i=n.id=`${Es}${e}`,s=await(this.#ss?.getAriaAttributes(i));if(s)for(const[t,e]of s)n.setAttribute(t,e);this.div.append(t),this.#es?.moveElementInDOM(this.div,t,n,!1)}async render(t){const{annotations:e}=t,n=this.div;Us(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new eo,annotationStorage:t.annotationStorage||new cr,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const t of e){if(t.noHTML)continue;const e=16===t.annotationType;if(e){const e=i.get(t.id);if(!e)continue;s.elements=e}else{const{width:e,height:n}=ro(t.rect);if(e<=0||n<=0)continue}s.data=t;const n=ao.create(s);if(!n.isRenderable)continue;if(!e&&t.popupRef){const e=i.get(t.popupRef);e?e.push(n):i.set(t.popupRef,[n])}const r=n.render();t.hidden&&(r.style.visibility="hidden"),await this.#rs(r,t.id),n._isEditable&&(this.#is.set(n.data.id,n),this._annotationEditorUIManager?.renderAnnotationElement(n))}this.#as()}update({viewport:t}){const e=this.div;this.viewport=t,Us(e,{rotation:t.rotation}),this.#as(),e.hidden=!1}#as(){if(!this.#ns)return;const t=this.div;for(const[e,n]of this.#ns){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:s}=i;s?"CANVAS"===s.nodeName?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):i.append(n)}this.#ns.clear()}getEditableAnnotations(){return Array.from(this.#is.values())}getEditableAnnotation(t){return this.#is.get(t)}}const Fo=/\r\n?|\n/g;class Oo extends nr{#Ii;#os="";#ls=`${this.id}-editor`;#cs=null;#Ui;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Oo.prototype,e=t=>t.isEmpty(),n=tr.TRANSLATE_SMALL,i=tr.TRANSLATE_BIG;return os(this,"_keyboardManager",new Qs([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=Gi.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#Ii=t.color||Oo._defaultColor||nr._defaultLineColor,this.#Ui=t.fontSize||Oo._defaultFontSize}static initialize(t,e){nr.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case qi.FREETEXT_SIZE:Oo._defaultFontSize=e;break;case qi.FREETEXT_COLOR:Oo._defaultColor=e}}updateParams(t,e){switch(t){case qi.FREETEXT_SIZE:this.#ds(e);break;case qi.FREETEXT_COLOR:this.#hs(e)}}static get defaultPropertiesToUpdate(){return[[qi.FREETEXT_SIZE,Oo._defaultFontSize],[qi.FREETEXT_COLOR,Oo._defaultColor||nr._defaultLineColor]]}get propertiesToUpdate(){return[[qi.FREETEXT_SIZE,this.#Ui],[qi.FREETEXT_COLOR,this.#Ii]]}#ds(t){const e=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--scale-factor))`,this.translate(0,-(t-this.#Ui)*this.parentScale),this.#Ui=t,this.#us()},n=this.#Ui;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#hs(t){const e=t=>{this.#Ii=this.editorDiv.style.color=t},n=this.#Ii;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Oo._internalPadding*t,-(Oo._internalPadding+this.#Ui)*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Gi.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#cs=new AbortController;const t=this._uiManager.combinedSignal(this.#cs);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#ls),this._isDraggable=!0,this.#cs?.abort(),this.#cs=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#ps(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&"BR"===n.nodeName||(t.push(Oo.#fs(n)),e=n);return t.join("\n")}#us(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,i=e.style.display,s=e.classList.contains("hidden");e.classList.remove("hidden"),e.style.display="hidden",t.div.append(this.div),n=e.getBoundingClientRect(),e.remove(),e.style.display=i,e.classList.toggle("hidden",s)}this.rotation%180==this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#os,e=this.#os=this.#ps().trimEnd();if(t===e)return;const n=t=>{this.#os=t,t?(this.#gs(),this._uiManager.rebuild(this),this.#us()):this.remove()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#us()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Oo._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#ls),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#Ui}px * var(--scale-factor))`,n.color=this.#Ii,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Xs(this,this.div,["dblclick","keydown"]),this.width){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this._initialData;let[r,a]=this.getInitialTranslation();[r,a]=this.pageTranslationToScreen(r,a);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let h,u;switch(this.rotation){case 0:h=t+(s[0]-c)/o,u=e+this.height-(s[1]-d)/l;break;case 90:h=t+(s[0]-c)/o,u=e-(s[1]-d)/l,[r,a]=[a,-r];break;case 180:h=t-this.width+(s[0]-c)/o,u=e-(s[1]-d)/l,[r,a]=[-r,-a];break;case 270:h=t+(s[0]-c-this.height*l)/o,u=e+(s[1]-d-this.width*o)/l,[r,a]=[-a,r]}this.setAt(h*n,u*i,r,a)}else this.setAt(t*n,e*i,this.width*n,this.height*i);this.#gs(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#fs(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Fo,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(1===n.length&&"text/plain"===n[0])return;t.preventDefault();const i=Oo.#ms(e.getData("text")||"").replaceAll(Fo,"\n");if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const r=s.getRangeAt(0);if(!i.includes("\n"))return r.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void s.collapseToStart();const{startContainer:a,startOffset:o}=r,l=[],c=[];if(a.nodeType===Node.TEXT_NODE){const t=a.parentElement;if(c.push(a.nodeValue.slice(o).replaceAll(Fo,"")),t!==this.editorDiv){let e=l;for(const n of this.editorDiv.childNodes)n!==t?e.push(Oo.#fs(n)):e=c}l.push(a.nodeValue.slice(0,o).replaceAll(Fo,""))}else if(a===this.editorDiv){let t=l,e=0;for(const n of this.editorDiv.childNodes)e++===o&&(t=c),t.push(Oo.#fs(n))}this.#os=`${l.join("\n")}${i}${c.join("\n")}`,this.#gs();const d=new Range;let h=l.reduce(((t,e)=>t+e.length),0);for(const{firstChild:t}of this.editorDiv.childNodes)if(t.nodeType===Node.TEXT_NODE){const e=t.nodeValue.length;if(h<=e){d.setStart(t,h),d.setEnd(t,h);break}h-=e}s.removeAllRanges(),s.addRange(d)}#gs(){if(this.editorDiv.replaceChildren(),this.#os)for(const t of this.#os.split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#bs(){return this.#os.replaceAll(" "," ")}static#ms(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,n){let i=null;if(t instanceof wo){const{data:{defaultAppearanceData:{fontSize:e,fontColor:n},rect:s,rotation:r,id:a,popupRef:o},textContent:l,textPosition:c,parent:{page:{pageNumber:d}}}=t;if(!l||0===l.length)return null;i=t={annotationType:Gi.FREETEXT,color:Array.from(n),fontSize:e,value:l.join("\n"),position:c,pageIndex:d-1,rect:s.slice(0),rotation:r,id:a,deleted:!1,popupRef:o}}const s=await super.deserialize(t,e,n);return s.#Ui=t.fontSize,s.#Ii=As.makeHexColor(...t.color),s.#os=Oo.#ms(t.value),s.annotationElementId=t.id||null,s._initialData=i,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Oo._internalPadding*this.parentScale,n=this.getRect(e,e),i=nr._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#Ii),s={annotationType:Gi.FREETEXT,color:i,fontSize:this.#Ui,value:this.#bs(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?s:this.annotationElementId&&!this.#vs(s)?null:(s.id=this.annotationElementId,s)}#vs(t){const{value:e,fontSize:n,color:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some(((t,e)=>t!==i[e]))||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:n}=e;n.fontSize=`calc(${this.#Ui}px * var(--scale-factor))`,n.color=this.#Ii,e.replaceChildren();for(const t of this.#os.split("\n")){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),e.append(n)}const i=Oo._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:this.#os}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class No{toSVGPath(){ss("Abstract method `toSVGPath` must be implemented.")}get box(){ss("Abstract getter `box` must be implemented.")}serialize(t,e){ss("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){ss("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){ss("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}class Bo{#ys;#ws=[];#As;#xs;#Ss=[];#_s=new Float64Array(18);#Es;#Cs;#Ts;#ks;#Ms;#Ps;#Is=[];static#Rs=8;static#Ls=2;static#Ds=Bo.#Rs+Bo.#Ls;constructor({x:t,y:e},n,i,s,r,a=0){this.#ys=n,this.#Ps=s*i,this.#xs=r,this.#_s.set([NaN,NaN,NaN,NaN,t,e],6),this.#As=a,this.#ks=Bo.#Rs*i,this.#Ts=Bo.#Ds*i,this.#Ms=i,this.#Is.push(t,e)}isEmpty(){return isNaN(this.#_s[8])}#Fs(){const t=this.#_s.subarray(4,6),e=this.#_s.subarray(16,18),[n,i,s,r]=this.#ys;return[(this.#Es+(t[0]-e[0])/2-n)/s,(this.#Cs+(t[1]-e[1])/2-i)/r,(this.#Es+(e[0]-t[0])/2-n)/s,(this.#Cs+(e[1]-t[1])/2-i)/r]}add({x:t,y:e}){this.#Es=t,this.#Cs=e;const[n,i,s,r]=this.#ys;let[a,o,l,c]=this.#_s.subarray(8,12);const d=t-l,h=e-c,u=Math.hypot(d,h);if(u<this.#Ts)return!1;const p=u-this.#ks,f=p/u,g=f*d,m=f*h;let b=a,v=o;a=l,o=c,l+=g,c+=m,this.#Is?.push(t,e);const y=g/p,w=-m/p*this.#Ps,A=y*this.#Ps;return this.#_s.set(this.#_s.subarray(2,8),0),this.#_s.set([l+w,c+A],4),this.#_s.set(this.#_s.subarray(14,18),12),this.#_s.set([l-w,c-A],16),isNaN(this.#_s[6])?(0===this.#Ss.length&&(this.#_s.set([a+w,o+A],2),this.#Ss.push(NaN,NaN,NaN,NaN,(a+w-n)/s,(o+A-i)/r),this.#_s.set([a-w,o-A],14),this.#ws.push(NaN,NaN,NaN,NaN,(a-w-n)/s,(o-A-i)/r)),this.#_s.set([b,v,a,o,l,c],6),!this.isEmpty()):(this.#_s.set([b,v,a,o,l,c],6),Math.abs(Math.atan2(v-o,b-a)-Math.atan2(m,g))<Math.PI/2?([a,o,l,c]=this.#_s.subarray(2,6),this.#Ss.push(NaN,NaN,NaN,NaN,((a+l)/2-n)/s,((o+c)/2-i)/r),[a,o,b,v]=this.#_s.subarray(14,18),this.#ws.push(NaN,NaN,NaN,NaN,((b+a)/2-n)/s,((v+o)/2-i)/r),!0):([b,v,a,o,l,c]=this.#_s.subarray(0,6),this.#Ss.push(((b+5*a)/6-n)/s,((v+5*o)/6-i)/r,((5*a+l)/6-n)/s,((5*o+c)/6-i)/r,((a+l)/2-n)/s,((o+c)/2-i)/r),[l,c,a,o,b,v]=this.#_s.subarray(12,18),this.#ws.push(((b+5*a)/6-n)/s,((v+5*o)/6-i)/r,((5*a+l)/6-n)/s,((5*o+c)/6-i)/r,((a+l)/2-n)/s,((o+c)/2-i)/r),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#Ss,e=this.#ws;if(isNaN(this.#_s[6])&&!this.isEmpty())return this.#Os();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let e=6;e<t.length;e+=6)isNaN(t[e])?n.push(`L${t[e+4]} ${t[e+5]}`):n.push(`C${t[e]} ${t[e+1]} ${t[e+2]} ${t[e+3]} ${t[e+4]} ${t[e+5]}`);this.#Ns(n);for(let t=e.length-6;t>=6;t-=6)isNaN(e[t])?n.push(`L${e[t+4]} ${e[t+5]}`):n.push(`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`);return this.#Bs(n),n.join(" ")}#Os(){const[t,e,n,i]=this.#ys,[s,r,a,o]=this.#Fs();return`M${(this.#_s[2]-t)/n} ${(this.#_s[3]-e)/i} L${(this.#_s[4]-t)/n} ${(this.#_s[5]-e)/i} L${s} ${r} L${a} ${o} L${(this.#_s[16]-t)/n} ${(this.#_s[17]-e)/i} L${(this.#_s[14]-t)/n} ${(this.#_s[15]-e)/i} Z`}#Bs(t){const e=this.#ws;t.push(`L${e[4]} ${e[5]} Z`)}#Ns(t){const[e,n,i,s]=this.#ys,r=this.#_s.subarray(4,6),a=this.#_s.subarray(16,18),[o,l,c,d]=this.#Fs();t.push(`L${(r[0]-e)/i} ${(r[1]-n)/s} L${o} ${l} L${c} ${d} L${(a[0]-e)/i} ${(a[1]-n)/s}`)}newFreeDrawOutline(t,e,n,i,s,r){return new Ho(t,e,n,i,s,r)}getOutlines(){const t=this.#Ss,e=this.#ws,n=this.#_s,[i,s,r,a]=this.#ys,o=new Float64Array((this.#Is?.length??0)+2);for(let t=0,e=o.length-2;t<e;t+=2)o[t]=(this.#Is[t]-i)/r,o[t+1]=(this.#Is[t+1]-s)/a;if(o[o.length-2]=(this.#Es-i)/r,o[o.length-1]=(this.#Cs-s)/a,isNaN(n[6])&&!this.isEmpty())return this.#Hs(o);const l=new Float64Array(this.#Ss.length+24+this.#ws.length);let c=t.length;for(let e=0;e<c;e+=2)isNaN(t[e])?l[e]=l[e+1]=NaN:(l[e]=t[e],l[e+1]=t[e+1]);c=this.#zs(l,c);for(let t=e.length-6;t>=6;t-=6)for(let n=0;n<6;n+=2)isNaN(e[t+n])?(l[c]=l[c+1]=NaN,c+=2):(l[c]=e[t+n],l[c+1]=e[t+n+1],c+=2);return this.#Vs(l,c),this.newFreeDrawOutline(l,o,this.#ys,this.#Ms,this.#As,this.#xs)}#Hs(t){const e=this.#_s,[n,i,s,r]=this.#ys,[a,o,l,c]=this.#Fs(),d=new Float64Array(36);return d.set([NaN,NaN,NaN,NaN,(e[2]-n)/s,(e[3]-i)/r,NaN,NaN,NaN,NaN,(e[4]-n)/s,(e[5]-i)/r,NaN,NaN,NaN,NaN,a,o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(e[16]-n)/s,(e[17]-i)/r,NaN,NaN,NaN,NaN,(e[14]-n)/s,(e[15]-i)/r],0),this.newFreeDrawOutline(d,t,this.#ys,this.#Ms,this.#As,this.#xs)}#Vs(t,e){const n=this.#ws;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+6}#zs(t,e){const n=this.#_s.subarray(4,6),i=this.#_s.subarray(16,18),[s,r,a,o]=this.#ys,[l,c,d,h]=this.#Fs();return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/a,(n[1]-r)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-r)/o],e),e+24}}class Ho extends No{#ys;#js=null;#As;#xs;#Is;#Ms;#$s;constructor(t,e,n,i,s,r){super(),this.#$s=t,this.#Is=e,this.#ys=n,this.#Ms=i,this.#As=s,this.#xs=r,this.#Us(r);const{x:a,y:o,width:l,height:c}=this.#js;for(let e=0,n=t.length;e<n;e+=2)t[e]=(t[e]-a)/l,t[e+1]=(t[e+1]-o)/c;for(let t=0,n=e.length;t<n;t+=2)e[t]=(e[t]-a)/l,e[t+1]=(e[t+1]-o)/c}toSVGPath(){const t=[`M${this.#$s[4]} ${this.#$s[5]}`];for(let e=6,n=this.#$s.length;e<n;e+=6)isNaN(this.#$s[e])?t.push(`L${this.#$s[e+4]} ${this.#$s[e+5]}`):t.push(`C${this.#$s[e]} ${this.#$s[e+1]} ${this.#$s[e+2]} ${this.#$s[e+3]} ${this.#$s[e+4]} ${this.#$s[e+5]}`);return t.push("Z"),t.join(" ")}serialize([t,e,n,i],s){const r=n-t,a=i-e;let o,l;switch(s){case 0:o=this.#Ws(this.#$s,t,i,r,-a),l=this.#Ws(this.#Is,t,i,r,-a);break;case 90:o=this.#Gs(this.#$s,t,e,r,a),l=this.#Gs(this.#Is,t,e,r,a);break;case 180:o=this.#Ws(this.#$s,n,e,-r,a),l=this.#Ws(this.#Is,n,e,-r,a);break;case 270:o=this.#Gs(this.#$s,n,i,-r,-a),l=this.#Gs(this.#Is,n,i,-r,-a)}return{outline:Array.from(o),points:[Array.from(l)]}}#Ws(t,e,n,i,s){const r=new Float64Array(t.length);for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a]*i,r[a+1]=n+t[a+1]*s;return r}#Gs(t,e,n,i,s){const r=new Float64Array(t.length);for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a+1]*i,r[a+1]=n+t[a]*s;return r}#Us(t){const e=this.#$s;let n=e[4],i=e[5],s=n,r=i,a=n,o=i,l=n,c=i;const d=t?Math.max:Math.min;for(let t=6,h=e.length;t<h;t+=6){if(isNaN(e[t]))s=Math.min(s,e[t+4]),r=Math.min(r,e[t+5]),a=Math.max(a,e[t+4]),o=Math.max(o,e[t+5]),c<e[t+5]?(l=e[t+4],c=e[t+5]):c===e[t+5]&&(l=d(l,e[t+4]));else{const h=As.bezierBoundingBox(n,i,...e.slice(t,t+6));s=Math.min(s,h[0]),r=Math.min(r,h[1]),a=Math.max(a,h[2]),o=Math.max(o,h[3]),c<h[3]?(l=h[2],c=h[3]):c===h[3]&&(l=d(l,h[2]))}n=e[t+4],i=e[t+5]}const h=s-this.#As,u=r-this.#As,p=a-s+2*this.#As,f=o-r+2*this.#As;this.#js={x:h,y:u,width:p,height:f,lastPoint:[l,c]}}get box(){return this.#js}newOutliner(t,e,n,i,s,r=0){return new Bo(t,e,n,i,s,r)}getNewOutline(t,e){const{x:n,y:i,width:s,height:r}=this.#js,[a,o,l,c]=this.#ys,d=s*l,h=r*c,u=n*l+a,p=i*c+o,f=this.newOutliner({x:this.#Is[0]*d+u,y:this.#Is[1]*h+p},this.#ys,this.#Ms,t,this.#xs,e??this.#As);for(let t=2;t<this.#Is.length;t+=2)f.add({x:this.#Is[t]*d+u,y:this.#Is[t+1]*h+p});return f.getOutlines()}get mustRemoveSelfIntersections(){return!0}}class zo{#ys;#qs=[];#Xs=[];constructor(t,e=0,n=0,i=!0){let s=1/0,r=-1/0,a=1/0,o=-1/0;const l=10**-4;for(const{x:n,y:i,width:c,height:d}of t){const t=Math.floor((n-e)/l)*l,h=Math.ceil((n+c+e)/l)*l,u=Math.floor((i-e)/l)*l,p=Math.ceil((i+d+e)/l)*l,f=[t,u,p,!0],g=[h,u,p,!1];this.#qs.push(f,g),s=Math.min(s,t),r=Math.max(r,h),a=Math.min(a,u),o=Math.max(o,p)}const c=r-s+2*n,d=o-a+2*n,h=s-n,u=a-n,p=this.#qs.at(i?-1:-2),f=[p[0],p[2]];for(const t of this.#qs){const[e,n,i]=t;t[0]=(e-h)/c,t[1]=(n-u)/d,t[2]=(i-u)/d}this.#ys={x:h,y:u,width:c,height:d,lastPoint:f}}getOutlines(){this.#qs.sort(((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]));const t=[];for(const e of this.#qs)e[3]?(t.push(...this.#Ks(e)),this.#Ys(e)):(this.#Js(e),t.push(...this.#Ks(e)));return this.#Qs(t)}#Qs(t){const e=[],n=new Set;for(const n of t){const[t,i,s]=n;e.push([t,i,n],[t,s,n])}e.sort(((t,e)=>t[1]-e[1]||t[0]-e[0]));for(let t=0,i=e.length;t<i;t+=2){const i=e[t][2],s=e[t+1][2];i.push(s),s.push(i),n.add(i),n.add(s)}const i=[];let s;for(;n.size>0;){const t=n.values().next().value;let[e,r,a,o,l]=t;n.delete(t);let c=e,d=r;for(s=[e,a],i.push(s);;){let t;if(n.has(o))t=o;else{if(!n.has(l))break;t=l}n.delete(t),[e,r,a,o,l]=t,c!==e&&(s.push(c,d,e,d===r?r:a),c=e),d=d===r?a:r}s.push(c,d)}return new Vo(i,this.#ys)}#Zs(t){const e=this.#Xs;let n=0,i=e.length-1;for(;n<=i;){const s=n+i>>1,r=e[s][0];if(r===t)return s;r<t?n=s+1:i=s-1}return i+1}#Ys([,t,e]){const n=this.#Zs(t);this.#Xs.splice(n,0,[t,e])}#Js([,t,e]){const n=this.#Zs(t);for(let i=n;i<this.#Xs.length;i++){const[n,s]=this.#Xs[i];if(n!==t)break;if(n===t&&s===e)return void this.#Xs.splice(i,1)}for(let i=n-1;i>=0;i--){const[n,s]=this.#Xs[i];if(n!==t)break;if(n===t&&s===e)return void this.#Xs.splice(i,1)}}#Ks(t){const[e,n,i]=t,s=[[e,n,i]],r=this.#Zs(i);for(let t=0;t<r;t++){const[n,i]=this.#Xs[t];for(let t=0,r=s.length;t<r;t++){const[,a,o]=s[t];if(!(i<=a||o<=n))if(a>=n)if(o>i)s[t][1]=i;else{if(1===r)return[];s.splice(t,1),t--,r--}else s[t][2]=n,o>i&&s.push([e,i,o])}}return s}}class Vo extends No{#ys;#tr;constructor(t,e){super(),this.#tr=t,this.#ys=e}toSVGPath(){const t=[];for(const e of this.#tr){let[n,i]=e;t.push(`M${n} ${i}`);for(let s=2;s<e.length;s+=2){const r=e[s],a=e[s+1];r===n?(t.push(`V${a}`),i=a):a===i&&(t.push(`H${r}`),n=r)}t.push("Z")}return t.join(" ")}serialize([t,e,n,i],s){const r=[],a=n-t,o=i-e;for(const e of this.#tr){const n=new Array(e.length);for(let s=0;s<e.length;s+=2)n[s]=t+e[s]*a,n[s+1]=i-e[s+1]*o;r.push(n)}return r}get box(){return this.#ys}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}class jo extends Bo{newFreeDrawOutline(t,e,n,i,s,r){return new $o(t,e,n,i,s,r)}get classNamesForDrawing(){return["highlight","free"]}}class $o extends Ho{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,e,n,i,s,r=0){return new jo(t,e,n,i,s,r)}}class Uo{#er=null;#nr=null;#ir;#sr=null;#rr=!1;#ar=!1;#r=null;#or;#lr=null;#g=null;#cr;static#dr=null;static get _keyboardManager(){return os(this,"_keyboardManager",new Qs([[["Escape","mac+Escape"],Uo.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Uo.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Uo.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Uo.prototype._moveToPrevious],[["Home","mac+Home"],Uo.prototype._moveToBeginning],[["End","mac+End"],Uo.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#ar=!1,this.#cr=qi.HIGHLIGHT_COLOR,this.#r=t):(this.#ar=!0,this.#cr=qi.HIGHLIGHT_DEFAULT_COLOR),this.#g=t?._uiManager||e,this.#or=this.#g._eventBus,this.#ir=t?.color||this.#g?.highlightColors.values().next().value||"#FFFF98",Uo.#dr||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#er=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#g._signal;t.addEventListener("click",this.#hr.bind(this),{signal:e}),t.addEventListener("keydown",this.#_i.bind(this),{signal:e});const n=this.#nr=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#ir,t.append(n),t}renderMainDropdown(){const t=this.#sr=this.#ur();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#ur(){const t=document.createElement("div"),e=this.#g._signal;t.addEventListener("contextmenu",Ns,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of this.#g.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",Uo.#dr[n]);const r=document.createElement("span");s.append(r),r.className="swatch",r.style.backgroundColor=i,s.setAttribute("aria-selected",i===this.#ir),s.addEventListener("click",this.#pr.bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",this.#_i.bind(this),{signal:e}),t}#pr(t,e){e.stopPropagation(),this.#or.dispatch("switchannotationeditorparams",{source:this,type:this.#cr,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#er)return void this.#hr(t);const e=t.target.getAttribute("data-color");e&&this.#pr(e,t)}_moveToNext(t){this.#fr?t.target!==this.#er?t.target.nextSibling?.focus():this.#sr.firstChild?.focus():this.#hr(t)}_moveToPrevious(t){t.target!==this.#sr?.firstChild&&t.target!==this.#er?(this.#fr||this.#hr(t),t.target.previousSibling?.focus()):this.#fr&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){this.#fr?this.#sr.firstChild?.focus():this.#hr(t)}_moveToEnd(t){this.#fr?this.#sr.lastChild?.focus():this.#hr(t)}#_i(t){Uo._keyboardManager.exec(this,t)}#hr(t){if(this.#fr)return void this.hideDropdown();if(this.#rr=0===t.detail,this.#lr||(this.#lr=new AbortController,window.addEventListener("pointerdown",this.#c.bind(this),{signal:this.#g.combinedSignal(this.#lr)})),this.#sr)return void this.#sr.classList.remove("hidden");const e=this.#sr=this.#ur();this.#er.append(e)}#c(t){this.#sr?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#sr?.classList.add("hidden"),this.#lr?.abort(),this.#lr=null}get#fr(){return this.#sr&&!this.#sr.classList.contains("hidden")}_hideDropdownFromKeyboard(){this.#ar||(this.#fr?(this.hideDropdown(),this.#er.focus({preventScroll:!0,focusVisible:this.#rr})):this.#r?.unselect())}updateColor(t){if(this.#nr&&(this.#nr.style.backgroundColor=t),!this.#sr)return;const e=this.#g.highlightColors.values();for(const n of this.#sr.children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#er?.remove(),this.#er=null,this.#nr=null,this.#sr?.remove(),this.#sr=null}}class Wo extends nr{#gr=null;#mr=0;#br;#vr=null;#s=null;#yr=null;#wr=null;#Ar=0;#xr=null;#Sr=null;#y=null;#_r=!1;#Er=null;#Cr;#Tr=null;#kr="";#Ps;#Mr="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Gi.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Wo.prototype;return os(this,"_keyboardManager",new Qs([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Wo._defaultColor,this.#Ps=t.thickness||Wo._defaultThickness,this.#Cr=t.opacity||Wo._defaultOpacity,this.#br=t.boxes||null,this.#Mr=t.methodOfCreation||"",this.#kr=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#_r=!0,this.#Pr(t),this.#Ir()):this.#br&&(this.#gr=t.anchorNode,this.#mr=t.anchorOffset,this.#wr=t.focusNode,this.#Ar=t.focusOffset,this.#Rr(),this.#Ir(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#_r?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#Ps,methodOfCreation:this.#Mr}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#Rr(){const t=new zo(this.#br,.001);this.#Sr=t.getOutlines(),({x:this.x,y:this.y,width:this.width,height:this.height}=this.#Sr.box);const e=new zo(this.#br,.0025,.001,"ltr"===this._uiManager.direction);this.#yr=e.getOutlines();const{lastPoint:n}=this.#yr.box;this.#Er=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#Pr({highlightOutlines:t,highlightId:e,clipPathId:n}){if(this.#Sr=t,this.#yr=t.getNewOutline(this.#Ps/2+1.5,.0025),e>=0)this.#y=e,this.#vr=n,this.parent.drawLayer.finalizeLine(e,t),this.#Tr=this.parent.drawLayer.drawOutline(this.#yr);else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#y,t),this.parent.drawLayer.updateBox(this.#y,Wo.#Lr(this.#Sr.box,(e-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#Tr,this.#yr),this.parent.drawLayer.updateBox(this.#Tr,Wo.#Lr(this.#yr.box,e))}const{x:i,y:s,width:r,height:a}=t.box;switch(this.rotation){case 0:this.x=i,this.y=s,this.width=r,this.height=a;break;case 90:{const[t,e]=this.parentDimensions;this.x=s,this.y=1-i,this.width=r*e/t,this.height=a*t/e;break}case 180:this.x=1-i,this.y=1-s,this.width=r,this.height=a;break;case 270:{const[t,e]=this.parentDimensions;this.x=1-s,this.y=i,this.width=r*e/t,this.height=a*t/e;break}}const{lastPoint:o}=this.#yr.box;this.#Er=[(o[0]-i)/r,(o[1]-s)/a]}static initialize(t,e){nr.initialize(t,e),Wo._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case qi.HIGHLIGHT_DEFAULT_COLOR:Wo._defaultColor=e;break;case qi.HIGHLIGHT_THICKNESS:Wo._defaultThickness=e}}translateInPage(t,e){}get toolbarPosition(){return this.#Er}updateParams(t,e){switch(t){case qi.HIGHLIGHT_COLOR:this.#hs(e);break;case qi.HIGHLIGHT_THICKNESS:this.#Dr(e)}}static get defaultPropertiesToUpdate(){return[[qi.HIGHLIGHT_DEFAULT_COLOR,Wo._defaultColor],[qi.HIGHLIGHT_THICKNESS,Wo._defaultThickness]]}get propertiesToUpdate(){return[[qi.HIGHLIGHT_COLOR,this.color||Wo._defaultColor],[qi.HIGHLIGHT_THICKNESS,this.#Ps||Wo._defaultThickness],[qi.HIGHLIGHT_FREE,this.#_r]]}#hs(t){const e=(t,e)=>{this.color=t,this.parent?.drawLayer.changeColor(this.#y,t),this.#s?.updateColor(t),this.#Cr=e,this.parent?.drawLayer.changeOpacity(this.#y,e)},n=this.color,i=this.#Cr;this.addCommands({cmd:e.bind(this,t,Wo._defaultOpacity),undo:e.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#Dr(t){const e=this.#Ps,n=t=>{this.#Ps=t,this.#Fr(t)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#s=new Uo({editor:this}),t.addColorPicker(this.#s)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#Or())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#Or())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#Nr(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#Ir(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#Nr():t&&(this.#Ir(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#Fr(t){if(!this.#_r)return;this.#Pr({highlightOutlines:this.#Sr.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#Nr(){null!==this.#y&&this.parent&&(this.parent.drawLayer.remove(this.#y),this.#y=null,this.parent.drawLayer.remove(this.#Tr),this.#Tr=null)}#Ir(t=this.parent){null===this.#y&&(({id:this.#y,clipPathId:this.#vr}=t.drawLayer.draw(this.#Sr,this.color,this.#Cr)),this.#Tr=t.drawLayer.drawOutline(this.#yr),this.#xr&&(this.#xr.style.clipPath=this.#vr))}static#Lr({x:t,y:e,width:n,height:i},s){switch(s){case 90:return{x:1-e-i,y:t,width:i,height:n};case 180:return{x:1-t-n,y:1-e-i,width:n,height:i};case 270:return{x:e,y:1-t-n,width:i,height:n}}return{x:t,y:e,width:n,height:i}}rotate(t){const{drawLayer:e}=this.parent;let n;this.#_r?(t=(t-this.rotation+360)%360,n=Wo.#Lr(this.#Sr.box,t)):n=Wo.#Lr(this,t),e.rotate(this.#y,t),e.rotate(this.#Tr,t),e.updateBox(this.#y,n),e.updateBox(this.#Tr,Wo.#Lr(this.#yr.box,t))}render(){if(this.div)return this.div;const t=super.render();this.#kr&&(t.setAttribute("aria-label",this.#kr),t.setAttribute("role","mark")),this.#_r?t.classList.add("free"):this.div.addEventListener("keydown",this.#Br.bind(this),{signal:this._uiManager._signal});const e=this.#xr=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#vr;const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),Xs(this,this.#xr,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#Tr,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#Tr,"hovered")}#Br(t){Wo._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#Hr(!0);break;case 1:case 3:this.#Hr(!1)}}#Hr(t){if(!this.#gr)return;const e=window.getSelection();t?e.setPosition(this.#gr,this.#mr):e.setPosition(this.#wr,this.#Ar)}select(){super.select(),this.#Tr&&(this.parent?.drawLayer.removeClass(this.#Tr,"hovered"),this.parent?.drawLayer.addClass(this.#Tr,"selected"))}unselect(){super.unselect(),this.#Tr&&(this.parent?.drawLayer.removeClass(this.#Tr,"selected"),this.#_r||this.#Hr(!1))}get _mustFixPosition(){return!this.#_r}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(this.#y,t),this.parent.drawLayer.show(this.#Tr,t))}#Or(){return this.#_r?this.rotation:0}#zr(){if(this.#_r)return null;const[t,e]=this.pageDimensions,[n,i]=this.pageTranslation,s=this.#br,r=new Float32Array(8*s.length);let a=0;for(const{x:o,y:l,width:c,height:d}of s){const s=o*t+n,h=(1-l-d)*e+i;r[a]=r[a+4]=s,r[a+1]=r[a+3]=h,r[a+2]=r[a+6]=s+c*t,r[a+5]=r[a+7]=h+d*e,a+=8}return r}#Vr(t){return this.#Sr.serialize(t,this.#Or())}static startHighlighting(t,e,{target:n,x:i,y:s}){const{x:r,y:a,width:o,height:l}=n.getBoundingClientRect(),c=new AbortController,d=t.combinedSignal(c),h=e=>{c.abort(),this.#jr(t,e)};window.addEventListener("blur",h,{signal:d}),window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("pointerdown",(t=>{t.preventDefault(),t.stopPropagation()}),{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",Ns,{signal:d}),n.addEventListener("pointermove",this.#$r.bind(this,t),{signal:d}),this._freeHighlight=new jo({x:i,y:s},[r,a,o,l],t.scale,this._defaultThickness/2,e,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0))}static#$r(t,e){this._freeHighlight.add(e)&&t.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#jr(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let i=null;if(t instanceof ko){const{data:{quadPoints:e,rect:n,rotation:s,id:r,color:a,opacity:o,popupRef:l},parent:{page:{pageNumber:c}}}=t;i=t={annotationType:Gi.HIGHLIGHT,color:Array.from(a),opacity:o,quadPoints:e,boxes:null,pageIndex:c-1,rect:n.slice(0),rotation:s,id:r,deleted:!1,popupRef:l}}else if(t instanceof To){const{data:{inkLists:e,rect:n,rotation:s,id:r,color:a,borderStyle:{rawWidth:o},popupRef:l},parent:{page:{pageNumber:c}}}=t;i=t={annotationType:Gi.HIGHLIGHT,color:Array.from(a),thickness:o,inkLists:e,boxes:null,pageIndex:c-1,rect:n.slice(0),rotation:s,id:r,deleted:!1,popupRef:l}}const{color:s,quadPoints:r,inkLists:a,opacity:o}=t,l=await super.deserialize(t,e,n);l.color=As.makeHexColor(...s),l.#Cr=o||1,a&&(l.#Ps=t.thickness),l.annotationElementId=t.id||null,l._initialData=i;const[c,d]=l.pageDimensions,[h,u]=l.pageTranslation;if(r){const t=l.#br=[];for(let e=0;e<r.length;e+=8)t.push({x:(r[e]-h)/c,y:1-(r[e+1]-u)/d,width:(r[e+2]-r[e])/c,height:(r[e+1]-r[e+5])/d});l.#Rr(),l.#Ir(),l.rotate(l.rotation)}else if(a){l.#_r=!0;const t=a[0],n={x:t[0]-h,y:d-(t[1]-u)},i=new jo(n,[0,0,c,d],1,l.#Ps/2,!0,.001);for(let e=0,s=t.length;e<s;e+=2)n.x=t[e]-h,n.y=d-(t[e+1]-u),i.add(n);const{id:s,clipPathId:r}=e.drawLayer.draw(i,l.color,l._defaultOpacity,!0);l.#Pr({highlightOutlines:i.getOutlines(),highlightId:s,clipPathId:r}),l.#Ir()}return l}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),n=nr._colorManager.convert(this.color),i={annotationType:Gi.HIGHLIGHT,color:n,opacity:this.#Cr,thickness:this.#Ps,quadPoints:this.#zr(),outlines:this.#Vr(e),pageIndex:this.pageIndex,rect:e,rotation:this.#Or(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#vs(i)?null:(i.id=this.annotationElementId,i)}#vs(t){const{color:e}=this._initialData;return t.color.some(((t,n)=>t!==e[n]))}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Go extends nr{#Ur=0;#Wr=0;#Gr=null;#qr=new Path2D;#Xr=!1;#Kr=null;#Yr=!1;#Jr=!1;#Qr=null;#Zr=null;#ta=0;#ea=0;#na=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=Gi.INK;constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,e){nr.initialize(t,e)}static updateDefaultParams(t,e){switch(t){case qi.INK_THICKNESS:Go._defaultThickness=e;break;case qi.INK_COLOR:Go._defaultColor=e;break;case qi.INK_OPACITY:Go._defaultOpacity=e/100}}updateParams(t,e){switch(t){case qi.INK_THICKNESS:this.#Dr(e);break;case qi.INK_COLOR:this.#hs(e);break;case qi.INK_OPACITY:this.#ia(e)}}static get defaultPropertiesToUpdate(){return[[qi.INK_THICKNESS,Go._defaultThickness],[qi.INK_COLOR,Go._defaultColor||nr._defaultLineColor],[qi.INK_OPACITY,Math.round(100*Go._defaultOpacity)]]}get propertiesToUpdate(){return[[qi.INK_THICKNESS,this.thickness||Go._defaultThickness],[qi.INK_COLOR,this.color||Go._defaultColor||nr._defaultLineColor],[qi.INK_OPACITY,Math.round(100*(this.opacity??Go._defaultOpacity))]]}#Dr(t){const e=t=>{this.thickness=t,this.#sa()},n=this.thickness;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#hs(t){const e=t=>{this.color=t,this.#ra()},n=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#ia(t){const e=t=>{this.opacity=t,this.#ra()};t/=100;const n=this.opacity;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qi.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(this.#aa(),this.#oa()),this.isAttachedToDOM||(this.parent.add(this),this.#la()),this.#sa()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#Gr&&(clearTimeout(this.#Gr),this.#Gr=null),this.#Qr?.disconnect(),this.#Qr=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&null===t&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,n=this.width*t,i=this.height*e;this.setDimensions(n,i)}enableEditMode(){this.#Xr||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.#ca())}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#da())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#ha(){const{parentRotation:t,parentDimensions:[e,n]}=this;switch(t){case 90:return[0,n,n,e];case 180:return[e,n,e,n];case 270:return[e,0,n,e];default:return[0,0,e,n]}}#ua(){const{ctx:t,color:e,opacity:n,thickness:i,parentScale:s,scaleFactor:r}=this;t.lineWidth=i*s/r,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${e}${function(t){return Math.round(Math.min(255,Math.max(1,255*t))).toString(16).padStart(2,"0")}(n)}`}#pa(t,e){this.canvas.addEventListener("contextmenu",Ns,{signal:this._uiManager._signal}),this.#da(),this.#Kr=new AbortController;const n=this._uiManager.combinedSignal(this.#Kr);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:n}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:n}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:n}),this.isEditing=!0,this.#Jr||(this.#Jr=!0,this.#la(),this.thickness||=Go._defaultThickness,this.color||=Go._defaultColor||nr._defaultLineColor,this.opacity??=Go._defaultOpacity),this.currentPath.push([t,e]),this.#Yr=!1,this.#ua(),this.#na=()=>{this.#fa(),this.#na&&window.requestAnimationFrame(this.#na)},window.requestAnimationFrame(this.#na)}#ga(t,e){const[n,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===n&&e===i)return;const s=this.currentPath;let r=this.#qr;if(s.push([t,e]),this.#Yr=!0,s.length<=2)return r.moveTo(...s[0]),void r.lineTo(t,e);3===s.length&&(this.#qr=r=new Path2D,r.moveTo(...s[0])),this.#ma(r,...s.at(-3),...s.at(-2),t,e)}#ba(){if(0===this.currentPath.length)return;const t=this.currentPath.at(-1);this.#qr.lineTo(...t)}#va(t,e){let n;if(this.#na=null,t=Math.min(Math.max(t,0),this.canvas.width),e=Math.min(Math.max(e,0),this.canvas.height),this.#ga(t,e),this.#ba(),1!==this.currentPath.length)n=this.#ya();else{const i=[t,e];n=[[i,i.slice(),i.slice(),i]]}const i=this.#qr,s=this.currentPath;this.currentPath=[],this.#qr=new Path2D,this.addCommands({cmd:()=>{this.allRawPaths.push(s),this.paths.push(n),this.bezierPath2D.push(i),this._uiManager.rebuild(this)},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#aa(),this.#oa()),this.#sa())},mustExec:!0})}#fa(){if(!this.#Yr)return;this.#Yr=!1;Math.ceil(this.thickness*this.parentScale);const t=this.currentPath.slice(-3),e=t.map((t=>t[0])),n=t.map((t=>t[1])),{ctx:i}=(Math.min(...e),Math.max(...e),Math.min(...n),Math.max(...n),this);i.save(),i.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.bezierPath2D)i.stroke(t);i.stroke(this.#qr),i.restore()}#ma(t,e,n,i,s,r,a){const o=(e+i)/2,l=(n+s)/2,c=(i+r)/2,d=(s+a)/2;t.bezierCurveTo(o+2*(i-o)/3,l+2*(s-l)/3,c+2*(i-c)/3,d+2*(s-d)/3,c,d)}#ya(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const e=[];let n,[i,s]=t[0];for(n=1;n<t.length-2;n++){const[r,a]=t[n],[o,l]=t[n+1],c=(r+o)/2,d=(a+l)/2,h=[i+2*(r-i)/3,s+2*(a-s)/3],u=[c+2*(r-c)/3,d+2*(a-d)/3];e.push([[i,s],h,u,[c,d]]),[i,s]=[c,d]}const[r,a]=t[n],[o,l]=t[n+1],c=[i+2*(r-i)/3,s+2*(a-s)/3],d=[o+2*(r-o)/3,l+2*(a-l)/3];return e.push([[i,s],c,d,[o,l]]),e}#ra(){if(this.isEmpty())return void this.#wa();this.#ua();const{canvas:t,ctx:e}=this;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),this.#wa();for(const t of this.bezierPath2D)e.stroke(t)}commit(){this.#Xr||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#Xr=!0,this.div.classList.add("disabled"),this.#sa(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}#ca(){if(this.#Zr)return;this.#Zr=new AbortController;const t=this._uiManager.combinedSignal(this.#Zr);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:t})}#da(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(t){0===t.button&&this.isInEditMode()&&!this.#Xr&&(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#pa(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#ga(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#Aa(t)}canvasPointerleave(t){this.#Aa(t)}#Aa(t){this.#Kr?.abort(),this.#Kr=null,this.#ca(),this.#Gr&&clearTimeout(this.#Gr),this.#Gr=setTimeout((()=>{this.#Gr=null,this.canvas.removeEventListener("contextmenu",Ns)}),10),this.#va(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#aa(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#oa(){this.#Qr=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)})),this.#Qr.observe(this.div),this._uiManager._signal.addEventListener("abort",(()=>{this.#Qr?.disconnect(),this.#Qr=null}),{once:!0})}get isResizable(){return!this.isEmpty()&&this.#Xr}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[n,i,s,r]=this.#ha();if(this.setAt(n,i,0,0),this.setDims(s,r),this.#aa(),this.width){const[n,i]=this.parentDimensions;this.setAspectRatio(this.width*n,this.height*i),this.setAt(t*n,e*i,this.width*n,this.height*i),this.#Jr=!0,this.#la(),this.setDims(this.width*n,this.height*i),this.#ra(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#oa(),this.div}#la(){if(!this.#Jr)return;const[t,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*e),this.#wa()}setDimensions(t,e){const n=Math.round(t),i=Math.round(e);if(this.#ta===n&&this.#ea===i)return;this.#ta=n,this.#ea=i,this.canvas.style.visibility="hidden";const[s,r]=this.parentDimensions;this.width=t/s,this.height=e/r,this.fixAndSetPosition(),this.#Xr&&this.#xa(t,e),this.#la(),this.#ra(),this.canvas.style.visibility="visible",this.fixDims()}#xa(t,e){const n=this.#Sa(),i=(t-n)/this.#Wr,s=(e-n)/this.#Ur;this.scaleFactor=Math.min(i,s)}#wa(){const t=this.#Sa()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#_a(t){const e=new Path2D;for(let n=0,i=t.length;n<i;n++){const[i,s,r,a]=t[n];0===n&&e.moveTo(...i),e.bezierCurveTo(s[0],s[1],r[0],r[1],a[0],a[1])}return e}static#Ea(t,e,n){const[i,s,r,a]=e;switch(n){case 0:for(let e=0,n=t.length;e<n;e+=2)t[e]+=i,t[e+1]=a-t[e+1];break;case 90:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=t[e+1]+i,t[e+1]=n+s}break;case 180:for(let e=0,n=t.length;e<n;e+=2)t[e]=r-t[e],t[e+1]+=s;break;case 270:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=r-t[e+1],t[e+1]=a-n}break;default:throw new Error("Invalid rotation")}return t}static#Ca(t,e,n){const[i,s,r,a]=e;switch(n){case 0:for(let e=0,n=t.length;e<n;e+=2)t[e]-=i,t[e+1]=a-t[e+1];break;case 90:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=t[e+1]-s,t[e+1]=n-i}break;case 180:for(let e=0,n=t.length;e<n;e+=2)t[e]=r-t[e],t[e+1]-=s;break;case 270:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=a-t[e+1],t[e+1]=r-n}break;default:throw new Error("Invalid rotation")}return t}#Ta(t,e,n,i){const s=[],r=this.thickness/2,a=t*e+r,o=t*n+r;for(const e of this.paths){const n=[],r=[];for(let i=0,s=e.length;i<s;i++){const[l,c,d,h]=e[i];if(l[0]===h[0]&&l[1]===h[1]&&1===s){const e=t*l[0]+a,i=t*l[1]+o;n.push(e,i),r.push(e,i);break}const u=t*l[0]+a,p=t*l[1]+o,f=t*c[0]+a,g=t*c[1]+o,m=t*d[0]+a,b=t*d[1]+o,v=t*h[0]+a,y=t*h[1]+o;0===i&&(n.push(u,p),r.push(u,p)),n.push(f,g,m,b,v,y),r.push(f,g),i===s-1&&r.push(v,y)}s.push({bezier:Go.#Ea(n,i,this.rotation),points:Go.#Ea(r,i,this.rotation)})}return s}#ka(){let t=1/0,e=-1/0,n=1/0,i=-1/0;for(const s of this.paths)for(const[r,a,o,l]of s){const s=As.bezierBoundingBox(...r,...a,...o,...l);t=Math.min(t,s[0]),n=Math.min(n,s[1]),e=Math.max(e,s[2]),i=Math.max(i,s[3])}return[t,n,e,i]}#Sa(){return this.#Xr?Math.ceil(this.thickness*this.parentScale):0}#sa(t=!1){if(this.isEmpty())return;if(!this.#Xr)return void this.#ra();const e=this.#ka(),n=this.#Sa();this.#Wr=Math.max(nr.MIN_SIZE,e[2]-e[0]),this.#Ur=Math.max(nr.MIN_SIZE,e[3]-e[1]);const i=Math.ceil(n+this.#Wr*this.scaleFactor),s=Math.ceil(n+this.#Ur*this.scaleFactor),[r,a]=this.parentDimensions;this.width=i/r,this.height=s/a,this.setAspectRatio(i,s);const o=this.translationX,l=this.translationY;this.translationX=-e[0],this.translationY=-e[1],this.#la(),this.#ra(),this.#ta=i,this.#ea=s,this.setDims(i,s);const c=t?n/this.scaleFactor/2:0;this.translate(o-this.translationX-c,l-this.translationY-c)}static async deserialize(t,e,n){if(t instanceof To)return null;const i=await super.deserialize(t,e,n);i.thickness=t.thickness,i.color=As.makeHexColor(...t.color),i.opacity=t.opacity;const[s,r]=i.pageDimensions,a=i.width*s,o=i.height*r,l=i.parentScale,c=t.thickness/2;i.#Xr=!0,i.#ta=Math.round(a),i.#ea=Math.round(o);const{paths:d,rect:h,rotation:u}=t;for(let{bezier:t}of d){t=Go.#Ca(t,h,u);const e=[];i.paths.push(e);let n=l*(t[0]-c),s=l*(t[1]-c);for(let i=2,r=t.length;i<r;i+=6){const r=l*(t[i]-c),a=l*(t[i+1]-c),o=l*(t[i+2]-c),d=l*(t[i+3]-c),h=l*(t[i+4]-c),u=l*(t[i+5]-c);e.push([[n,s],[r,a],[o,d],[h,u]]),n=h,s=u}const r=this.#_a(e);i.bezierPath2D.push(r)}const p=i.#ka();return i.#Wr=Math.max(nr.MIN_SIZE,p[2]-p[0]),i.#Ur=Math.max(nr.MIN_SIZE,p[3]-p[1]),i.#xa(a,o),i}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=nr._colorManager.convert(this.ctx.strokeStyle);return{annotationType:Gi.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:this.#Ta(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class qo extends nr{#Ma=null;#Pa=null;#Ia=null;#Ra=null;#La=null;#Da="";#Fa=null;#Qr=null;#Oa=null;#Na=!1;#Ba=!1;static _type="stamp";static _editorType=Gi.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#Ra=t.bitmapUrl,this.#La=t.bitmapFile}static initialize(t,e){nr.initialize(t,e)}static get supportedTypes(){return os(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map((t=>`image/${t}`)))}static get supportedTypesStr(){return os(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(Gi.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#Ha(t,e=!1){t?(this.#Ma=t.bitmap,e||(this.#Pa=t.id,this.#Na=t.isSvg),t.file&&(this.#Da=t.file.name),this.#aa()):this.remove()}#za(){if(this.#Ia=null,this._uiManager.enableWaiting(!1),this.#Fa){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Ma)return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Ma){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:r}=t||this.copyCanvas(null,null,!0).imageData,a=await n.guess({name:"altText",request:{data:i,width:s,height:r,channels:i.length/(s*r)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const o=a.output;return await this.setGuessedAltText(o),e&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}#Va(){if(this.#Pa)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#Pa).then((t=>this.#Ha(t,!0))).finally((()=>this.#za()));if(this.#Ra){const t=this.#Ra;return this.#Ra=null,this._uiManager.enableWaiting(!0),void(this.#Ia=this._uiManager.imageManager.getFromUrl(t).then((t=>this.#Ha(t))).finally((()=>this.#za())))}if(this.#La){const t=this.#La;return this.#La=null,this._uiManager.enableWaiting(!0),void(this.#Ia=this._uiManager.imageManager.getFromFile(t).then((t=>this.#Ha(t))).finally((()=>this.#za())))}const t=document.createElement("input");t.type="file",t.accept=qo.supportedTypesStr;const e=this._uiManager._signal;this.#Ia=new Promise((n=>{t.addEventListener("change",(async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#Ha(e)}else this.remove();n()}),{signal:e}),t.addEventListener("cancel",(()=>{this.remove(),n()}),{signal:e})})).finally((()=>this.#za())),t.click()}remove(){this.#Pa&&(this.#Ma=null,this._uiManager.imageManager.deleteId(this.#Pa),this.#Fa?.remove(),this.#Fa=null,this.#Qr?.disconnect(),this.#Qr=null,this.#Oa&&(clearTimeout(this.#Oa),this.#Oa=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#Pa&&null===this.#Fa&&this.#Va(),this.isAttachedToDOM||this.parent.add(this))):this.#Pa&&this.#Va()}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#Ia||this.#Ma||this.#Ra||this.#La||this.#Pa)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#Ma?this.#aa():this.#Va(),this.width&&!this.annotationElementId){const[n,i]=this.parentDimensions;this.setAt(t*n,e*i,this.width*n,this.height*i)}return this.div}#aa(){const{div:t}=this;let{width:e,height:n}=this.#Ma;const[i,s]=this.pageDimensions,r=.75;if(this.width)e=this.width*i,n=this.height*s;else if(e>r*i||n>r*s){const t=Math.min(r*i/e,r*s/n);e*=t,n*=t}const[a,o]=this.parentDimensions;this.setDims(e*a/i,n*o/s),this._uiManager.enableWaiting(!1);const l=this.#Fa=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),this.#ja(e,n),this.#oa(),this.#Ba||(this.parent.addUndoableEditor(this),this.#Ba=!0),this._reportTelemetry({action:"inserted_image"}),this.#Da&&l.setAttribute("aria-label",this.#Da)}copyCanvas(t,e,n=!1){t||(t=224);const{width:i,height:s}=this.#Ma,r=new Ws;let a=this.#Ma,o=i,l=s,c=null;if(e){if(i>e||s>e){const t=Math.min(e/i,e/s);o=Math.floor(i*t),l=Math.floor(s*t)}c=document.createElement("canvas");const t=c.width=Math.ceil(o*r.sx),n=c.height=Math.ceil(l*r.sy);this.#Na||(a=this.#$a(t,n));const d=c.getContext("2d");d.filter=this._uiManager.hcmFilter;let h="white",u="#cfcfd8";"none"!==this._uiManager.hcmFilter?u="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(h="#8f8f9d",u="#42414d");const p=15,f=p*r.sx,g=p*r.sy,m=new OffscreenCanvas(2*f,2*g),b=m.getContext("2d");b.fillStyle=h,b.fillRect(0,0,2*f,2*g),b.fillStyle=u,b.fillRect(0,0,f,g),b.fillRect(f,g,f,g),d.fillStyle=d.createPattern(m,"repeat"),d.fillRect(0,0,t,n),d.drawImage(a,0,0,a.width,a.height,0,0,t,n)}let d=null;if(n){let e,n;if(r.symmetric&&a.width<t&&a.height<t)e=a.width,n=a.height;else if(a=this.#Ma,i>t||s>t){const r=Math.min(t/i,t/s);e=Math.floor(i*r),n=Math.floor(s*r),this.#Na||(a=this.#$a(e,n))}const o=new OffscreenCanvas(e,n).getContext("2d",{willReadFrequently:!0});o.drawImage(a,0,0,a.width,a.height,0,0,e,n),d={width:e,height:n,data:o.getImageData(0,0,e,n).data}}return{canvas:c,width:o,height:l,imageData:d}}#Ua(t,e){const[n,i]=this.parentDimensions;this.width=t/n,this.height=e/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==this.#Oa&&clearTimeout(this.#Oa),this.#Oa=setTimeout((()=>{this.#Oa=null,this.#ja(t,e)}),200)}#$a(t,e){const{width:n,height:i}=this.#Ma;let s=n,r=i,a=this.#Ma;for(;s>2*t||r>2*e;){const n=s,i=r;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const o=new OffscreenCanvas(s,r);o.getContext("2d").drawImage(a,0,0,n,i,0,0,s,r),a=o.transferToImageBitmap()}return a}#ja(t,e){const n=new Ws,i=Math.ceil(t*n.sx),s=Math.ceil(e*n.sy),r=this.#Fa;if(!r||r.width===i&&r.height===s)return;r.width=i,r.height=s;const a=this.#Na?this.#Ma:this.#$a(i,s),o=r.getContext("2d");o.filter=this._uiManager.hcmFilter,o.drawImage(a,0,0,a.width,a.height,0,0,i,s)}getImageForAltText(){return this.#Fa}#Wa(t){if(t){if(this.#Na){const t=this._uiManager.imageManager.getSvgUrl(this.#Pa);if(t)return t}const t=document.createElement("canvas");return({width:t.width,height:t.height}=this.#Ma),t.getContext("2d").drawImage(this.#Ma,0,0),t.toDataURL()}if(this.#Na){const[t,e]=this.pageDimensions,n=Math.round(this.width*t*Ts.PDF_TO_CSS_UNITS),i=Math.round(this.height*e*Ts.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(n,i);return s.getContext("2d").drawImage(this.#Ma,0,0,this.#Ma.width,this.#Ma.height,0,0,n,i),s.transferToImageBitmap()}return structuredClone(this.#Ma)}#oa(){this._uiManager._signal&&(this.#Qr=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.#Ua(e.width,e.height)})),this.#Qr.observe(this.div),this._uiManager._signal.addEventListener("abort",(()=>{this.#Qr?.disconnect(),this.#Qr=null}),{once:!0}))}static async deserialize(t,e,n){let i=null;if(t instanceof Ro){const{data:{rect:s,rotation:r,id:a,structParent:o,popupRef:l},container:c,parent:{page:{pageNumber:d}}}=t,h=c.querySelector("canvas"),u=n.imageManager.getFromCanvas(c.id,h);h.remove();const p=(await e._structTree.getAriaAttributes(`${Es}${a}`))?.get("aria-label")||"";i=t={annotationType:Gi.STAMP,bitmapId:u.id,bitmap:u.bitmap,pageIndex:d-1,rect:s.slice(0),rotation:r,id:a,deleted:!1,accessibilityData:{decorative:!1,altText:p},isSvg:!1,structParent:o,popupRef:l}}const s=await super.deserialize(t,e,n),{rect:r,bitmap:a,bitmapUrl:o,bitmapId:l,isSvg:c,accessibilityData:d}=t;l&&n.imageManager.isValidId(l)?(s.#Pa=l,a&&(s.#Ma=a)):s.#Ra=o,s.#Na=c;const[h,u]=s.pageDimensions;return s.width=(r[2]-r[0])/h,s.height=(r[3]-r[1])/u,s.annotationElementId=t.id||null,d&&(s.altTextData=d),s._initialData=i,s.#Ba=!!i,s}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Gi.STAMP,bitmapId:this.#Pa,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#Na,structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=this.#Wa(!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const t=this.#vs(n);if(t.isSame)return null;t.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,null===e)return n;e.stamps||=new Map;const r=this.#Na?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(e.stamps.has(this.#Pa)){if(this.#Na){const t=e.stamps.get(this.#Pa);r>t.area&&(t.area=r,t.serialized.bitmap.close(),t.serialized.bitmap=this.#Wa(!1))}}else e.stamps.set(this.#Pa,{area:r,serialized:n}),n.bitmap=this.#Wa(!1);return n}#vs(t){const{rect:e,pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=t.rect.every(((t,n)=>Math.abs(t-e[n])<1)),r=t.pageIndex===n,a=(t.accessibilityData?.alt||"")===i;return{isSame:s&&r&&a,isSameAltText:a}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class Xo{#es;#Ga=!1;#qa=null;#Xa=null;#Ka=null;#Ya=new Map;#Ja=!1;#Qa=!1;#Za=!1;#to=null;#eo=null;#g;static _initialized=!1;static#z=new Map([Oo,Go,qo,Wo].map((t=>[t._editorType,t])));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:r,drawLayer:a,textLayer:o,viewport:l,l10n:c}){const d=[...Xo.#z.values()];if(!Xo._initialized){Xo._initialized=!0;for(const e of d)e.initialize(c,t)}t.registerEditorTypes(d),this.#g=t,this.pageIndex=e,this.div=n,this.#es=s,this.#qa=r,this.viewport=l,this.#to=o,this.drawLayer=a,this._structTree=i,this.#g.addLayer(this)}get isEmpty(){return 0===this.#Ya.size}get isInvisible(){return this.isEmpty&&this.#g.getMode()===Gi.NONE}updateToolbar(t){this.#g.updateToolbar(t)}updateMode(t=this.#g.getMode()){switch(this.#no(),t){case Gi.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case Gi.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case Gi.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of Xo.#z.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#to?.div}addInkEditorIfNeeded(t){if(this.#g.getMode()===Gi.INK){if(!t)for(const t of this.#Ya.values())if(t.isEmpty())return void t.setInBackground();this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(t){this.#g.setEditingState(t)}addCommands(t){this.#g.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#qa?.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const e of this.#Ya.values())e.enableEditing(),e.show(!0),e.annotationElementId&&(this.#g.removeChangedExistingAnnotation(e),t.add(e.annotationElementId));if(!this.#qa)return;const e=this.#qa.getEditableAnnotations();for(const n of e){if(n.hide(),this.#g.isDeletedAnnotationElement(n.data.id))continue;if(t.has(n.data.id))continue;const e=await this.deserialize(n);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#Za=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of this.#Ya.values())n.disableEditing(),n.annotationElementId&&(null===n.serialize()?(e.set(n.annotationElementId,n),this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()):t.set(n.annotationElementId,n));if(this.#qa){const n=this.#qa.getEditableAnnotations();for(const i of n){const{id:n}=i.data;if(this.#g.isDeletedAnnotationElement(n))continue;let s=e.get(n);s?(s.resetAnnotationElement(i),s.show(!1),i.show()):(s=t.get(n),s&&(this.#g.addChangedExistingAnnotation(s),s.renderAnnotationElement(i)&&s.show(!1)),i.show())}}this.#no(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const t of Xo.#z.values())n.remove(`${t._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#Za=!1}getEditableAnnotation(t){return this.#qa?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#g.getActive()!==t&&this.#g.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#to?.div&&!this.#eo){this.#eo=new AbortController;const t=this.#g.combinedSignal(this.#eo);this.#to.div.addEventListener("pointerdown",this.#io.bind(this),{signal:t}),this.#to.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#to?.div&&this.#eo&&(this.#eo.abort(),this.#eo=null,this.#to.div.classList.remove("highlighting"))}#io(t){this.#g.unselectAll();const{target:e}=t;if(e===this.#to.div||("img"===e.getAttribute("role")||e.classList.contains("endOfContent"))&&this.#to.div.contains(e)){const{isMac:e}=ys.platform;if(0!==t.button||t.ctrlKey&&e)return;this.#g.showAllEditors("highlight",!0,!0),this.#to.div.classList.add("free"),this.toggleDrawing(),Wo.startHighlighting(this,"ltr"===this.#g.direction,{target:this.#to.div,x:t.x,y:t.y}),this.#to.div.addEventListener("pointerup",(()=>{this.#to.div.classList.remove("free"),this.toggleDrawing(!0)}),{once:!0,signal:this.#g._signal}),t.preventDefault()}}enableClick(){if(this.#Xa)return;this.#Xa=new AbortController;const t=this.#g.combinedSignal(this.#Xa);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#Xa?.abort(),this.#Xa=null}attach(t){this.#Ya.set(t.id,t);const{annotationElementId:e}=t;e&&this.#g.isDeletedAnnotationElement(e)&&this.#g.removeDeletedAnnotationElement(t)}detach(t){this.#Ya.delete(t.id),this.#es?.removePointerInTextLayer(t.contentDiv),!this.#Za&&t.annotationElementId&&this.#g.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#g.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#Qa||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#g.addDeletedAnnotationElement(t.annotationElementId),nr.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),this.#g.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#g.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#Ka&&(t._focusEventsAllowed=!1,this.#Ka=setTimeout((()=>{this.#Ka=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this.#g._signal}),e.focus())}),0)),t._structTreeParentId=this.#es?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getNextId(){return this.#g.getId()}get#so(){return Xo.#z.get(this.#g.getMode())}combinedSignal(t){return this.#g.combinedSignal(t)}#ro(t){const e=this.#so;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#so?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#g.updateToolbar(t),this.#g.updateMode(t);const{offsetX:n,offsetY:i}=this.#ao(),s=this.getNextId(),r=this.#ro({parent:this,id:s,x:n,y:i,uiManager:this.#g,isCentered:!0,...e});r&&this.add(r)}async deserialize(t){return await(Xo.#z.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#g))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),s=this.#ro({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#g,isCentered:e,...n});return s&&this.add(s),s}#ao(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),r=Math.max(0,e),a=(s+Math.min(window.innerWidth,t+n))/2-t,o=(r+Math.min(window.innerHeight,e+i))/2-e,[l,c]=this.viewport.rotation%180==0?[a,o]:[o,a];return{offsetX:l,offsetY:c}}addNewEditor(){this.createAndAddNewEditor(this.#ao(),!0)}setSelected(t){this.#g.setSelected(t)}toggleSelected(t){this.#g.toggleSelected(t)}unselect(t){this.#g.unselect(t)}pointerup(t){const{isMac:e}=ys.platform;0!==t.button||t.ctrlKey&&e||t.target===this.div&&this.#Ja&&(this.#Ja=!1,this.#Ga?this.#g.getMode()!==Gi.STAMP?this.createAndAddNewEditor(t,!1):this.#g.unselectAll():this.#Ga=!0)}pointerdown(t){if(this.#g.getMode()===Gi.HIGHLIGHT&&this.enableTextSelection(),this.#Ja)return void(this.#Ja=!1);const{isMac:e}=ys.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;this.#Ja=!0;const n=this.#g.getActive();this.#Ga=!n||n.isEmpty()}findNewParent(t,e,n){const i=this.#g.findParent(e,n);return null!==i&&i!==this&&(i.changeParent(t),!0)}destroy(){this.#g.getActive()?.parent===this&&(this.#g.commitOrRemove(),this.#g.setActiveEditor(null)),this.#Ka&&(clearTimeout(this.#Ka),this.#Ka=null);for(const t of this.#Ya.values())this.#es?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#Ya.clear(),this.#g.removeLayer(this)}#no(){this.#Qa=!0;for(const t of this.#Ya.values())t.isEmpty()&&t.remove();this.#Qa=!1}render({viewport:t}){this.viewport=t,Us(this.div,t);for(const t of this.#g.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:t}){this.#g.commitOrRemove(),this.#no();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Us(this.div,{rotation:n}),e!==n)for(const t of this.#Ya.values())t.rotate(n);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#g.viewParameters.realScale}}class Ko{#Fi=null;#y=0;#oo=new Map;#lo=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(this.#Fi){if(this.#Fi!==t){if(this.#oo.size>0)for(const e of this.#oo.values())e.remove(),t.append(e);this.#Fi=t}}else this.#Fi=t}static get _svgFactory(){return os(this,"_svgFactory",new eo)}static#co(t,{x:e=0,y:n=0,width:i=1,height:s=1}={}){const{style:r}=t;r.top=100*n+"%",r.left=100*e+"%",r.width=100*i+"%",r.height=100*s+"%"}#do(t){const e=Ko._svgFactory.create(1,1,!0);return this.#Fi.append(e),e.setAttribute("aria-hidden",!0),Ko.#co(e,t),e}#ho(t,e){const n=Ko._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=Ko._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i}draw(t,e,n,i=!1){const s=this.#y++,r=this.#do(t.box);r.classList.add(...t.classNamesForDrawing);const a=Ko._svgFactory.createElement("defs");r.append(a);const o=Ko._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("d",t.toSVGPath()),i&&this.#lo.set(s,o);const c=this.#ho(a,l),d=Ko._svgFactory.createElement("use");return r.append(d),r.setAttribute("fill",e),r.setAttribute("fill-opacity",n),d.setAttribute("href",`#${l}`),this.#oo.set(s,r),{id:s,clipPathId:`url(#${c})`}}drawOutline(t){const e=this.#y++,n=this.#do(t.box);n.classList.add(...t.classNamesForOutlining);const i=Ko._svgFactory.createElement("defs");n.append(i);const s=Ko._svgFactory.createElement("path");i.append(s);const r=`path_p${this.pageIndex}_${e}`;let a;if(s.setAttribute("id",r),s.setAttribute("d",t.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke"),t.mustRemoveSelfIntersections){const t=Ko._svgFactory.createElement("mask");i.append(t),a=`mask_p${this.pageIndex}_${e}`,t.setAttribute("id",a),t.setAttribute("maskUnits","objectBoundingBox");const n=Ko._svgFactory.createElement("rect");t.append(n),n.setAttribute("width","1"),n.setAttribute("height","1"),n.setAttribute("fill","white");const s=Ko._svgFactory.createElement("use");t.append(s),s.setAttribute("href",`#${r}`),s.setAttribute("stroke","none"),s.setAttribute("fill","black"),s.setAttribute("fill-rule","nonzero"),s.classList.add("mask")}const o=Ko._svgFactory.createElement("use");n.append(o),o.setAttribute("href",`#${r}`),a&&o.setAttribute("mask",`url(#${a})`);const l=o.cloneNode();return n.append(l),o.classList.add("mainOutline"),l.classList.add("secondaryOutline"),this.#oo.set(e,n),e}finalizeLine(t,e){const n=this.#lo.get(t);this.#lo.delete(t),this.updateBox(t,e.box),n.setAttribute("d",e.toSVGPath())}updateLine(t,e){this.#oo.get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}updatePath(t,e){this.#lo.get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){Ko.#co(this.#oo.get(t),e)}show(t,e){this.#oo.get(t).classList.toggle("hidden",!e)}rotate(t,e){this.#oo.get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){this.#oo.get(t).setAttribute("fill",e)}changeOpacity(t,e){this.#oo.get(t).setAttribute("fill-opacity",e)}addClass(t,e){this.#oo.get(t).classList.add(e)}removeClass(t,e){this.#oo.get(t).classList.remove(e)}getSVGRoot(t){return this.#oo.get(t)}remove(t){this.#lo.delete(t),null!==this.#Fi&&(this.#oo.get(t).remove(),this.#oo.delete(t))}destroy(){this.#Fi=null;for(const t of this.#oo.values())t.remove();this.#oo.clear(),this.#lo.clear()}}var Yo=zi.AnnotationLayer,Jo=zi.AnnotationMode,Qo=zi.GlobalWorkerOptions,Zo=zi.PDFDataRangeTransport,tl=zi.TextLayer,el=zi.getDocument,nl=n(74848),il=n.t(nl,2),sl=function(t,e,n){if(n||2===arguments.length)for(var i,s=0,r=e.length;s<r;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))},rl=sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl(sl([],["onCopy","onCut","onPaste"],!0),["onCompositionEnd","onCompositionStart","onCompositionUpdate"],!0),["onFocus","onBlur"],!0),["onInput","onInvalid","onReset","onSubmit"],!0),["onLoad","onError"],!0),["onKeyDown","onKeyPress","onKeyUp"],!0),["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],!0),["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],!0),["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],!0),["onSelect"],!0),["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],!0),["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],!0),["onScroll"],!0),["onWheel"],!0),["onAnimationStart","onAnimationEnd","onAnimationIteration"],!0),["onTransitionEnd"],!0),["onChange"],!0),["onToggle"],!0);function al(t,e){var n={};return rl.forEach((function(i){var s=t[i];s&&(n[i]=e?function(t){return s(t,e(i))}:s)})),n}function ol(t){var e=!1;return{promise:new Promise((function(n,i){t.then((function(t){return!e&&n(t)})).catch((function(t){return!e&&i(t)}))})),cancel:function(){e=!0}}}function ll(t){var e,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=ll(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}var cl=function(){for(var t,e,n=0,i="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=ll(t))&&(i&&(i+=" "),i+=e);return i};function dl(t,e){if(!t)throw new Error("Invariant failed")}var hl=n(9771),ul=Object.prototype.hasOwnProperty;function pl(t,e,n){for(n of t.keys())if(fl(n,e))return n}function fl(t,e){var n,i,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((i=t.length)===e.length)for(;i--&&fl(t[i],e[i]););return-1===i}if(n===Set){if(t.size!==e.size)return!1;for(i of t){if((s=i)&&"object"==typeof s&&!(s=pl(e,s)))return!1;if(!e.has(s))return!1}return!0}if(n===Map){if(t.size!==e.size)return!1;for(i of t){if((s=i[0])&&"object"==typeof s&&!(s=pl(e,s)))return!1;if(!fl(i[1],e.get(s)))return!1}return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((i=t.byteLength)===e.byteLength)for(;i--&&t.getInt8(i)===e.getInt8(i););return-1===i}if(ArrayBuffer.isView(t)){if((i=t.byteLength)===e.byteLength)for(;i--&&t[i]===e[i];);return-1===i}if(!n||"object"==typeof t){for(n in i=0,t){if(ul.call(t,n)&&++i&&!ul.call(e,n))return!1;if(!(n in e)||!fl(t[n],e[n]))return!1}return Object.keys(e).length===i}}return t!=t&&e!=e}var gl=(0,s.createContext)(null);function ml({children:t,type:e}){return(0,nl.jsx)("div",{className:`react-pdf__message react-pdf__message--${e}`,children:t})}class bl{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return dl(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){dl(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise((e=>{dl(this.pdfDocument),dl(t),"string"==typeof t?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)})).then((t=>{dl(Array.isArray(t));const e=t[0];new Promise((t=>{dl(this.pdfDocument),e instanceof Object?this.pdfDocument.getPageIndex(e).then((e=>{t(e)})).catch((()=>{dl(!1)})):"number"==typeof e?t(e):dl(!1)})).then((e=>{const n=e+1;dl(this.pdfViewer),dl(n>=1&&n<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:e,pageNumber:n})}))}))}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;dl(this.pdfViewer),dl(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,n){t.href=e,t.rel=this.externalLinkRel||"noopener noreferrer nofollow",t.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}var vl=1,yl=2;const wl="undefined"!=typeof window,Al=wl&&"file:"===window.location.protocol;function xl(t){return function(t){return void 0!==t}(t)&&null!==t}function Sl(t){return function(t){return"string"==typeof t}(t)&&/^data:/.test(t)}function _l(t){dl(Sl(t));const[e="",n=""]=t.split(",");return-1!==e.split(";").indexOf("base64")?atob(n):unescape(n)}function El(){return wl&&window.devicePixelRatio||1}function Cl(){hl(!Al,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.")}function Tl(t){(null==t?void 0:t.cancel)&&t.cancel()}function kl(t,e){return Object.defineProperty(t,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(t,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(t,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(t,"originalHeight",{get(){return this.view[3]},configurable:!0}),t}function Ml(t,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return t}}function Pl(){return(0,s.useReducer)(Ml,{value:void 0,error:void 0})}var Il=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n};const{Tm:Rl}=i,Ll=(t,e)=>{switch(e){case vl:t(prompt("Enter the password to open this PDF file."));break;case yl:t(prompt("Invalid password. Please try again."))}};function Dl(t){return"object"==typeof t&&null!==t&&("data"in t||"range"in t||"url"in t)}const Fl=(0,s.forwardRef)((function(t,e){var{children:n,className:i,error:r="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:d,loading:h="Loading PDF…",noData:u="No PDF file specified.",onItemClick:p,onLoadError:f,onLoadProgress:g,onLoadSuccess:m,onPassword:b=Ll,onSourceError:v,onSourceSuccess:y,options:w,renderMode:A,rotate:x}=t,S=Il(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[_,E]=Pl(),{value:C,error:T}=_,[k,M]=Pl(),{value:P,error:I}=k,R=(0,s.useRef)(new bl),L=(0,s.useRef)([]),D=(0,s.useRef)(void 0),F=(0,s.useRef)(void 0);l&&l!==D.current&&Dl(l)&&(hl(!fl(l,D.current),'File prop passed to <Document /> changed, but it\'s equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.'),D.current=l),w&&w!==F.current&&(hl(!fl(w,F.current),'Options prop passed to <Document /> changed, but it\'s equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.'),F.current=w);const O=(0,s.useRef)({scrollPageIntoView:t=>{const{dest:e,pageNumber:n,pageIndex:i=n-1}=t;if(p)return void p({dest:e,pageIndex:i,pageNumber:n});const s=L.current[i];s?s.scrollIntoView():hl(!1,`An internal link leading to page ${n} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});(0,s.useImperativeHandle)(e,(()=>({linkService:R,pages:L,viewer:O})),[]),(0,s.useEffect)((function(){E({type:"RESET"})}),[l,E]);const N=(0,s.useCallback)((()=>{return t=this,e=void 0,i=function*(){if(!l)return null;if("string"==typeof l)return Sl(l)?{data:_l(l)}:(Cl(),{url:l});if(l instanceof Rl)return{range:l};if(l instanceof ArrayBuffer)return{data:l};if(wl&&(t=l,dl(wl),t instanceof Blob)){const t=yield function(t){return new Promise(((e,n)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return n(new Error("Error while reading a file."));e(i.result)},i.onerror=t=>{if(!t.target)return n(new Error("Error while reading a file."));const{error:e}=t.target;if(!e)return n(new Error("Error while reading a file."));switch(e.code){case e.NOT_FOUND_ERR:return n(new Error("Error while reading a file: File not found."));case e.SECURITY_ERR:return n(new Error("Error while reading a file: Security error."));case e.ABORT_ERR:return n(new Error("Error while reading a file: Aborted."));default:return n(new Error("Error while reading a file."))}},i.readAsArrayBuffer(t)}))}(l);return{data:t}}var t;if(dl("object"==typeof l),dl(Dl(l)),"url"in l&&"string"==typeof l.url){if(Sl(l.url)){const{url:t}=l,e=Il(l,["url"]),n=_l(t);return Object.assign({data:n},e)}Cl()}return l},new((n=void 0)||(n=Promise))((function(s,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function o(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}l((i=i.apply(t,e||[])).next())}));var t,e,n,i}),[l]);(0,s.useEffect)((()=>{const t=ol(N());return t.promise.then((t=>{E({type:"RESOLVE",value:t})})).catch((t=>{E({type:"REJECT",error:t})})),()=>{Tl(t)}}),[N,E]),(0,s.useEffect)((()=>{void 0!==C&&(!1!==C?y&&y():T&&(hl(!1,T.toString()),v&&v(T)))}),[C]),(0,s.useEffect)((function(){M({type:"RESET"})}),[M,C]),(0,s.useEffect)((function(){if(!C)return;const t=w?Object.assign(Object.assign({},C),w):C,e=el(t);g&&(e.onProgress=g),b&&(e.onPassword=b);const n=e,i=n.promise.then((t=>{M({type:"RESOLVE",value:t})})).catch((t=>{n.destroyed||M({type:"REJECT",error:t})}));return()=>{i.finally((()=>n.destroy()))}}),[w,M,C]),(0,s.useEffect)((()=>{void 0!==P&&(!1!==P?P&&(m&&m(P),L.current=new Array(P.numPages),R.current.setDocument(P)):I&&(hl(!1,I.toString()),f&&f(I)))}),[P]),(0,s.useEffect)((function(){R.current.setViewer(O.current),R.current.setExternalLinkRel(a),R.current.setExternalLinkTarget(o)}),[a,o]);const B=(0,s.useCallback)(((t,e)=>{L.current[t]=e}),[]),H=(0,s.useCallback)((t=>{delete L.current[t]}),[]),z=(0,s.useMemo)((()=>({imageResourcesPath:d,linkService:R.current,onItemClick:p,pdf:P,registerPage:B,renderMode:A,rotate:x,unregisterPage:H})),[d,p,P,B,A,x,H]),V=(0,s.useMemo)((()=>al(S,(()=>P))),[S,P]);return(0,nl.jsx)("div",Object.assign({className:cl("react-pdf__Document",i),ref:c,style:{"--scale-factor":"1"}},V,{children:l?null==P?(0,nl.jsx)(ml,{type:"loading",children:"function"==typeof h?h():h}):!1===P?(0,nl.jsx)(ml,{type:"error",children:"function"==typeof r?r():r}):(0,nl.jsx)(gl.Provider,{value:z,children:n}):(0,nl.jsx)(ml,{type:"no-data",children:"function"==typeof u?u():u})}))}));var Ol=Fl;function Nl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.filter(Boolean);return n.length<=1?n[0]||null:function(t){n.forEach((function(e){"function"==typeof e?e(t):e&&(e.current=t)}))}}var Bl=(0,s.createContext)(null);const Hl={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},zl=/^H(\d+)$/;function Vl(t){return"children"in t}function jl(t){return!!Vl(t)&&1===t.children.length&&0 in t.children&&"id"in t.children[0]}function $l(t){const e={};if(Vl(t)){if(void 0!==t.alt&&(e["aria-label"]=t.alt),void 0!==t.lang&&(e.lang=t.lang),jl(t)){const[n]=t.children;if(n){const t=$l(n);return Object.assign(Object.assign({},e),t)}}}else"id"in t&&(e["aria-owns"]=t.id);return e}function Ul(t){return t?Object.assign(Object.assign({},function(t){const e={};if(Vl(t)){const{role:n}=t,i=n.match(zl);if(i)e.role="heading",e["aria-level"]=Number(i[1]);else if(function(t){return t in Hl}(n)){const t=Hl[n];t&&(e.role=t)}}return e}(t)),$l(t)):null}function Wl({className:t,node:e}){const n=(0,s.useMemo)((()=>Ul(e)),[e]),i=(0,s.useMemo)((()=>Vl(e)?jl(e)?null:e.children.map(((t,e)=>(0,nl.jsx)(Wl,{node:t},e))):null),[e]);return(0,nl.jsx)("span",Object.assign({className:t},n,{children:i}))}function Gl(){return(0,s.useContext)(Bl)}function ql(){const t=Gl();dl(t);const{onGetStructTreeError:e,onGetStructTreeSuccess:n}=t,[i,r]=Pl(),{value:a,error:o}=i,{customTextRenderer:l,page:c}=t;return(0,s.useEffect)((function(){r({type:"RESET"})}),[r,c]),(0,s.useEffect)((function(){if(l)return;if(!c)return;const t=ol(c.getStructTree()),e=t;return t.promise.then((t=>{r({type:"RESOLVE",value:t})})).catch((t=>{r({type:"REJECT",error:t})})),()=>Tl(e)}),[l,c,r]),(0,s.useEffect)((()=>{void 0!==a&&(!1!==a?a&&n&&n(a):o&&(hl(!1,o.toString()),e&&e(o)))}),[a]),a?(0,nl.jsx)(Wl,{className:"react-pdf__Page__structTree structTree",node:a}):null}const Xl=Jo;function Kl(t){const e=Gl();dl(e);const n=Object.assign(Object.assign({},e),t),{_className:i,canvasBackground:r,devicePixelRatio:a=El(),onRenderError:o,onRenderSuccess:l,page:c,renderForms:d,renderTextLayer:h,rotate:u,scale:p}=n,{canvasRef:f}=t;dl(c);const g=(0,s.useRef)(null);function m(t){(function(t){return"RenderingCancelledException"===t.name})(t)||(hl(!1,t.toString()),o&&o(t))}const b=(0,s.useMemo)((()=>c.getViewport({scale:p*a,rotation:u})),[a,c,u,p]),v=(0,s.useMemo)((()=>c.getViewport({scale:p,rotation:u})),[c,u,p]);(0,s.useEffect)((function(){if(!c)return;c.cleanup();const{current:t}=g;if(!t)return;t.width=b.width,t.height=b.height,t.style.width=`${Math.floor(v.width)}px`,t.style.height=`${Math.floor(v.height)}px`,t.style.visibility="hidden";const e={annotationMode:d?Xl.ENABLE_FORMS:Xl.ENABLE,canvasContext:t.getContext("2d",{alpha:!1}),viewport:b};r&&(e.background=r);const n=c.render(e),i=n;return n.promise.then((()=>{t.style.visibility="",c&&l&&l(kl(c,p))})).catch(m),()=>Tl(i)}),[r,c,d,b,v]);const y=(0,s.useCallback)((()=>{const{current:t}=g;t&&(t.width=0,t.height=0)}),[]);return(0,s.useEffect)((()=>y),[y]),(0,nl.jsx)("canvas",{className:`${i}__canvas`,dir:"ltr",ref:Nl(f,g),style:{display:"block",userSelect:"none"},children:h?(0,nl.jsx)(ql,{}):null})}function Yl(){const t=Gl();dl(t);const{customTextRenderer:e,onGetTextError:n,onGetTextSuccess:i,onRenderTextLayerError:r,onRenderTextLayerSuccess:a,page:o,pageIndex:l,pageNumber:c,rotate:d,scale:h}=t;dl(o);const[u,p]=Pl(),{value:f,error:g}=u,m=(0,s.useRef)(null);hl(1===Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10),"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer"),(0,s.useEffect)((function(){p({type:"RESET"})}),[o,p]),(0,s.useEffect)((function(){if(!o)return;const t=ol(o.getTextContent()),e=t;return t.promise.then((t=>{p({type:"RESOLVE",value:t})})).catch((t=>{p({type:"REJECT",error:t})})),()=>Tl(e)}),[o,p]),(0,s.useEffect)((()=>{void 0!==f&&(!1!==f?f&&i&&i(f):g&&(hl(!1,g.toString()),n&&n(g)))}),[f]);const b=(0,s.useCallback)((()=>{a&&a()}),[a]),v=(0,s.useCallback)((t=>{hl(!1,t.toString()),r&&r(t)}),[r]),y=(0,s.useMemo)((()=>o.getViewport({scale:h,rotation:d})),[o,d,h]);return(0,s.useLayoutEffect)((function(){if(!o||!f)return;const{current:t}=m;if(!t)return;t.innerHTML="";const n=o.streamTextContent({includeMarkedContent:!0}),i=new tl({container:t,textContentSource:n,viewport:y}),s=i;return i.render().then((()=>{const n=document.createElement("div");n.className="endOfContent",t.append(n);const i=t.querySelectorAll('[role="presentation"]');if(e){let t=0;f.items.forEach(((n,s)=>{if(!function(t){return"str"in t}(n))return;const r=i[t];if(!r)return;const a=e(Object.assign({pageIndex:l,pageNumber:c,itemIndex:s},n));r.innerHTML=a,t+=n.str&&n.hasEOL?2:1}))}b()})).catch(v),()=>Tl(s)}),[e,v,b,o,l,c,f,y]),(0,nl.jsx)("div",{className:cl("react-pdf__Page__textContent","textLayer"),onMouseUp:function(){const t=m.current;t&&t.classList.remove("selecting")},onMouseDown:function(){const t=m.current;t&&t.classList.add("selecting")},ref:m})}function Jl(){return(0,s.useContext)(gl)}function Ql(){const t=Jl(),e=Gl();dl(e);const n=Object.assign(Object.assign({},t),e),{imageResourcesPath:i,linkService:r,onGetAnnotationsError:a,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:c,page:d,pdf:h,renderForms:u,rotate:p,scale:f=1}=n;dl(h),dl(d),dl(r);const[g,m]=Pl(),{value:b,error:v}=g,y=(0,s.useRef)(null);hl(1===Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10),"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations"),(0,s.useEffect)((function(){m({type:"RESET"})}),[m,d]),(0,s.useEffect)((function(){if(!d)return;const t=ol(d.getAnnotations()),e=t;return t.promise.then((t=>{m({type:"RESOLVE",value:t})})).catch((t=>{m({type:"REJECT",error:t})})),()=>{Tl(e)}}),[m,d]),(0,s.useEffect)((()=>{void 0!==b&&(!1!==b?b&&o&&o(b):v&&(hl(!1,v.toString()),a&&a(v)))}),[b]);const w=(0,s.useMemo)((()=>d.getViewport({scale:f,rotation:p})),[d,p,f]);return(0,s.useEffect)((function(){if(!(h&&d&&r&&b))return;const{current:t}=y;if(!t)return;const e=w.clone({dontFlip:!0}),n={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:t,l10n:null,page:d,structTreeLayer:null,viewport:e},s={annotations:b,annotationStorage:h.annotationStorage,div:t,imageResourcesPath:i,linkService:r,page:d,renderForms:u,viewport:e};t.innerHTML="";try{new Yo(n).render(s),c&&c()}catch(t){!function(t){hl(!1,`${t}`),l&&l(t)}(t)}return()=>{}}),[b,i,r,d,h,u,w]),(0,nl.jsx)("div",{className:cl("react-pdf__Page__annotations","annotationLayer"),ref:y})}const Zl=1;function tc(t){const e=Jl(),n=Object.assign(Object.assign({},e),t),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:r=!0,canvasBackground:a,canvasRef:o,children:l,className:c,customRenderer:d,customTextRenderer:h,devicePixelRatio:u,error:p="Failed to load the page.",height:f,inputRef:g,loading:m="Loading page…",noData:b="No page specified.",onGetAnnotationsError:v,onGetAnnotationsSuccess:y,onGetStructTreeError:w,onGetStructTreeSuccess:A,onGetTextError:x,onGetTextSuccess:S,onLoadError:_,onLoadSuccess:E,onRenderAnnotationLayerError:C,onRenderAnnotationLayerSuccess:T,onRenderError:k,onRenderSuccess:M,onRenderTextLayerError:P,onRenderTextLayerSuccess:I,pageIndex:R,pageNumber:L,pdf:D,registerPage:F,renderAnnotationLayer:O=!0,renderForms:N=!1,renderMode:B="canvas",renderTextLayer:H=!0,rotate:z,scale:V=Zl,unregisterPage:j,width:$}=n,U=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[W,G]=Pl(),{value:q,error:X}=W,K=(0,s.useRef)(null);dl(D);const Y=xl(L)?L-1:null!=R?R:null,J=null!=L?L:xl(R)?R+1:null,Q=null!=z?z:q?q.rotate:null,Z=(0,s.useMemo)((()=>{if(!q)return null;let t=1;const e=null!=V?V:Zl;if($||f){const e=q.getViewport({scale:1,rotation:Q});$?t=$/e.width:f&&(t=f/e.height)}return e*t}),[f,q,Q,V,$]);(0,s.useEffect)((function(){return()=>{xl(Y)&&r&&j&&j(Y)}}),[r,D,Y,j]),(0,s.useEffect)((function(){G({type:"RESET"})}),[G,D,Y]),(0,s.useEffect)((function(){if(!D||!J)return;const t=ol(D.getPage(J)),e=t;return t.promise.then((t=>{G({type:"RESOLVE",value:t})})).catch((t=>{G({type:"REJECT",error:t})})),()=>Tl(e)}),[G,D,J]),(0,s.useEffect)((()=>{void 0!==q&&(!1!==q?function(){if(E){if(!q||!Z)return;E(kl(q,Z))}if(r&&F){if(!xl(Y)||!K.current)return;F(Y,K.current)}}():X&&(hl(!1,X.toString()),_&&_(X)))}),[q,Z]);const tt=(0,s.useMemo)((()=>q&&xl(Y)&&J&&xl(Q)&&xl(Z)?{_className:i,canvasBackground:a,customTextRenderer:h,devicePixelRatio:u,onGetAnnotationsError:v,onGetAnnotationsSuccess:y,onGetStructTreeError:w,onGetStructTreeSuccess:A,onGetTextError:x,onGetTextSuccess:S,onRenderAnnotationLayerError:C,onRenderAnnotationLayerSuccess:T,onRenderError:k,onRenderSuccess:M,onRenderTextLayerError:P,onRenderTextLayerSuccess:I,page:q,pageIndex:Y,pageNumber:J,renderForms:N,renderTextLayer:H,rotate:Q,scale:Z}:null),[i,a,h,u,v,y,w,A,x,S,C,T,k,M,P,I,q,Y,J,N,H,Q,Z]),et=(0,s.useMemo)((()=>al(U,(()=>q?Z?kl(q,Z):void 0:q))),[U,q,Z]),nt=`${Y}@${Z}/${Q}`;return(0,nl.jsx)("div",Object.assign({className:cl(i,c),"data-page-number":J,ref:Nl(g,K),style:{"--scale-factor":`${Z}`,backgroundColor:a||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},et,{children:J?null===D||null==q?(0,nl.jsx)(ml,{type:"loading",children:"function"==typeof m?m():m}):!1===D||!1===q?(0,nl.jsx)(ml,{type:"error",children:"function"==typeof p?p():p}):(0,nl.jsxs)(Bl.Provider,{value:tt,children:[function(){switch(B){case"custom":return dl(d),(0,nl.jsx)(d,{},`${nt}_custom`);case"none":return null;default:return(0,nl.jsx)(Kl,{canvasRef:o},`${nt}_canvas`)}}(),H?(0,nl.jsx)(Yl,{},`${nt}_text`):null,O?(0,nl.jsx)(Ql,{},`${nt}_annotations`):null,l]}):(0,nl.jsx)(ml,{type:"no-data",children:"function"==typeof b?b():b})}))}Qo.workerSrc="".concat(window.location.origin,"/SDS-AI-Outlook-Plugin/src/pdf.worker.min.mjs");var ec=function(t){var e=t.base64,n=(0,s.useState)(0),i=n[0],r=n[1],a=(0,s.useState)(1),o=a[0],l=a[1];return s.createElement("div",{style:{textAlign:"center"}},s.createElement(Ol,{file:"data:application/pdf;base64,".concat(e),onLoadSuccess:function(t){var e=t.numPages;r(e),l(1)},loading:s.createElement("div",{className:"spinner"})},s.createElement(tc,{pageNumber:o,width:600})),i>1&&s.createElement("div",{style:{marginTop:"10px"}},s.createElement("button",{onClick:function(){return l((function(t){return Math.max(t-1,1)}))},disabled:o<=1},"Prev"),s.createElement("span",{style:{margin:"0 10px"}},"Page ",o," of ",i),s.createElement("button",{onClick:function(){return l((function(t){return Math.min(t+1,i)}))},disabled:o>=i},"Next")))},nc=function(t){var e=t.base64,n=t.contentType,i=t.alt;return s.createElement("img",{src:"data:".concat(n,";base64,").concat(e),alt:i,style:{maxWidth:"100%",maxHeight:"90vh",objectFit:"contain"}})},ic=function(t){var e=t.attachment;return e?e.name.toLowerCase().endsWith(".pdf")?s.createElement(ec,{base64:e.fileBase64||""}):e.contentType.startsWith("image/")?s.createElement(nc,{base64:e.fileBase64||"",contentType:e.contentType,alt:e.name}):s.createElement("p",null,"Preview not supported for this file type."):s.createElement("p",{style:{color:"#888"}},"Select an attachment to preview.")},sc=function(t){var e=t.accessToken,n=t.initialAttachments,i=void 0===n?[]:n,r=t.financeUrls,a=t.selectedAgency,o=(0,s.useRef)(!1),l=(0,s.useState)(!1),c=l[0],d=l[1],h=(0,s.useState)(null),u=h[0],p=h[1],f=(0,s.useState)(null),g=f[0],m=f[1],b=(0,s.useState)(!1),v=b[0],y=b[1],w=function(t,e){var n=(0,s.useState)((function(){return t})),i=n[0],r=n[1],a=(0,s.useState)(0===t.length),o=a[0],l=a[1];return{loading:o,filteredAttachments:e?i:i.filter((function(t){return t.name.toLowerCase().endsWith(".pdf")})),setAttachments:function(t){r(t),l(!1)}}}(i,c),A=w.loading,x=w.filteredAttachments,S=w.setAttachments;(0,s.useEffect)((function(){!o.current&&i.length>0&&(S(i),o.current=!0)}),[i,S]);var _=["USD","EUR","CHF","GBP","TND","NZD","AOA","CFA","GYD","ZAR","NAD"],E=["0","10","19","20"];return s.createElement("div",{className:"invoice-container"},(A||v)&&s.createElement(s.Fragment,null,s.createElement("div",{className:"invoice-overlay"},s.createElement("img",{src:"/SDS-AI-Outlook-Plugin/assets/ai-bot-icon.png",alt:"AI Bot",className:"ai-bot-animated"}),A?"Loading attachments...":s.createElement(s.Fragment,null,s.createElement("span",null,"Analyzing content..."),s.createElement("span",null,"Just a moment..."))),s.createElement("div",{className:"scanner-effect"})),s.createElement("div",{className:"invoice-sidebar",style:{maxWidth:600}},s.createElement("div",{className:"invoice-header"},s.createElement("h3",null,"Email Attachments"),s.createElement(Ni,{showAll:c,onToggle:d})),s.createElement("div",{className:"attachment-table"},s.createElement(Bi,{attachments:x,onSend:function(t){return n=void 0,i=void 0,o=function(){var n,i,s,o,l;return function(t,e){var n,i,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,i&&(s=2&o[0]?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(c){switch(c.label){case 0:if(!t.fileBase64||!e||!a)return[2];p(t),y(!0),c.label=1;case 1:return c.trys.push([1,4,5,6]),n=r[a],i="".concat(n,"/Vouchers/SendVoucherForOCR"),s={fileName:t.name,fileCode:Math.floor(1e6*Math.random()).toString(),fileType:0,fileCategory:0,fileExtension:t.name.split(".").pop()||"unknown",fileSize:t.size,fileGuid:crypto.randomUUID(),fileBase64:t.fileBase64,recognized:!0},[4,fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(s)})];case 2:return[4,c.sent().json()];case 3:return o=c.sent(),m(o),[3,6];case 4:return l=c.sent(),console.error("Error sending to ERP",l),[3,6];case 5:return y(!1),[7];case 6:return[2]}}))},new((s=void 0)||(s=Promise))((function(t,e){function r(t){try{l(o.next(t))}catch(t){e(t)}}function a(t){try{l(o.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(r,a)}l((o=o.apply(n,i||[])).next())}));var n,i,s,o},sending:v})),g&&s.createElement("div",{className:"invoice-fields"},[["invoiceNumber","invoiceIssuerNameOnly"],["invoiceDate","dueDate"],["invoiceTitle","invoiceDetailSummary"],["invoiceCurrency","totalAmount"],["voucherTaxCode","taxAmount"],["accountNumber","fileNumber"],["costCenter"]].map((function(t,e){return s.createElement("div",{className:"field-pair",key:e},t.map((function(t){return s.createElement("div",{key:t},s.createElement("label",null,t.replace(/([A-Z])/g," $1").replace(/^\w/,(function(t){return t.toUpperCase()}))),"invoiceCurrency"===t?s.createElement("select",{value:g.invoiceCurrency||"",disabled:!0,"aria-label":"Invoice Currency"},_.map((function(t){return s.createElement("option",{key:t,value:t},t)}))):"voucherTaxCode"===t?s.createElement("select",{value:g.voucherTaxCode||"",disabled:!0,"aria-label":"Tax Code"},E.map((function(t){return s.createElement("option",{key:t,value:t},t,"%")}))):s.createElement("input",{type:t.toLowerCase().includes("date")?"date":t.toLowerCase().includes("amount")?"number":"text",value:g[t]||"",readOnly:!0,placeholder:"Enter ".concat(t.replace(/([A-Z])/g," $1").toLowerCase()),title:t.replace(/([A-Z])/g," $1").replace(/^\w/,(function(t){return t.toUpperCase()}))}))})))})))),s.createElement("div",{className:"invoice-preview-panel"},s.createElement(ic,{attachment:u})))},rc=function(){return rc=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},rc.apply(this,arguments)},ac={AuthenticationUrls:{Switzerland:"https://authentication-test.sds-ch.com",Luanda:"https://authentication-test-31.sds-ch.com",Malabo:"https://authentication-test-21.sds-ch.com"},FinanceUrls:{Switzerland:"https://finance.tlc-com.com",Luanda:"https://finance-31.tlc-com.com",Malabo:"https://finance-21.tlc-com.com"},AgencyFlags:{Switzerland:"/SDS-AI-Outlook-Plugin/assets/flags/switzerland.svg",Luanda:"/SDS-AI-Outlook-Plugin/assets/flags/luanda.svg",Malabo:"/SDS-AI-Outlook-Plugin/assets/flags/malabo.svg"}},oc=function(t){return btoa(t)},lc=function(){var t=(0,s.useState)(null),e=t[0],n=t[1],i=(0,s.useState)(null),r=i[0],a=i[1];return s.createElement("div",null,e?s.createElement(sc,{accessToken:e,initialAttachments:[],financeUrls:ac.FinanceUrls,selectedAgency:r}):s.createElement(Oi,{appSettings:ac,encrypt:oc,showLoggedInUI:function(t){n(t);var e=Office.context.roamingSettings.get("selectedAgency");a(e),Office.onReady((function(){if(console.log("Office is ready in App.tsx"),Office.context.mailbox&&Office.context.mailbox.item){var e=Office.context.mailbox.item.attachments||[];console.log("Attachments in App.tsx:",e),Promise.all(e.map((function(t){return e=void 0,n=void 0,s=function(){return function(t,e){var n,i,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,i&&(s=2&o[0]?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(e){return[2,new Promise((function(e,n){Office.context.mailbox.item.getAttachmentContentAsync(t.id,(function(i){i.status===Office.AsyncResultStatus.Succeeded?e(rc(rc({},t),{fileBase64:i.value.content})):n(i.error)}))}))]}))},new((i=void 0)||(i=Promise))((function(t,r){function a(t){try{l(s.next(t))}catch(t){r(t)}}function o(t){try{l(s.throw(t))}catch(t){r(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(a,o)}l((s=s.apply(e,n||[])).next())}));var e,n,i,s}))).then((function(e){Office.context.ui.displayDialogAsync("".concat(window.location.origin,"/SDS-AI-Outlook-Plugin/tools/dialog.html?accessToken=").concat(encodeURIComponent(t)),{width:70,height:70,displayInIframe:!0},(function(t){if(t.status===Office.AsyncResultStatus.Succeeded){var n=t.value;console.log("Sending attachments and appsettings to dialog"),setTimeout((function(){n.messageChild(JSON.stringify({attachments:e,appsettings:ac}))}),1200)}else console.error("Failed to open dialog:",t.error.message)}))})).catch((function(t){console.error("Error fetching attachment content:",t)}))}else console.error("Mailbox is not available in this context.")}))}}))};const cc=Symbol.for("fui.slotRenderFunction"),dc=Symbol.for("fui.slotElementType");function hc(t){return Boolean(null==t?void 0:t.hasOwnProperty(dc))}function uc(t,e){return function(n,i,s,r,a){return hc(i)?e(function(t,e){return{...e,[dc]:t}}(n,i),null,s,r,a):hc(n)?e(n,i,s,r,a):t(n,i,s,r,a)}}function pc(t){const{as:e,[dc]:n,[cc]:i,...s}=t,r=s,a="string"==typeof n&&null!=e?e:n;return"string"!=typeof a&&e&&(r.as=e),{elementType:a,props:r,renderFunction:i}}n(44363);const fc=il,gc=uc(fc.jsx,((t,e,n)=>{const{elementType:i,renderFunction:r,props:a}=pc(t),o={...a,...e};return r?fc.jsx(s.Fragment,{children:r(i,o)},n):fc.jsx(i,o,n)})),mc=uc(fc.jsxs,((t,e,n)=>{const{elementType:i,renderFunction:r,props:a}=pc(t),o={...a,...e};return r?fc.jsx(s.Fragment,{children:r(i,{...o,children:fc.jsxs(s.Fragment,{children:o.children},void 0)})},n):fc.jsxs(i,o,n)}));function bc(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const vc=s.createContext("ltr"),yc=({children:t,dir:e})=>s.createElement(vc.Provider,{value:e},t),wc=s.createContext(void 0),Ac={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},xc=wc.Provider;function Sc(){var t;return null!==(t=s.useContext(wc))&&void 0!==t?t:Ac}const _c=s.createContext(void 0),Ec=_c.Provider,Cc=s.createContext(void 0).Provider,Tc=s.createContext(void 0),kc=Tc.Provider,Mc=s.createContext(void 0).Provider,Pc=s.createContext(void 0),Ic=Pc.Provider,Rc=s.createContext(void 0).Provider,Lc="undefined"==typeof window?n.g:window,Dc="@griffel/";function Fc(t,e){return Lc[Symbol.for(Dc+t)]||(Lc[Symbol.for(Dc+t)]=e),Lc[Symbol.for(Dc+t)]}const Oc=Fc("DEFINITION_LOOKUP_TABLE",{}),Nc="data-make-styles-bucket";const Bc=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce(((t,e,n)=>(t[e]=n,t)),{});function Hc(t,e,n,i,s={}){var r,a;const o="m"===t,l=null!==(r=s.m)&&void 0!==r?r:"0",c=null!==(a=s.p)&&void 0!==a?a:0,d=function(t,e,n){return("m"===t?t+e:t)+n}(t,l,c);if(!i.stylesheets[d]){const r=e&&e.createElement("style"),a=function(t,e,n,i){const s=[];if(i[Nc]=e,i["data-priority"]=String(n),t)for(const e in i)t.setAttribute(e,i[e]);return{elementAttributes:i,insertRule:function(e){return(null==t?void 0:t.sheet)?t.sheet.insertRule(e,t.sheet.cssRules.length):s.push(e)},element:t,bucketName:e,cssRules(){return(null==t?void 0:t.sheet)?Array.from(t.sheet.cssRules).map((t=>t.cssText)):s}}}(r,t,c,Object.assign({},i.styleElementAttributes,o&&{media:l}));i.stylesheets[d]=a,e&&r&&e.head.insertBefore(r,function(t,e,n,i,s={}){var r,a;const o=Bc[n],l=null!==(r=s.m)&&void 0!==r?r:"",c=null!==(a=s.p)&&void 0!==a?a:0;let d=t=>o-Bc[t.getAttribute(Nc)],h=t.head.querySelectorAll(`[${Nc}]`);if("m"===n){const e=t.head.querySelectorAll(`[${Nc}="${n}"]`);e.length&&(h=e,d=t=>i.compareMediaQueries(l,t.media))}const u=h.length;let p=u-1;for(;p>=0;){const t=h.item(p);if((function(t,e,n){var i,s;return e+(null!==(i=n.m)&&void 0!==i?i:"")===t.getAttribute(Nc)+(null!==(s=t.media)&&void 0!==s?s:"")}(f=t,n,s)?c-Number(f.getAttribute("data-priority")):d(f))>0)return t.nextSibling;p--}var f;return u>0?h.item(0):e?e.nextSibling:null}(e,n,t,i,s))}return i.stylesheets[d]}function zc(t,e){try{t.insertRule(e)}catch(t){}}let Vc=0;const jc=(t,e)=>t<e?-1:t>e?1:0;function $c(t=("undefined"==typeof document?void 0:document),e={}){const{classNameHashSalt:n,unstable_filterCSSRule:i,insertionPoint:s,styleElementAttributes:r,compareMediaQueries:a=jc}=e,o={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(r),compareMediaQueries:a,id:"d"+Vc++,insertCSSRules(e){for(const r in e){const a=e[r];for(let e=0,l=a.length;e<l;e++){const[l,c]=(n=a[e],Array.isArray(n)?n:[n]),d=Hc(r,t,s||null,o,c);o.insertionCache[l]||(o.insertionCache[l]=r,i?i(l)&&zc(d,l):zc(d,l))}}var n}};return o}const Uc=s.createContext($c());function Wc(){return s.useContext(Uc)}function Gc(t,e){var n;const i=t;var s;return Boolean((null==i||null===(n=i.ownerDocument)||void 0===n?void 0:n.defaultView)&&i instanceof i.ownerDocument.defaultView[null!==(s=null==e?void 0:e.constructorName)&&void 0!==s?s:"HTMLElement"])}var qc="undefined"!=typeof WeakRef,Xc=class{constructor(t){qc&&"object"==typeof t?this._weakRef=new WeakRef(t):this._instance=t}deref(){var t,e;let n;return this._weakRef?(n=null==(t=this._weakRef)?void 0:t.deref(),n||delete this._weakRef):(n=this._instance,(null==(e=null==n?void 0:n.isDisposed)?void 0:e.call(n))&&delete this._instance),n}},Kc="keyborg:focusin",Yc=!1,Jc=0,Qc=class{constructor(t,e){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=t=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const e=t.detail;e.relatedTarget&&(e.isFocusedProgrammatically||void 0===e.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=t=>{0===t.buttons||0===t.clientX&&0===t.clientY&&0===t.screenX&&0===t.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const t=this._win;t&&(this._isMouseOrTouchUsedTimer&&t.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=t.setTimeout((()=>{delete this._isMouseOrTouchUsedTimer}),1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=t=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(t)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(t)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++Jc,this._win=t;const n=t.document;if(e){const t=e.triggerKeys,n=e.dismissKeys;(null==t?void 0:t.length)&&(this._triggerKeys=new Set(t)),(null==n?void 0:n.length)&&(this._dismissKeys=new Set(n))}n.addEventListener(Kc,this._onFocusIn,!0),n.addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("keydown",this._onKeyDown,!0),n.addEventListener("touchstart",this._onMouseOrTouch,!0),n.addEventListener("touchend",this._onMouseOrTouch,!0),n.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(t){const e=t;Yc||(Yc=function(t){const e=t.HTMLElement,n=e.prototype.focus;let i=!1;return e.prototype.focus=function(){i=!0},t.document.createElement("button").focus(),e.prototype.focus=n,i}(e));const n=e.HTMLElement.prototype.focus;if(n.__keyborgNativeFocus)return;e.HTMLElement.prototype.focus=l;const i=new Set,s=t=>{const e=t.target;if(!e)return;const n=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:t}});e.dispatchEvent(n)},r=t=>{const e=t.target;if(!e)return;let n=t.composedPath()[0];const o=new Set;for(;n;)n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(o.add(n),n=n.host):n=n.parentNode;for(const t of i){const e=t.deref();e&&o.has(e)||(i.delete(t),e&&(e.removeEventListener("focusin",r,!0),e.removeEventListener("focusout",s,!0)))}a(e,t.relatedTarget||void 0)},a=(t,e,n)=>{var a;const l=t.shadowRoot;if(l){for(const t of i)if(t.deref()===l)return;return l.addEventListener("focusin",r,!0),l.addEventListener("focusout",s,!0),void i.add(new Xc(l))}const c={relatedTarget:e,originalEvent:n},d=new CustomEvent(Kc,{cancelable:!0,bubbles:!0,composed:!0,detail:c});d.details=c,(Yc||o.lastFocusedProgrammatically)&&(c.isFocusedProgrammatically=t===(null==(a=o.lastFocusedProgrammatically)?void 0:a.deref()),o.lastFocusedProgrammatically=void 0),t.dispatchEvent(d)},o=e.__keyborgData={focusInHandler:r,focusOutHandler:s,shadowTargets:i};function l(){const t=e.__keyborgData;return t&&(t.lastFocusedProgrammatically=new Xc(this)),n.apply(this,arguments)}e.document.addEventListener("focusin",e.__keyborgData.focusInHandler,!0),e.document.addEventListener("focusout",e.__keyborgData.focusOutHandler,!0);let c=e.document.activeElement;for(;c&&c.shadowRoot;)a(c),c=c.shadowRoot.activeElement;l.__keyborgNativeFocus=n}(t)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(t){this._isNavigatingWithKeyboard_DO_NOT_USE!==t&&(this._isNavigatingWithKeyboard_DO_NOT_USE=t,this.update())}dispose(){const t=this._win;if(t){this._isMouseOrTouchUsedTimer&&(t.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(t.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(t){const e=t,n=e.HTMLElement.prototype,i=n.focus.__keyborgNativeFocus,s=e.__keyborgData;if(s){e.document.removeEventListener("focusin",s.focusInHandler,!0),e.document.removeEventListener("focusout",s.focusOutHandler,!0);for(const t of s.shadowTargets){const e=t.deref();e&&(e.removeEventListener("focusin",s.focusInHandler,!0),e.removeEventListener("focusout",s.focusOutHandler,!0))}s.shadowTargets.clear(),delete e.__keyborgData}i&&(n.focus=i)}(t);const e=t.document;e.removeEventListener(Kc,this._onFocusIn,!0),e.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener("touchstart",this._onMouseOrTouch,!0),e.removeEventListener("touchend",this._onMouseOrTouch,!0),e.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var t,e;const n=null==(e=null==(t=this._win)?void 0:t.__keyborg)?void 0:e.refs;if(n)for(const t of Object.keys(n))Zc.update(n[t],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(t){var e;if("Tab"===t.key)return!0;const n=null==(e=this._win)?void 0:e.document.activeElement,i=!this._triggerKeys||this._triggerKeys.has(t.keyCode),s=n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable);return i&&!s}_shouldDismissKeyboardNavigation(t){var e;return null==(e=this._dismissKeys)?void 0:e.has(t.keyCode)}_scheduleDismiss(){const t=this._win;if(t){this._dismissTimer&&(t.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const e=t.document.activeElement;this._dismissTimer=t.setTimeout((()=>{this._dismissTimer=void 0;const n=t.document.activeElement;e&&n&&e===n&&(this.isNavigatingWithKeyboard=!1)}),500)}}},Zc=class t{constructor(t,e){this._cb=[],this._id="k"+ ++Jc,this._win=t;const n=t.__keyborg;n?(this._core=n.core,n.refs[this._id]=this):(this._core=new Qc(t,e),t.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(e,n){return new t(e,n)}static dispose(t){t.dispose()}static update(t,e){t._cb.forEach((t=>t(e)))}dispose(){var t;const e=null==(t=this._win)?void 0:t.__keyborg;(null==e?void 0:e.refs[this._id])&&(delete e.refs[this._id],0===Object.keys(e.refs).length&&(e.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var t;return!!(null==(t=this._core)?void 0:t.isNavigatingWithKeyboard)}subscribe(t){this._cb.push(t)}unsubscribe(t){const e=this._cb.indexOf(t);e>=0&&this._cb.splice(e,1)}setVal(t){this._core&&(this._core.isNavigatingWithKeyboard=t)}};const td="data-fui-focus-visible";function ed(t,e){if(nd(t))return()=>{};const n={current:void 0},i=(s=e,Zc.create(s,undefined));var s;function r(t){i.isNavigatingWithKeyboard()&&Gc(t)&&(n.current=t,t.setAttribute(td,""))}function a(){n.current&&(n.current.removeAttribute(td),n.current=void 0)}i.subscribe((t=>{t||a()}));const o=t=>{a(),r(t.composedPath()[0])},l=e=>{(!e.relatedTarget||Gc(e.relatedTarget)&&!t.contains(e.relatedTarget))&&a()};return t.addEventListener(Kc,o),t.addEventListener("focusout",l),t.focusVisible=!0,t.contains(e.document.activeElement)&&r(e.document.activeElement),()=>{var e;a(),t.removeEventListener(Kc,o),t.removeEventListener("focusout",l),delete t.focusVisible,e=i,Zc.dispose(e)}}function nd(t){return!!t&&(!!t.focusVisible||nd(null==t?void 0:t.parentElement))}function id(t={}){const e=Sc(),n=s.useRef(null);var i;const r=null!==(i=t.targetDocument)&&void 0!==i?i:e.targetDocument;return s.useEffect((()=>{if((null==r?void 0:r.defaultView)&&n.current)return ed(n.current,r.defaultView)}),[n,r]),n}function sd(t,e){const{defaultProps:n,elementType:i}=e,r=function(t){return"string"==typeof t||"number"==typeof t||Array.isArray(t)||s.isValidElement(t)?{children:t}:t}(t),a={...n,...r,[dc]:i};return r&&"function"==typeof r.children&&(a[cc]=r.children,a.children=null==n?void 0:n.children),a}const rd=(...t)=>{const e={};for(const n of t){const t=Array.isArray(n)?n:Object.keys(n);for(const n of t)e[n]=1}return e},ad=rd(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),od=rd(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),ld=rd(["itemID","itemProp","itemRef","itemScope","itemType"]),cd=rd(od,ad,ld),dd=rd(cd,["form"]),hd=rd(cd,["height","loop","muted","preload","src","width"]),ud=rd(hd,["poster"]),pd=rd(cd,["start"]),fd=rd(cd,["value"]),gd=rd(cd,["download","href","hrefLang","media","rel","target","type"]),md=rd(cd,["dateTime"]),bd=rd(cd,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),vd={label:dd,audio:hd,video:ud,ol:pd,li:fd,a:gd,button:bd,input:rd(bd,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:rd(bd,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:rd(bd,["form","multiple","required"]),option:rd(cd,["selected","value"]),table:rd(cd,["cellPadding","cellSpacing"]),tr:cd,th:rd(cd,["colSpan","rowSpan","scope"]),td:rd(cd,["colSpan","headers","rowSpan","scope"]),colGroup:rd(cd,["span"]),col:rd(cd,["span"]),fieldset:rd(cd,["disabled","form"]),form:rd(cd,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:rd(cd,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:rd(cd,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:md,dialog:rd(cd,["open","onCancel","onClose"])};const yd=(t,e,n)=>{var i;return function(t,e,n){const i=t&&vd[t]||cd;return i.as=1,function(t,e,n){const i=Array.isArray(e),s={},r=Object.keys(t);for(const a of r)!(!i&&e[a]||i&&e.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(a))||(s[a]=t[a]);return s}(e,i,n)}(null!==(i=e.as)&&void 0!==i?i:t,e,n)};function wd(...t){const e=s.useCallback((n=>{e.current=n;for(const e of t)"function"==typeof e?e(n):e&&(e.current=n)}),[...t]);return e}const Ad=bc()?s.useLayoutEffect:s.useEffect,xd={current:0},Sd=s.createContext(void 0);const _d=s.createContext(void 0);function Ed(t="fui-",e){const n=null!==(o=s.useContext(Sd))&&void 0!==o?o:xd,i=s.useContext(_d)||"",a=r.useId;var o;if(a){const n=a(),r=s.useMemo((()=>n.replace(/:/g,"")),[n]);return e||`${i}${t}${r}`}return s.useMemo((()=>e||`${i}${t}${++n.current}`),[i,t,e,n])}_d.Provider;const Cd=()=>{const t={};return function(e,n){void 0===t[e.id]&&(e.insertCSSRules(n),t[e.id]=!0)}};function Td(t,e,n=[]){return"___"+function(t){const e=t.length;if(7===e)return t;for(let n=e;n<7;n++)t+="0";return t}(Et(t+e))}function kd(t,e){let n="",i="";for(const s in t){const r=t[s];if(0===r){i+=s+" ";continue}const a=Array.isArray(r),o="rtl"===e?(a?r[1]:r)+" ":(a?r[0]:r)+" ";n+=o,i+=o}return[n.slice(0,-1),i.slice(0,-1)]}function Md(t,e){const n={};for(const i in t){const[s,r]=kd(t[i],e);if(""===r){n[i]="";continue}const a=Td(r,e),o=a+(""===s?"":" "+s);Oc[a]=[t[i],e],n[i]=o}return n}function Pd(t,e,n=Cd){const i=n();let s=null,r=null;return function(n){const{dir:a,renderer:o}=n,l="ltr"===a;return l?null===s&&(s=Md(t,a)):null===r&&(r=Md(t,a)),i(o,e),l?s:r}}const Id={},Rd="fui-FluentProvider",Ld=Pd({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),Dd=r.useInsertionEffect?r.useInsertionEffect:Ad,Fd={},Od={},Nd=(t,e)=>{const n=Sc(),i=s.useContext(_c),r=null!==(a=s.useContext(Pc))&&void 0!==a?a:{};var a;const o=s.useContext(Tc)||Fd,{applyStylesToPortals:l=!0,customStyleHooks_unstable:c,dir:d=n.dir,targetDocument:h=n.targetDocument,theme:u,overrides_unstable:p={}}=t,f=Bd(i,u),g=Bd(r,p),m=Bd(o,c),b=Wc();var v;const{styleTagId:y,rule:w}=(t=>{const{targetDocument:e,theme:n,rendererAttributes:i}=t,r=s.useRef(),a=Ed(Rd),o=i,l=s.useMemo((()=>function(t,e){return e?`${t} { ${Object.keys(e).reduce(((t,n)=>`${t}--${n}: ${e[n]}; `),"")} }`:`${t} {}`}(`.${a}`,n)),[n,a]);return function(t,e){s.useState((()=>{if(!t)return;const n=t.getElementById(e);n&&t.head.append(n)}))}(e,a),Dd((()=>{const t=null==e?void 0:e.getElementById(a);return t?r.current=t:(r.current=((t,e)=>{if(!t)return;const n=t.createElement("style");return Object.keys(e).forEach((t=>{n.setAttribute(t,e[t])})),t.head.appendChild(n),n})(e,{...o,id:a}),r.current&&((t,e)=>{const n=t.sheet;n&&(n.cssRules.length>0&&n.deleteRule(0),n.insertRule(e,0))})(r.current,l)),()=>{var t;null===(t=r.current)||void 0===t||t.remove()}}),[a,e,l,o]),{styleTagId:a,rule:l}})({theme:f,targetDocument:h,rendererAttributes:null!==(v=b.styleElementAttributes)&&void 0!==v?v:Od});return{applyStylesToPortals:l,customStyleHooks_unstable:m,dir:d,targetDocument:h,theme:f,overrides_unstable:g,themeClassName:y,components:{root:"div"},root:sd(yd("div",{...t,dir:d,ref:wd(e,id({targetDocument:h}))}),{elementType:"div"}),serverStyleProps:{cssRule:w,attributes:{...b.styleElementAttributes,id:y}}}};function Bd(t,e){return t&&e?{...t,...e}:t||e}const Hd=s.forwardRef(((t,e)=>{const n=Nd(t,e);(t=>{const e=Wc(),n=Ld({dir:t.dir,renderer:e});t.root.className=function(){let t=null,e="",n="";const i=new Array(arguments.length);for(let t=0;t<arguments.length;t++){const s=arguments[t];if("string"==typeof s&&""!==s){const r=s.indexOf("___");if(-1===r)e+=s+" ";else{const a=s.substr(r,10);r>0&&(e+=s.slice(0,r)),n+=a,i[t]=a}}}if(""===n)return e.slice(0,-1);const s=Id[n];if(void 0!==s)return e+s;const r=[];for(let e=0;e<arguments.length;e++){const n=i[e];if(n){const e=Oc[n];e&&(r.push(e[0]),t=e[1])}}const a=Object.assign.apply(Object,[{}].concat(r)),[o,l]=kd(a,t),c=Td(l,t,i),d=c+" "+o;return Id[n]=d,Oc[c]=[a,t],e+d}(Rd,t.themeClassName,n.root,t.root.className)})(n);const i=function(t){const{applyStylesToPortals:e,customStyleHooks_unstable:n,dir:i,root:r,targetDocument:a,theme:o,themeClassName:l,overrides_unstable:c}=t,d=s.useMemo((()=>({dir:i,targetDocument:a})),[i,a]),[h]=s.useState((()=>({}))),u=s.useMemo((()=>({textDirection:i})),[i]);return{customStyleHooks_unstable:n,overrides_unstable:c,provider:d,textDirection:i,iconDirection:u,tooltip:h,theme:o,themeClassName:e?r.className:l}}(n);return((t,e)=>gc(xc,{value:e.provider,children:gc(Ec,{value:e.theme,children:gc(Cc,{value:e.themeClassName,children:gc(kc,{value:e.customStyleHooks_unstable,children:gc(Mc,{value:e.tooltip,children:gc(yc,{dir:e.textDirection,children:gc(Rc,{value:e.iconDirection,children:gc(Ic,{value:e.overrides_unstable,children:mc(t.root,{children:[bc()?null:gc("style",{dangerouslySetInnerHTML:{__html:t.serverStyleProps.cssRule},...t.serverStyleProps.attributes}),t.root.children]})})})})})})})})}))(n,i)}));Hd.displayName="FluentProvider";const zd="#242424",Vd="#424242",jd="#616161",$d="#bdbdbd",Ud="#e0e0e0",Wd="#e6e6e6",Gd="#ebebeb",qd="#f0f0f0",Xd="#f5f5f5",Kd="#fafafa",Yd="rgba(255, 255, 255, 0.4)",Jd="rgba(255, 255, 255, 0.5)",Qd="rgba(0, 0, 0, 0.05)",Zd="rgba(0, 0, 0, 0.1)",th="#ffffff",eh={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},nh={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},ih={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:nh,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},sh={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:eh,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},rh={cranberry:eh,green:nh,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},ah={success:"green",warning:"orange",danger:"cranberry"},oh=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce(((t,e)=>{const n=e.slice(0,1).toUpperCase()+e.slice(1),i={[`colorPalette${n}Background1`]:ih[e].tint60,[`colorPalette${n}Background2`]:ih[e].tint40,[`colorPalette${n}Background3`]:ih[e].primary,[`colorPalette${n}Foreground1`]:ih[e].shade10,[`colorPalette${n}Foreground2`]:ih[e].shade30,[`colorPalette${n}Foreground3`]:ih[e].primary,[`colorPalette${n}BorderActive`]:ih[e].primary,[`colorPalette${n}Border1`]:ih[e].tint40,[`colorPalette${n}Border2`]:ih[e].primary};return Object.assign(t,i)}),{});oh.colorPaletteYellowForeground1=ih.yellow.shade30,oh.colorPaletteRedForegroundInverted=ih.red.tint20,oh.colorPaletteGreenForegroundInverted=ih.green.tint20,oh.colorPaletteYellowForegroundInverted=ih.yellow.tint40;const lh=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce(((t,e)=>{const n=e.slice(0,1).toUpperCase()+e.slice(1),i={[`colorPalette${n}Background2`]:sh[e].tint40,[`colorPalette${n}Foreground2`]:sh[e].shade30,[`colorPalette${n}BorderActive`]:sh[e].primary};return Object.assign(t,i)}),{}),ch={...oh,...lh},dh=Object.entries(ah).reduce(((t,[e,n])=>{const i=e.slice(0,1).toUpperCase()+e.slice(1),s={[`colorStatus${i}Background1`]:rh[n].tint60,[`colorStatus${i}Background2`]:rh[n].tint40,[`colorStatus${i}Background3`]:rh[n].primary,[`colorStatus${i}Foreground1`]:rh[n].shade10,[`colorStatus${i}Foreground2`]:rh[n].shade30,[`colorStatus${i}Foreground3`]:rh[n].primary,[`colorStatus${i}ForegroundInverted`]:rh[n].tint30,[`colorStatus${i}BorderActive`]:rh[n].primary,[`colorStatus${i}Border1`]:rh[n].tint40,[`colorStatus${i}Border2`]:rh[n].primary};return Object.assign(t,s)}),{});dh.colorStatusDangerBackground3Hover=rh[ah.danger].shade10,dh.colorStatusDangerBackground3Pressed=rh[ah.danger].shade20,dh.colorStatusWarningForeground1=rh[ah.warning].shade20,dh.colorStatusWarningForeground3=rh[ah.warning].shade20,dh.colorStatusWarningBorder2=rh[ah.warning].shade20;const hh={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},uh={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},ph={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},fh={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},gh={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},mh={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function bh(t,e,n=""){return{[`shadow2${n}`]:`0 0 2px ${t}, 0 1px 2px ${e}`,[`shadow4${n}`]:`0 0 2px ${t}, 0 2px 4px ${e}`,[`shadow8${n}`]:`0 0 2px ${t}, 0 4px 8px ${e}`,[`shadow16${n}`]:`0 0 2px ${t}, 0 8px 16px ${e}`,[`shadow28${n}`]:`0 0 8px ${t}, 0 14px 28px ${e}`,[`shadow64${n}`]:`0 0 8px ${t}, 0 32px 64px ${e}`}}const vh={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},yh={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},wh="10px",Ah="12px",xh="16px",Sh="20px",_h="24px",Eh="32px",Ch={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:wh,spacingHorizontalM:Ah,spacingHorizontalL:xh,spacingHorizontalXL:Sh,spacingHorizontalXXL:_h,spacingHorizontalXXXL:Eh},Th={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:wh,spacingVerticalM:Ah,spacingVerticalL:xh,spacingVerticalXL:Sh,spacingVerticalXXL:_h,spacingVerticalXXXL:Eh},kh=(()=>{const t=(t=>({colorNeutralForeground1:zd,colorNeutralForeground1Hover:zd,colorNeutralForeground1Pressed:zd,colorNeutralForeground1Selected:zd,colorNeutralForeground2:Vd,colorNeutralForeground2Hover:zd,colorNeutralForeground2Pressed:zd,colorNeutralForeground2Selected:zd,colorNeutralForeground2BrandHover:t[80],colorNeutralForeground2BrandPressed:t[70],colorNeutralForeground2BrandSelected:t[80],colorNeutralForeground3:jd,colorNeutralForeground3Hover:Vd,colorNeutralForeground3Pressed:Vd,colorNeutralForeground3Selected:Vd,colorNeutralForeground3BrandHover:t[80],colorNeutralForeground3BrandPressed:t[70],colorNeutralForeground3BrandSelected:t[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:$d,colorNeutralForegroundInvertedDisabled:Yd,colorBrandForegroundLink:t[70],colorBrandForegroundLinkHover:t[60],colorBrandForegroundLinkPressed:t[40],colorBrandForegroundLinkSelected:t[70],colorNeutralForeground2Link:Vd,colorNeutralForeground2LinkHover:zd,colorNeutralForeground2LinkPressed:zd,colorNeutralForeground2LinkSelected:zd,colorCompoundBrandForeground1:t[80],colorCompoundBrandForeground1Hover:t[70],colorCompoundBrandForeground1Pressed:t[60],colorBrandForeground1:t[80],colorBrandForeground2:t[70],colorBrandForeground2Hover:t[60],colorBrandForeground2Pressed:t[30],colorNeutralForeground1Static:zd,colorNeutralForegroundStaticInverted:th,colorNeutralForegroundInverted:th,colorNeutralForegroundInvertedHover:th,colorNeutralForegroundInvertedPressed:th,colorNeutralForegroundInvertedSelected:th,colorNeutralForegroundInverted2:th,colorNeutralForegroundOnBrand:th,colorNeutralForegroundInvertedLink:th,colorNeutralForegroundInvertedLinkHover:th,colorNeutralForegroundInvertedLinkPressed:th,colorNeutralForegroundInvertedLinkSelected:th,colorBrandForegroundInverted:t[100],colorBrandForegroundInvertedHover:t[110],colorBrandForegroundInvertedPressed:t[100],colorBrandForegroundOnLight:t[80],colorBrandForegroundOnLightHover:t[70],colorBrandForegroundOnLightPressed:t[50],colorBrandForegroundOnLightSelected:t[60],colorNeutralBackground1:th,colorNeutralBackground1Hover:Xd,colorNeutralBackground1Pressed:Ud,colorNeutralBackground1Selected:Gd,colorNeutralBackground2:Kd,colorNeutralBackground2Hover:qd,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:Wd,colorNeutralBackground3:Xd,colorNeutralBackground3Hover:Gd,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:Ud,colorNeutralBackground4:qd,colorNeutralBackground4Hover:Kd,colorNeutralBackground4Pressed:Xd,colorNeutralBackground4Selected:th,colorNeutralBackground5:Gd,colorNeutralBackground5Hover:Xd,colorNeutralBackground5Pressed:qd,colorNeutralBackground5Selected:Kd,colorNeutralBackground6:Wd,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:Jd,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:Xd,colorSubtleBackgroundPressed:Ud,colorSubtleBackgroundSelected:Gd,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:Jd,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:Zd,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:qd,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:Wd,colorNeutralStencil2:Kd,colorNeutralStencil1Alpha:Zd,colorNeutralStencil2Alpha:Qd,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:t[80],colorBrandBackgroundHover:t[70],colorBrandBackgroundPressed:t[40],colorBrandBackgroundSelected:t[60],colorCompoundBrandBackground:t[80],colorCompoundBrandBackgroundHover:t[70],colorCompoundBrandBackgroundPressed:t[60],colorBrandBackgroundStatic:t[80],colorBrandBackground2:t[160],colorBrandBackground2Hover:t[150],colorBrandBackground2Pressed:t[130],colorBrandBackground3Static:t[60],colorBrandBackground4Static:t[40],colorBrandBackgroundInverted:th,colorBrandBackgroundInvertedHover:t[160],colorBrandBackgroundInvertedPressed:t[140],colorBrandBackgroundInvertedSelected:t[150],colorNeutralCardBackground:Kd,colorNeutralCardBackgroundHover:th,colorNeutralCardBackgroundPressed:Xd,colorNeutralCardBackgroundSelected:Gd,colorNeutralCardBackgroundDisabled:qd,colorNeutralStrokeAccessible:jd,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:t[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:$d,colorNeutralStroke2:Ud,colorNeutralStroke3:qd,colorNeutralStrokeSubtle:Ud,colorNeutralStrokeOnBrand:th,colorNeutralStrokeOnBrand2:th,colorNeutralStrokeOnBrand2Hover:th,colorNeutralStrokeOnBrand2Pressed:th,colorNeutralStrokeOnBrand2Selected:th,colorBrandStroke1:t[80],colorBrandStroke2:t[140],colorBrandStroke2Hover:t[120],colorBrandStroke2Pressed:t[80],colorBrandStroke2Contrast:t[140],colorCompoundBrandStroke:t[80],colorCompoundBrandStrokeHover:t[70],colorCompoundBrandStrokePressed:t[60],colorNeutralStrokeDisabled:Ud,colorNeutralStrokeInvertedDisabled:Yd,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:Qd,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:th,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...hh,...uh,...ph,...gh,...fh,...mh,...Ch,...Th,...vh,...yh,...t,...ch,...dh,...bh(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...bh(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})();var Mh=document.getElementById("container"),Ph=Mh?(0,a.H)(Mh):void 0;Office.onReady((function(){null==Ph||Ph.render(s.createElement(Hd,{theme:kh},s.createElement(lc,null)))}))},85072:function(t){var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var r={},a=[],o=0;o<t.length;o++){var l=t[o],c=i.base?l[0]+i.base:l[0],d=r[c]||0,h="".concat(c," ").concat(d);r[c]=d+1;var u=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var f=s(p,i);i.byIndex=o,e.splice(o,0,{identifier:h,updater:f,references:1})}a.push(h)}return a}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var r=i(t=t||[],s=s||{});return function(t){t=t||[];for(var a=0;a<r.length;a++){var o=n(r[a]);e[o].references--}for(var l=i(t,s),c=0;c<r.length;c++){var d=n(r[c]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}r=l}}},97825:function(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},function(t){var e=function(e){return t(t.s=e)};e(82525),e(39046)}]);